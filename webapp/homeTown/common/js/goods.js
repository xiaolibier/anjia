/*! iScroll v5.1.3 ~ (c) 2008-2014 Matteo Spinelli ~ http://cubiq.org/license */

define("apps/super/list/collection/search",["backbone"],function(t){return t.Collection.extend({url:function(){return"/mall/search.json"},state:{},queryParams:{title:""},parseState:function(t){return{"default":t["default"],data:t.data}},parseRecords:function(t,i){return t}})}),define("text!components/search/tpl.html",[],function(){return'\n<div class="search-container">\n    {{?_global.mall_info}}\n    <div class="view-container view-search" style="min-height:0 !important;">\n        <div class="view-inner">\n            <div class="search-container">\n                <div class="searchbar-wrap search-btn">\n                    <a href="http://mall{{=_global.mall_info.id+\'.\'+_global.url.base_domain}}/super/list" class="j-list-load">\n                        <div class="cate-icon">\n                            <i class="if if-cate"></i>\n                            <p style="margin: 0; padding: 0;">分类</p>\n                        </div>\n                    </a>\n                    <div class="searchbar"> <i class="if if-search"></i>\n                        <form onsubmit="return false;">\n                            <input class="search-input ipt-values js-search-input" type="search" placeholder="请输入关键字">\n                        </form>\n                        <i class="if if-close-circle js-clear"></i>\n                    </div>\n                    <button class="searchbar-shop js-search-shop">搜本店</button>\n                    <button class="searchbar-mall js-search-mall">搜商超</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    {{?_global.mall_info}}\n    <button style="position: absolute;top: 5rem;right: 1rem;" type="button" class="btn btn-default js-cancel">取消</button>\n    {{?}}\n\n    {{??}}\n    <div class="searchbar-wrap">\n        <div class="searchbar">\n            <i class="if if-search"></i>\n            <form onsubmit="return false;">\n                <input class="search-input js-search-input" type="search" placeholder="请输入商品关键字">\n            </form>\n            <i class="if if-close-circle js-clear"></i>\n        </div>\n        <button class="searchbar-cancel js-cancel">取消</button>\n    </div>\n    {{?}}\n    {{?it}}\n    <div class="history-wrap">\n        <ul class="history-list clearfix">\n            {{~it:value:index}}\n            <li class="js-keyword" key="{{=value}}">{{=value}}</li>\n            {{~}}\n        </ul>\n        <button type="button" class="btn btn-default js-clear-history">清除历史搜索</button>\n    </div>\n    {{?}}\n</div>\n'}),define("components/search/view",["backbone","doT","apps/super/list/collection/search","text!components/search/tpl.html"],function(t,i,e,n){return t.View.extend({className:"js-search-container",template:i.template(n),events:{"click .js-cancel":"cancel","click .js-clear-history":"clearHistory","click .js-keyword":"historySearch","click .js-clear":"clear","click .js-search-shop":"searchShop","click .js-search-mall":"searchMall"},initialize:function(){},render:function(){$("#views").addClass("blur"),_global.scroll={index:$(document).scrollTop()},$(document).scrollTop(0),$("html").css({height:$(window).height(),position:"relative",overflow:"hidden",padding:0}),$("body").css({height:$(window).height(),overflow:"hidden",padding:0});var t;if($.localStorage){var i=(window.localStorage,localStorage.getItem("search_History"));null!=i&&(t=JSON.parse(i))}return this.$el.html(this.template(t)),this.keyDownSearch(),this},historySearch:function(t){var i=$(t.currentTarget).attr("key");this.search(i)},keyDownSearch:function(){var t=this;$(".js-search-input",this.$el).keydown(function(i){if("13"==i.keyCode){var e=$.trim($(".js-search-input",this.$el).val());t.search(e)}})},search:function(i){var e=decodeURIComponent($.getUrlParam("q"));"/list"==t.history.location.pathname&&""!=i&&i!=e&&this.trigger("search",i),t.history.navigate("list?q="+i,{trigger:!0}),this.cancel()},cancel:function(){if($("#views").removeClass("blur"),$("html").attr("style",""),$("body").attr("style",""),"undefined"!=typeof _global.scroll){var t=_global.scroll;null!=t&&null!=t.index&&$(document).scrollTop(t.index)}this.$el.remove()},clearHistory:function(){$.localStorage&&(localStorage.removeItem("search_History"),this.render())},clear:function(){$(".js-search-input",this.$el).val("")},searchShop:function(i){var i=$.trim($(".js-search-input",this.$el).val());if(""==i||null==i)return void $.toast("请输入关键字！");var e=decodeURIComponent($.getUrlParam("q"));"/list"==t.history.location.pathname&&""!=i&&i!=e&&this.trigger("search",i),t.history.navigate("list?q="+i,{trigger:!0})},searchMall:function(){var t=$.trim($(".js-search-input",this.$el).val());if(""==t||null==t)return void $.toast("请输入关键字！");var i="http://mall"+_global.mall_info.id+"."+_global.url.base_domain+"/super/search?title="+t;console.log(i),$.loading(""),this.collection=new e;this.collection.fetch({data:{keyword:t},success:function(t,e){$(window).unbind("scroll"),window.location.href=i}}),console.log(t)}})}),define("text!components/top_bar/tpl.html",[],function(){return'{{?it}}<a class="header-link home-link" href="/"><i class="if if-store"></i></a>{{?}}\n<div class="pull-right">\n    <a class="header-link js-search-btn" href="javascript:;"><i class="if if-search"></i></a>\n    <a class="header-link js-open-user" data-panel="right" href="javascript:;"><i class="if if-user"></i></a>\n</div>'}),define("components/top_bar/view",["backbone","doT","components/user/view","components/account/views/main","components/search/view","text!components/top_bar/tpl.html"],function(t,i,e,n,s,a){var o=$("#panel-user");return t.View.extend({className:"header-nav",template:i.template(a),events:{"click .js-search-btn":"search","click .js-open-user":"open"},initialize:function(){},render:function(){var i=1;return"/"===t.history.location.pathname&&(i=!1),this.$el.html(this.template(i)),this},search:function(){$("body").append((new s).render().$el)},open:function(){$.checkAuth({toRightSide:!0})&&o.html((new e).$el)}})}),define("components/aside/model",["backbone"],function(t){return t.Model.extend({url:function(){return this.id?"/guider/goods_spread/"+this.id+".json":"/guider/spread.json"}})}),define("text!components/aside/main.html",[],function(){return'<section class="spread-qrcode">\n    <h3 class="spread-title">方法1：二维码推广<span>(点击查看二维码)</span></h3>\n    <div class="spread-qrcode-content">\n        <div class="js-more-loading" style="margin: 0 auto"></div>\n    </div>\n    <div class="qrcode-info t_center"><div>正在加载二维码...</div></div>\n</section>\n<section class="spread-link">\n    <h3 class="spread-title">方法2：复制链接推广</h3>\n    <p class="copy-text js-copy-text">我开了一个小店，来看看有没有你喜欢的宝贝</p>\n</section>\n<div class="spread-action">\n    <ul class="tab-nav">\n        <li><a class="btn-block btn btn-success" href="/guide">我的小店</a></li>\n        <li><a class="btn-block btn btn-buy" href="/guider">{{=_global.guider_alias}}中心</a></li>\n    </ul>\n</div>\n'}),define("components/aside/main",["backbone","doT","components/aside/model","text!components/aside/main.html"],function(t,i,e,n){return t.View.extend({className:"view-guider-spread",events:{"click .js-qrcode":"qrcode","click .js-params_qrcode":"params_qrcode"},template:i.template(n),initialize:function(t){$.indicator("show"),this.render(),this.model=new e,this.model.id=t,this.model.on("sync",this.renderQrcode,this),this.model.fetch()},render:function(){return this.$el.html(this.template()),$(".js-more-loading",this.$el).loading("show"),$.indicator("hide"),this},qrcode:function(){$.device.weixin?wx.previewImage({current:_global.url.ms+this.model.get("spread_img"),urls:[_global.url.ms+this.model.get("spread_img"),this.model.get("params_qrcode")]}):window.location.href=_global.url.ms+this.model.get("spread_img")},params_qrcode:function(){$.device.weixin?wx.previewImage({current:this.model.get("params_qrcode"),urls:[_global.url.ms+this.model.get("spread_img"),this.model.get("params_qrcode")]}):window.location.href=this.model.get("params_qrcode")},renderQrcode:function(){var t=this.model.get("params_qrcode");t&&-1==t.indexOf("http")&&this.model.set("params_qrcode",_global.url.ms+t),$(".js-copy-text",this.$el).append(this.model.get("spread_url")),$(".qrcode-info",this.$el).remove();var i="";this.model.get("spread_img")&&(i+='<div class="qrcode-item"><span class="if if-click-qcrode js-qrcode"></span> <div>推广二维码</div> </div> '),this.model.get("params_qrcode")&&(i+='<div class="qrcode-item"> <span class="if if-click-qcrode js-params_qrcode"></span> <div>关注二维码</div> </div>'),$(".spread-qrcode-content",this.$el).html(i)}})}),define("text!components/share/tpl.html",[],function(){return'<div class="pop-share">\n    <div class="js-cancel over-cancel"></div>\n<section class="share-cell">\n    <div>点击微信右上角 <span class="share-img"></span><br>通过【发送给朋友】、【分享到朋友圈】推广</div>\n    <div class="allow"></div>\n</section>\n{{?it.content}}\n{{var maxH= window.screen.height-230;}}\n<div class="share-cell share-cell-spread {{?it.open}}active{{?}}">\n    <div class="other-title js-toggle">其他方式</div>\n    <div style="max-height:{{=maxH}}px" class="js-content scroll-content"></div>\n</div>\n{{?}}\n{{?it.cancel}}\n<button type="button" class="btn btn-block btn-white js-cancel">取消</button>\n{{?}}\n</div>\n\n'}),define("components/share/view",["backbone","doT","text!components/share/tpl.html"],function(t,i,e){return t.View.extend({id:"pop-share",template:i.template(e),events:{"click .js-cancel":"cancel","click .js-toggle":"toggle"},initialize:function(){},render:function(t){return t=t?t:{},this.$el.html(this.template(t)),t.content&&$(".js-content",this.$el).html(t.content),this},cancel:function(t){t.preventDefault(),this.$el.remove()},toggle:function(){$(".share-cell-spread",this.$el).toggleClass("active")}})}),define("text!components/aside/tpl.html",[],function(){return'\n{{?_global.mall_info && _global.mall_info.is_show_mallback == 1}}\n<a class="if if-allgoods" href="http://mall{{=_global.mall_info.id+\'.\'+_global.url.base_domain}}"></a>\n{{?}}\n\n{{?_global.mall_info}}\n<a class="if if-tuike js-go-share"></a>\n{{??}}\n{{?_global.checkPrev(\'guide\')}}<a class="if if-tuike js-go-share"></a>{{?}}\n{{?}}\n\n{{?_global.shop.is_dynamic == 1}}\n<a href="/dynamics" class="if if-dongtai"></a>\n{{?}}\n\n{{?_global.kefu.code && _global.kefu.enabled && _global.kefu.pages && _global.kefu.pages && _global.kefu.pages[it.type]}}\n<a href="{{=_global.kefu.code}}" class="if if-custom"></a>\n{{?}}\n\n{{?_global.mall_info}}\n<a href="http://mall{{=_global.mall_info.id+\'.\'+_global.url.base_domain}}/mall/cart" class="if if-cart js-go-cart">\n	{{?_global.cart.count>0}}\n	<em></em>\n	{{?}}\n</a>\n{{??}}\n<a href="/trade/cart" class="if if-cart js-go-cart">\n	{{?_global.cart.count>0}}\n	<em></em>\n	{{?}}\n</a>\n{{?}}\n\n<a class="if if-back-top hide js-go-top"></a>\n\n'}),define("components/aside/view",["backbone","doT","components/aside/main","components/share/view","text!components/aside/tpl.html"],function(t,i,e,n,s){return t.View.extend({className:"aside-bar",template:i.template(s),events:{"click .js-go-top":"goTop","click .js-go-share":"shareStep","click .js-go-more":"moreAside"},initialize:function(t){this.id=t},render:function(t){return this.$el.html(this.template(t)),$(window).on("scroll",function(t){var i=$(window).scrollTop();i>300?$(".js-go-top",this.$el).removeClass("hide"):$(".js-go-top",this.$el).addClass("hide")}),this},goTop:function(){$(document).scrollTop(0)},shareStep:function(){if(_global.guider.id){var i=new e(this.id).$el;$("body").append((new n).render({cancel:1,content:i,open:1}).$el)}else t.history.navigate("/guider",{trigger:!0})},moreAside:function(){$(".more-aside",this.$el).toggleClass("moreActive")}})}),define("apps/goods/models/goods",["backbone"],function(t){return t.Model.extend({url:function(){return this.id?this.get("bargain_initiate_id")?"/goods/"+this.id+"/bi/"+this.get("bargain_initiate_id")+".json":this.get("bangmian_initiate_id")?"/goods/"+this.id+"/bmi/"+this.get("bangmian_initiate_id")+".json":"/goods/"+this.id+".json":"/goods"}})}),define("apps/goods/models/prop",["backbone"],function(t){return t.Model.extend({url:function(){return"/goods_props/"+this.id+".json"}})}),define("text!apps/goods/templates/prop.html",[],function(){return'<div class="goods-prop">\n    <table cellpadding="0" cellspacing="1" width="100%" border="0" class="param-table">\n        <tbody>\n        {{~it.data:v:index}}\n        <tr><td class="td-title">{{=v.name}}</td><td>{{=v.prop_value}}</td></tr>\n        {{~}}\n        </tbody>\n    </table>\n</div>'}),define("apps/goods/views/prop",["backbone","doT","apps/goods/models/prop","text!apps/goods/templates/prop.html"],function(t,i,e,n){return t.View.extend({id:"goods-prop",template:i.template(n),className:"tab active",initialize:function(t){this.model=new e,this.model.id=t,this.model.on("sync",this.render,this),this.model.fetch()},render:function(){return this.$el.html(this.template(this.model.toJSON())),this}})}),define("apps/goods/collections/comments",["backbone.paginator"],function(t){return Backbone.PageableCollection.extend({url:function(){return"/goods/"+this.id+"/comments.json"},state:{pagesInRange:0,pageSize:10},queryParams:{totalPages:null,totalRecords:null,pageSize:"limit",currentPage:null,status:"all",offset:function(){return(this.state.currentPage-1)*this.state.pageSize}},parseState:function(t,i,e,n){return{totalRecords:t._count}},parseRecords:function(t,i){return t.data}})}),define("apps/goods/collections/comment.img",["backbone.paginator"],function(t){return Backbone.PageableCollection.extend({url:function(){return"/goods/"+this.id+"/comments.json"},state:{pagesInRange:0,pageSize:10},queryParams:{totalPages:null,totalRecords:null,pageSize:"limit",currentPage:null,status:"img",offset:function(){return(this.state.currentPage-1)*this.state.pageSize}},parseState:function(t,i,e,n){return{totalRecords:t._count}},parseRecords:function(t,i){return t.data}})}),define("text!apps/goods/templates/comments_item.html",[],function(){return'<div class="cmt-user" style="padding:1rem 0;">\n		{{?it.portrait}}\n    <img src="{{=it.portrait}}?imageMogr2/thumbnail/40x40!" style="border-radius:3rem; width:3rem;height:3rem;">\n    {{??}}\n    <img src="/image/user-default.png" style="border-radius:3rem; width:3rem;height:3rem;">\n    {{?}}\n    <span style="font-size:1.4rem;line-height:1.4rem;padding-left:1rem;">{{=it.member_name}}</span>\n</div>\n<div class="cmt-cnt " style="font-size:1.4rem; color:#333;">{{=it.content}}</div>\n<div>\n	<span style="color:#ccc;font-size: 1.2rem;">{{=it.createdat}}&nbsp;&nbsp;</span>\n	<span style="color:#999; font-size: 1rem;">&nbsp;&nbsp;{{=it.props}}</span>\n</div>\n<div style="border-bottom: 1px solid #f1f1f1;">\n	{{~it.img:value:index}}\n	<div style="display:inline-block;width:27%;margin:0 0.3rem; padding:0.5rem 0" class="img-list-container">\n		<img class="show-img" data-id="{{=it.id}}" src="{{=value.img}}"style="width:100%; height:100%;">\n	</div>\n	{{~}}\n	<img class="img-container" width="100%" data-id="{{=it.id}}" src="" alt="" style="display:none; margin:1rem auto;">\n</div>\n<!-- <p style="color:#FE8705;"><span class="credit">{{for(var i=0;i<it.score;i++){}}<i class=" if if-star "></i>{{}}}</span></p> -->\n\n{{?it.reply}}\n<div style="border-bottom: 1px solid #f1f1f1;padding:0.5rem 0;">\n	<p style="font-size: 1.4rem; color:#ccc;margin:0;">{{=it.replyat}}</p>\n	<p style="font-size: 1.4rem; color:#cc6600;margin:0;">商家回复：{{=it.reply}}</p>\n</div>\n{{?}}\n\n<script>\n	$(".img-list-container").height($(".img-list-container").width());\n</script>\n\n'}),define("apps/goods/views/comments_item",["backbone","doT","text!apps/goods/templates/comments_item.html"],function(t,i,e){return t.View.extend({tagName:"li",template:i.template(e),initialize:function(){},render:function(){return this.$el.html(this.template(this.model.toJSON())),this}})}),define("text!apps/goods/templates/comments.html",[],function(){return'{{?it.count>0}}\n<div style="padding:1rem; color:#666; border-bottom:1px solid #f1f1f1;">\n    <button type="button" class="btn btn-default btn-sm btn-order-all" style="font-size: 1.2rem; background-color:#ffd9d9;">全部({{=it.count}})</button>\n    <button type="button" class="btn btn-default btn-sm btn-order-img" style="margin-left:0.7rem; font-size: 1.2rem;">有图({{=it.count_img}})</button>\n</div>\n{{?}}\n<ul class="cmt-list js-cmt-list" style="padding:0 1rem 3rem;">\n	\n</ul>\n<div class="js-more-loading"></div>'}),define("apps/goods/views/comments",["backbone","doT","apps/goods/collections/comments","apps/goods/collections/comment.img","apps/goods/views/comments_item","text!apps/goods/templates/comments.html"],function(t,i,e,n,s,a){return t.View.extend({id:"cmt-list",template:i.template(a),className:"tab active",events:{"click .show-img":"showImg","click .btn-order-all":"orderAll","click .btn-order-img":"orderImg"},initialize:function(t){this.temId=t,this.collection=new e,this.collection.id=this.temId,this.collection.on("sync",this.renderEach,this),this.$el.loading("show")},render:function(){var t=this;return this.collection.fetch({success:function(i,e){t.$el.html(t.template({count:e._count,count_img:e.count_img})),t.bottomLoad(),t.$el.loading("hide")}}),this},renderEach:function(){this.collection.length>0?this.collection.each(this.renderItem,this):$(".js-cmt-list",this.$el).html('<li class="no-item">还没评价记录</li>')},renderItem:function(t){$(".js-cmt-list",this.$el).append(new s({model:t}).render().$el)},showImg:function(t){var i=$(t.target).attr("src");$("img.img-container").css({display:"none"});var e={current:i,urls:[]},n=$(t.target).attr("data-id");$("img.show-img[data-id="+n+"]").each(function(t){e.urls.push($(this).attr("src"))}),$.wechatPreviewImage(e)},bottomLoad:function(){this.isRequest=!1;var t=this;$(window).on("scroll",function(i){var e=$(window).scrollTop(),n=$(document).height(),s=$(window).height();e>=n-s-100&&t.collection.hasNextPage()&&0==t.isRequest&&(t.isRequest=!0,$(".js-more-loading",t.$el).loading("show"),t.collection.getNextPage({success:function(){$(".js-more-loading",t.$el).loading("hide")}}))})},orderAll:function(){this.collection=new e,this.collection.id=this.temId,this.collection.on("sync",this.renderEach,this);var t=this;$(".js-cmt-list").html(""),this.collection.fetch({success:function(i,e){t.$el.html(t.template({count:e._count,count_img:e.count_img})),$(".btn-order-all").css({"background-color":"#ffd9d9"}),$(".btn-order-img").css({"background-color":"#fff"}),t.bottomLoad(),t.$el.loading("hide")}})},orderImg:function(){this.collection=new n,this.collection.id=this.temId,this.collection.on("sync",this.renderEach,this);var t=this;$(".js-cmt-list").html(""),this.collection.fetch({success:function(i,e){console.log(e),t.$el.html(t.template({count:e._count,count_img:e.count_img})),$(".btn-order-img").css({"background-color":"#ffd9d9"}),$(".btn-order-all").css({"background-color":"#fff"}),t.bottomLoad(),t.$el.loading("hide")}})}})}),define("apps/goods/collections/records",["backbone.paginator"],function(t){return Backbone.PageableCollection.extend({url:function(){return"/goods/"+this.id+"/comments.json"},state:{pagesInRange:0,pageSize:20},queryParams:{totalPages:null,totalRecords:null,pageSize:"limit",currentPage:null,offset:function(){return(this.state.currentPage-1)*this.state.pageSize}},parseState:function(t,i,e,n){return{totalRecords:t._count}},parseRecords:function(t,i){return t.data}})}),define("text!apps/goods/templates/records_item.html",[],function(){return"<span>买*家</span>\n<span>2015-08-30</span>\n<span>1</span>"}),define("apps/goods/views/records_item",["backbone","doT","text!apps/goods/templates/records_item.html"],function(t,i,e){return t.View.extend({tagName:"li",template:i.template(e),initialize:function(){},render:function(){return this.$el.html(this.template(this.model.toJSON())),this}})}),define("text!apps/goods/templates/records.html",[],function(){return'<ul class="record-list js-record-list">\n    <li class="record-head">\n        <span>买家</span>\n        <span>成交时间</span>\n        <span>数量</span>\n    </li>\n</ul>'}),define("apps/goods/views/records",["backbone","doT","apps/goods/collections/records","apps/goods/views/records_item","text!apps/goods/templates/records.html"],function(t,i,e,n,s){return t.View.extend({id:"record-list",template:i.template(s),className:"tab active",initialize:function(t){this.collection=new e,this.collection.id=t,this.collection.on("sync",this.renderEach,this)},render:function(){return this.$el.html(this.template()),this.collection.fetch(),this},renderEach:function(){this.collection.length>0?this.collection.each(this.renderItem,this):$(".js-record-list",this.$el).html('<li class="no-item">还没成交记录</li>')},renderItem:function(t){$(".js-record-list",this.$el).append(new n({model:t}).render().$el)}})}),define("apps/goods/models/bargain",["backbone"],function(t){return t.Model.extend({url:function(){return"/bargain/"+this.get("bargain_id")+"/spread/"+this.get("bargain_initiate_id")+".json"}})}),define("text!apps/goods/templates/bargain/bargain_share.html",[],function(){return'<section class="spread-qrcode">\n    <h3 class="spread-title">方法1：二维码图片分享</h3>\n    <div class="spread-qrcode-content" style="display: block;">\n        <div class="js-more-loading" style="margin: 0 auto"></div>\n    </div>\n    <div class="qrcode-info t_center"><div>正在加载二维码...</div></div>\n</section>\n<section class="spread-link">\n    <h3 class="spread-title">方法2：复制链接推广</h3>\n    <p class="copy-text js-copy-text">我非常想要这宝贝，大家快来帮我砍个价，能省一点、\n        是一点，猛戳链接：</p>\n</section>\n'}),define("apps/goods/views/bargain/bargain_share",["backbone","doT","apps/goods/models/bargain","text!apps/goods/templates/bargain/bargain_share.html"],function(t,i,e,n){$("#views"),$("#panel-user");return t.View.extend({className:"view-guider-spread",template:i.template(n),events:{},initialize:function(t){this.bargainModel=new e,this.bargainModel.set({bargain_id:t.data.bargain_id,bargain_initiate_id:t.data.bargain_initiate_id})},render:function(){this.$el.html(this.template()),$(".js-more-loading",this.$el).loading("show");var t=this;return this.bargainModel.fetch({success:function(i,e,n){$(".spread-qrcode-content",t.$el).html('<img style="margin: 10px auto;" src="'+e.bargainQrcodeUrl+'">'),$(".js-copy-text",t.$el).append(e.bargainSpreadUrl),$(".qrcode-info",t.$el).remove()}}),this}})}),define("apps/goods/collections/bargain_list",["backbone.paginator"],function(t){return Backbone.PageableCollection.extend({url:function(){return"/bargain/"+this.bargain_id+"/initiate/"+this.bargain_initiate_id+"/joins.json"},state:{pagesInRange:0,pageSize:5},queryParams:{totalPages:null,totalRecords:null,pageSize:"limit",currentPage:null,offset:function(){return(this.state.currentPage-1)*this.state.pageSize}},parseState:function(t,i,e,n){return{totalRecords:t._count}},parseRecords:function(t,i){return t.data}})}),define("text!apps/goods/templates/bargain/bargain_list_item.html",[],function(){return'<img src="{{=it.member_avatar || \'/image/default_head_img.jpg\'}}">\n<p class="kan-detail-name cl-dark-grey f-toe">{{=it.member_name || \'佚名\'}}</p>\n<p class="time">{{=it.created_at}}</p>\n<span class="kan-price">-￥{{=it.cut_price}}</span>'}),define("apps/goods/views/bargain/bargain_list_item",["backbone","doT","text!apps/goods/templates/bargain/bargain_list_item.html"],function(t,i,e){return t.View.extend({className:"kan-record",template:i.template(e),initialize:function(){},render:function(){return this.$el.html(this.template(this.model.toJSON())),this}})}),define("text!apps/goods/templates/bargain/bargain_list.html",[],function(){return'<div class="close-popup if if-close" data-popup=".popup-bargain-list"></div>\n<h4 class="popup-title">\n    <span>帮砍榜单</span>\n</h4>\n<p class="bargain-btns">\n    <a href="#" class="btn btn-sm btn-primary js-orderbyTime">最新</a>\n    <a href="#" class="btn btn-sm js-orderbyPrice">金额</a>\n</p>\n\n<form action="" class="form-horizontal m-bargain " role="form" onsubmit="return false;">\n	<!-- <div class="kan-record">\n		<img >\n		<p class="kan-detail cl-dark-grey">Asha</p>\n		<p class="time">刚刚</p>\n		<span class="kan-price">-￥255.00</span>\n	</div> -->\n	<div class="js-bargain-list">\n	</div>\n	<p class="more js-more" style="display:none;">查看更多</p>\n	<p class="more js-nomore" style="display:none;">没有更多了</p>\n</form>\n'}),define("apps/goods/views/bargain/bargain_list",["backbone","doT","apps/goods/collections/bargain_list","apps/goods/views/bargain/bargain_list_item","text!apps/goods/templates/bargain/bargain_list.html"],function(t,i,e,n,s){return t.View.extend({className:"popup popup-bargain-list remove-on-close",template:i.template(s),events:{"click .js-orderbyTime":"orderbyTime","click .js-orderbyPrice":"orderbyPrice","click .js-more":"more"},orderbyTime:function(t){var i=this;$(t.target).addClass("btn-primary").siblings().removeClass("btn-primary"),$(".js-bargain-list",i.$el).empty(),i.fromdt="",i.collection.state.currentPage=1,i.collection.queryParams.order_by="dt",i.collection.queryParams.fromdt=i.fromdt,i.collection.fetch({success:function(t,e,n){i.fromdt=e.fromdt}})},orderbyPrice:function(t){var i=this;$(t.target).addClass("btn-primary").siblings().removeClass("btn-primary"),$(".js-bargain-list",i.$el).empty(),i.fromdt="",i.collection.state.currentPage=1,i.collection.queryParams.order_by="money",i.collection.queryParams.fromdt=i.fromdt,i.collection.fetch({success:function(t,e,n){i.fromdt=e.fromdt}})},initialize:function(t){return this.fromdt="",this.collection=new e,this.collection.queryParams.order_by="dt",this.collection.queryParams.fromdt=this.fromdt,this.collection.bargain_id=t.bargain_id,this.collection.bargain_initiate_id=t.bargain_initiate_id,this.collection.on("sync",this.renderEach,this),this},render:function(){var t=this;return t.collection.fetch({success:function(i,e,n){t.fromdt=e.fromdt}}),t.$el.html(t.template()),$("form",t.$el).css({"max-height":"375px"}),t},renderEach:function(){this.collection.length>0?($(".js-more",this.$el).show(),$(".js-nomore",this.$el).hide(),this.collection.each(this.renderItem,this),setTimeout(function(){$.popup(".popup-bargain-list")},0)):$(".js-bargain-list",this.$el).html("暂时还木有人帮你砍价")},renderItem:function(t){$(".js-bargain-list",this.$el).append(new n({model:t}).render().$el)},more:function(){var t=this;t.collection.hasNextPage()?(t.collection.queryParams.fromdt=t.fromdt,t.collection.getNextPage()):($(".js-more",t.$el).hide(),$(".js-nomore",t.$el).show())}})}),define("text!apps/goods/templates/bargain/bargain_activity.html",[],function(){return'<div class="close-popup if if-close" data-popup=".popup-bargain-activity"></div>\n<h4 class="popup-title">活动说明</h4>\n<form action="" class="form-horizontal bargain-activity" role="form" onsubmit="return false;">\n  {{=it}}\n</form>\n'}),define("apps/goods/views/bargain/bargain_activity",["backbone","doT","text!apps/goods/templates/bargain/bargain_activity.html"],function(t,i,e){$("#views"),$("#panel-user");return t.View.extend({className:"popup popup-bargain-activity remove-on-close",template:i.template(e),events:{"click .js-save":"save","change input":"change"},initialize:function(t){this.data=t},render:function(){return this.$el.html(this.template(this.data)),setTimeout(function(){$.popup(".popup-bargain-activity")},0),$("form.bargain-activity",this.$el).css({"max-height":$(window).height()-100}),this}})}),define("text!apps/goods/templates/bargain/bargain_main.html",[],function(){return'<div class="m-bargain">\n    <div class="info">\n        <i class="icon-kan">砍</i>\n        <span class="title f-toe f-ib">{{=it.data.name}}</span>\n        <span class="stock">剩余：{{=it.data.diff_stock}}</span>\n    </div>\n    \n    <div class="progress">\n        <p class="price-info">\n            <span class="pull-left new-price">底价：￥{{=it.data.min_price}}</span>\n            <span class="pull-right old-price">原价：￥{{=it.data.max_price}}</span>\n        </p>\n        <div class="progress-tip">\n            <div class="circle left">\n                <div class="inner-circle"></div>\n            </div>\n            <p class="full js-full">\n                {{? (typeof it.data.bargained_member_avatar != \'undefined\')}}\n                 <div class="circle middle">\n                     <div class="inner-circle"></div>\n                     <div class="kan-info">\n                        <em></em>\n                        <i></i>\n                        <img src="{{=it.data.bargain_initiate_member_avatar}}">\n                        <span class="price">￥{{=it.data.current_price}}</span>\n                     </div>\n                 </div>\n                 {{?}}\n            </p>\n            <p class="really"></p>\n            <div class="circle right">\n                <div class="inner-circle"></div>\n            </div>\n        </div>\n    </div>\n    {{? (typeof it.data.bargained_member_avatar != \'undefined\')}}\n    <div class="line-middle"></div>\n    {{?}}\n    {{? (typeof it.data.cactor != \'undefined\' && it.data.cactor > 0)}}\n    <div class="bargain-tip">\n        <p class="join">已有<span class="number">{{=it.data.cactor}}</span>人参与</p>\n        <span class="triangle"></span>\n        <p class="order">\n        	{{? (typeof it.data.least_order_nickname != \'undefined\' && typeof it.data.least_order_amount != \'undefined\')}}\n            <marquee direction="left" behavior="scroll" scrollamount="3" scrolldelay="0" loop="-1"  >  \n                <span class="name">{{=it.data.least_order_nickname}}</span>砍到<span class="price">{{=it.data.least_order_amount}}元</span>成交！\n            </marquee>\n         \n            {{??}}\n            <marquee direction="left" behavior="scroll" scrollamount="3" scrolldelay="0" loop="-1"  >  \n                	暂无成交订单！\n            </marquee>\n            {{?}}\n        </p>\n    </div>\n    {{?}}\n    {{? !(it.data.is_self == 1 && it.data.is_bargain == 2)}}\n    <div class="kan-record js-kan-record">\n        <div class="info-line">\n            <img src="{{=it.data.bargained_member_avatar || \'/image/default_head_img.jpg\'}}">\n            <p class="kan-detail">\n                <span class="name f-toe">{{=it.data.bargained_member_name || \'佚名\'}}</span>\n                <span class="price f-fr">￥{{=it.data.bargained_cut_price}}</span>\n                <span class="cl-grey f-fr">砍掉</span>\n            </p>\n            <p class="time">{{=it.data.bargained_advance_time}}</p>\n        </div>\n        <i class="if if-chevron-right pull-right"></i>\n    </div>\n    {{?}}\n\n    <div class="activity-desc js-activity-desc">\n        活动说明\n        <i class="if if-chevron-right pull-right"></i>\n    </div>\n</div>'}),define("apps/goods/views/bargain/bargain_main",["backbone","doT","apps/goods/collections/bargain_list","apps/goods/views/bargain/bargain_list","apps/goods/views/bargain/bargain_activity","text!apps/goods/templates/bargain/bargain_main.html"],function(t,i,e,n,s,a){return t.View.extend({template:i.template(a),events:{"click .js-activity-desc":"activityDesc","click .js-kan-record":"bargainList"},initialize:function(t){return this.data=t,this},render:function(){this.$el.html(this.template(this.data));var t=(this.data.data.current_price-this.data.data.min_price)/(this.data.data.max_price-this.data.data.min_price)*100,i=100-t;return 18>=t?(this.$el.find(".kan-info").addClass("left"),this.$el.find(".kan-info em").addClass("left"),this.$el.find(".kan-info i").addClass("left"),this.$el.find(".circle.middle").css("left",t+"%")):t>=77?(this.$el.find(".kan-info").addClass("right"),this.$el.find(".kan-info em").addClass("right"),this.$el.find(".kan-info i").addClass("right"),this.$el.find(".circle.middle").css("right",i+"%"),this.$el.find(".circle.middle").css("margin-right","-.2rem")):this.$el.find(".circle.middle").css("left",t+"%"),this.$el.find(".js-full").css({width:t+"%"}),"undefined"!=typeof this.data.data.bargain_initiate_id&&$.setForward({title:this.data.data.bargain_initiate_member_name+"邀您来帮TA砍价",
desc:this.data.data.goods_title,link:_global.url.shop_url+"goods/"+this.data.data.goods_id+"/bi/"+this.data.data.bargain_initiate_id,imgUrl:this.data.data.bargain_initiate_member_avatar}),this},bargainList:function(){var t=this;$("body").append(new n({bargain_id:t.data.data.bargain_id,bargain_initiate_id:t.data.data.bargain_initiate_id}).render().$el)},activityDesc:function(){var t=this,i=new s(t.data.data.bargain_descri);$("body").append(i.render().$el)}})}),define("apps/goods/models/bargain_myself",["backbone"],function(t){return t.Model.extend({url:function(){return console.log(this),"/bargain/"+this.get("bargain_id")+"/initiate/me.json"}})}),define("apps/goods/models/help_bargain",["backbone"],function(t){return t.Model.extend({url:function(){return"/bargain/"+this.get("bargain_id")+"/initiate/"+this.get("bargain_initiate_id")+"/joins.json"}})}),define("text!apps/goods/templates/bargain/bargain_footer_tpl.html",[],function(){return'<!-- is_buy是活动发起人是否下过单 1购买还没支付完成 2还没下过单 3下单并支付成功-->\n<div class="goods-actions">\n    \n    {{?(it.data.is_disable == 1)}}\n        {{? it.data.is_self == 1}}\n        <!-- 作弊被抓 -->\n        <a href="/" class="cell"><i class="if if-store"></i><div>进店</div></a>\n        <div class="cell btns-cell">\n            <button class="btn-sm btn-cancel f-width100">您已被取消活动资格</button>\n        </div>\n        <!-- /作弊被抓 -->\n        {{?? it.data.is_self == 2}}\n            <!-- 作弊被抓 -->\n            <div class="cell btns-cell">\n                <button class="btn-sm btn-cancel">对方已被取消资格</button>\n                <button class="btn-sm btn-cart js-bargain-start">我也要发起</button>\n            </div>\n            <!-- /作弊被抓 -->\n        {{?}}\n    {{??}}\n        \n        {{?(it.data.is_self == \'1\' && it.data.is_bargain == \'2\' && it.data.is_buy == "2")}}\n        <!-- 自己立即砍价 -->\n        <div class="cell btns-cell">\n            <button class="btn-sm btn-buy js-bargain-self f-width100">立即砍价</button>\n        </div>\n        <!-- /自己立即砍价 -->\n        {{?? (it.data.is_self == \'1\' && it.data.is_bargain == \'1\' && it.data.is_buy == "2")}}\n        <!-- 找别人帮砍 -->\n        <div class="cell btns-cell">\n            {{?(it.data.current_price != it.data.min_price)}}\n            <button class="btn-sm btn-buy js-find-self-bargain">找人帮砍</button>\n            <button class="btn-sm btn-cart js-bargain-cart">立即购买</button>\n            {{??}}\n            <button class="btn-sm btn-cart js-bargain-cart f-width100">立即购买</button>\n            {{?}}    \n            \n        </div>\n        <!-- /找别人帮砍 -->\n        {{?? (it.data.is_self == \'2\' && it.data.is_bargain == \'2\' && it.data.is_buy == "2")}}\n        <!-- 帮他砍 -->\n        <div class="cell btns-cell">\n            {{? (it.data.current_price != it.data.min_price)}}\n            <button class="btn-sm btn-buy js-help-bargain">帮Ta砍</button>\n            <button class="btn-sm btn-cart js-bargain-start">我也要发起</button>\n            {{??}}\n            <button class="btn-sm btn-cart js-bargain-start f-width100">我也要发起</button>\n            {{?}}\n        </div>\n        <!-- /帮他砍 -->\n        {{?? (it.data.is_self == \'2\' && it.data.is_bargain == \'2\' && it.data.is_buy != "2")}}\n        <!-- 自己去发起 -->\n        <div class="cell btns-cell">\n            <button class="btn-sm btn-cart js-bargain-start f-width100">我也要发起</button>\n        </div>\n        <!-- /自己去发起 -->\n        {{?? (it.data.is_self == \'2\' && it.data.is_bargain == \'1\')}}\n        <!-- 我也要发起 -->\n        <div class="cell btns-cell">\n            {{? (it.data.is_buy == "2" && (it.data.current_price != it.data.min_price))}}\n            <button class="btn-sm btn-buy js-find-ta-bargain">找人帮Ta砍</button>\n            <button class="btn-sm btn-cart js-bargain-start">我也要发起</button>\n            {{??}}\n            <button class="btn-sm btn-cart js-bargain-start f-width100">我也要发起</button>\n            {{?}}\n\n        </div>\n        <!-- /我也要发起 -->\n        {{?? (it.data.is_self == \'1\' && it.data.is_bargain == \'1\' && it.data.is_buy == "1")}}\n        <!-- 已经成功下单 -->\n        <div class="cell btns-cell">\n            <button class="btn-sm btn-buy f-width100 js-gopay">您有未完成订单,去支付</button>\n        </div>\n        <!-- /已经成功下单 -->\n\n        {{?? (it.data.is_self == \'1\' && it.data.is_bargain == \'1\' && it.data.is_buy == "3")}}\n        <!-- 分享链接里，成功下单，发起第二次砍价 -->\n        <div class="cell btns-cell">\n            <button class="btn-sm btn-buy f-width100 js-cut-again">再次发起砍价</button>\n        </div>\n        <!-- /分享链接里，成功下单，发起第二次砍价 -->\n        {{?}}\n    {{?}}\n    <!-- 被抢光了 -->\n    <!-- <p class="tip">已经抢光了，下次继续努力！</p>\n    <div class="cell btns-cell">\n        <button class="btn-sm btn-buy js-bargain-cart">我知道了</button>\n    </div>\n    <!-- /被抢光了 --> \n\n    <!--<a href="" class="cell"><i class="if if-cart"></i>购物车</a>-->\n</div>'}),define("apps/goods/views/bargain/bargain_footer_view",["backbone","doT","apps/goods/models/bargain_myself","apps/goods/models/bargain","apps/goods/models/help_bargain","apps/goods/views/bargain/bargain_share","text!apps/goods/templates/bargain/bargain_footer_tpl.html","components/share/view","components/cart/views/main"],function(t,i,e,n,s,a,o,l,r){return t.View.extend({className:"bar bottom-bar",template:i.template(o),events:{"click .js-bargain-self":"bargainBySelf","click .js-find-self-bargain":"helpOthersBargain","click .js-help-bargain":"helpBargain","click .js-bargain-cart":"bargainCart","click .js-find-ta-bargain":"helpOthersBargain","click .js-bargain-start":"bargainStart","click .js-gopay":"goPay","click .js-cut-again":"cutAgain"},initialize:function(t){return this.data=t,this.bargainMyselfModel=new e,this.bargainModel=new n,this.helpBargainModel=new s,this},render:function(){return this.$el.html(this.template(this.data)),this.delegateEvents(),this},bargainBySelf:function(){var i=this;if(!_global.user){if($.device.weixin)return $.authRedirect(),!1;var e=decodeURIComponent(t.history.location.pathname.substring(1));return t.history.navigate("login?"+e,{trigger:!0,replace:!0}),!1}return $.device.weixin&&void 0!=_global.user.weixin_info?($.authRedirect(),!1):(i.bargainMyselfModel.set({bargain_id:i.data.data.bargain_id}),$.indicator(),i.undelegateEvents(),void i.bargainMyselfModel.save("","",{success:function(t,e,n){if($.indicator("hide"),e.status){if("1"==e.is_role)if(e.finished_price==i.data.data.min_price)var s='<p class="bargain-msg-price md0">- '+e.cut_price+'</p>                                                <p class="md0">'+e.msg+"</p>";else var s='<p class="bargain-msg-price md0">- '+e.cut_price+'</p>                                                <p class="cl-gray md0">(含新用户加成-'+e.max_plus_price+')</p>                                                <p class="md0">'+e.msg+"</p>";else if("2"==e.is_role)if(e.finished_price==i.data.data.min_price)var s='<p class="bargain-msg-price md0">- '+e.cut_price+'</p>                                        <p class="md0">'+e.msg+"</p>";else var s='<p class="bargain-msg-price md0">- '+e.cut_price+'</p>                                                <p class="cl-gray md0">(含微信粉丝加成-'+e.max_plus_price+')</p>                                                <p class="md0">'+e.msg+"</p>";else if("0"==e.is_role)var s='<p class="bargain-msg-price md0">- '+e.cut_price+'</p>                                    <p class="md0">'+e.msg+"</p>";$.alert(s),i.trigger("footer")}else e.is_end?$.alert("很遗憾此次砍价活动已结束",function(){location.reload()},"直接购买"):($.toast(e.msg),i.delegateEvents())}}))},helpOthersBargain:function(){var t=new a(this.data).render().$el;$("body").append((new l).render({cancel:1,content:t,open:1}).$el)},helpBargain:function(){var i=this;if(_global.user){if($.device.weixin&&0==i.data.data.union_public_id){var e=encodeURIComponent(document.URL),n=_global.url.auth+"auth/templogin?id="+_global.shop.id+"&redirect_uri="+e;return window.location.href=n,!1}}else{if(!$.device.weixin){var e=decodeURIComponent(t.history.location.pathname.substring(1));return t.history.navigate("login?"+e,{trigger:!0,replace:!0}),!1}if(0==i.data.data.union_public_id){var e=encodeURIComponent(document.URL),n=_global.url.auth+"auth/templogin?id="+_global.shop.id+"&redirect_uri="+e;return window.location.href=n,!1}}i.helpBargainModel.set({bargain_id:i.data.data.bargain_id,bargain_initiate_id:i.data.data.bargain_initiate_id}),$.indicator(),i.helpBargainModel.save("","",{success:function(t,e,n){if($.indicator("hide"),e.status){if("1"==e.is_role)if(e.finished_price==i.data.data.min_price)var s='<p class="bargain-msg-price md0">- '+e.cut_price+'</p>                                                <p class="md0">'+e.msg+"</p>";else var s='<p class="bargain-msg-price md0">- '+e.cut_price+'</p>                                                <p class="cl-gray md0">(含新用户加成-'+e.max_plus_price+')</p>                                                <p class="md0">'+e.msg+"</p>";else if("2"==e.is_role)if(e.finished_price==i.data.data.min_price)var s='<p class="bargain-msg-price md0">- '+e.cut_price+'</p>                                        <p class="md0">'+e.msg+"</p>";else var s='<p class="bargain-msg-price md0">- '+e.cut_price+'</p>                                                <p class="cl-gray md0">(含微信粉丝加成-'+e.max_plus_price+')</p>                                                <p class="md0">'+e.msg+"</p>";else if("0"==e.is_role)var s='<p class="bargain-msg-price md0">- '+e.cut_price+'</p>                                    <p class="md0">'+e.msg+"</p>";$.alert(s)}else $.toast(e.msg);i.trigger("footer")}})},bargainStart:function(){var i=this;if(!_global.user){if($.device.weixin)return $.authRedirect(),!1;var e=decodeURIComponent(t.history.location.pathname.substring(1));return t.history.navigate("login?"+e,{trigger:!0,replace:!0}),!1}return $.device.weixin&&void 0!=_global.user.weixin_info?($.authRedirect(),!1):void t.history.navigate("goods/"+i.data.data.goods_id,{trigger:!0})},bargainCart:function(t){var i=this,e=new r;e.umpOpen({gid:i.data.data.goods_id,umpType:"bargain",btnType:6,bargain_id:i.data.data.bargain_id,bargain_initiate_id:i.data.data.bargain_initiate_id})},goPay:function(){var t=this,i="";i=t.data.data.order_status==_global.order_config.order_status.ORDER_SUBMIT?_global.url.trade_url+"order/confirm?_="+_global.shop.id+"&order_id="+t.data.data.order_id:_global.url.trade_url+"order/"+t.data.data.order_id+"?_="+_global.shop.id,window.location.href=i},cutAgain:function(){var t=this;window.location.href=_global.url.shop_url+"goods/"+t.data.data.goods_id}})}),define("text!apps/goods/templates/seckill/seckill_main.html",[],function(){return'{{? it.data && it.data.ump && it.data.ump.alone && it.data.ump.alone.data}}\n<div class="price">\n    <span class="seckill-price">\n    	{{=it.data.ump.alone.data.price_title || \'秒杀价\'}} :\n        <i class="price-currency">{{=_global.setting.currency_unit}}</i>\n        <span>{{=it.data.ump.alone.data.price}}</span>\n    </span>\n    <del class="old-price">\n        <i class="price-currency">{{=_global.setting.currency_unit}}</i>\n        <span>{{=it.data.price ||\'0.00\'}}</span>\n    </del>\n</div>\n{{? (it.data.ump.alone.data.status == 2 && it.data.ump.alone.data.seckill_schedule_show == 1)}}\n<div class="progress">\n	<div class="goods-stock clearfix">\n        <div class="stock-percent-text">还剩<span class="stock-percent"></span></div>\n        <div class="stock-text">\n            库存:<span>{{=it.data.stock || \'0\'}}</span>\n        </div>\n    </div>\n    <div class="sale-progress-bar">\n        <div class="sale-progress-bar-inner">\n        </div>\n    </div>\n</div>\n{{?}}\n{{? it.data.ump.alone.data.status == 1 }}\n<div class="count-down start-count-down clearfix">\n    <div class="inner">\n        <span>距离开抢时间:</span>\n        <ul>\n            <li class="num"><span class="static old">{{=it.diffDate[0]}}</span></li>\n            <li class="num"><span class="static old">{{=it.diffDate[1]}}</span></li>\n            <li class="separator"><span>:</span></li>\n            <li class="num"><span class="static old">{{=it.diffDate[2]}}</span></li>\n            <li class="num"><span class="static old">{{=it.diffDate[3]}}</span></li>\n            <li class="separator"><span>:</span></li>\n            <li class="num"><span class="static old">{{=it.diffDate[4]}}</span></li>\n            <li class="num"><span class="static old">{{=it.diffDate[5]}}</span></li>\n        </ul>\n    </div>\n</div>\n{{?}}\n{{? it.data.ump.alone.data.status ==2 && it.data.ump.alone.data.finished_at_show == 1 && it.data.ump.alone.data.finished_at!=\'0000-00-00 00:00:00\' }}\n<div class="count-down end-count-down clearfix">\n    <div class="inner">\n        <span>距离结束时间:</span>\n        <ul>\n            <li class="num"><span class="static old">{{=it.diffDate[0]}}</span></li>\n            <li class="num"><span class="static old">{{=it.diffDate[1]}}</span></li>\n            <li class="separator"><span>:</span></li>\n            <li class="num"><span class="static old">{{=it.diffDate[2]}}</span></li>\n            <li class="num"><span class="static old">{{=it.diffDate[3]}}</span></li>\n            <li class="separator"><span>:</span></li>\n            <li class="num"><span class="static old">{{=it.diffDate[4]}}</span></li>\n            <li class="num"><span class="static old">{{=it.diffDate[5]}}</span></li>\n        </ul>\n    </div>\n</div>\n{{?}}\n{{?}}\n'}),define("apps/goods/views/seckill/seckill_main",["backbone","doT","text!apps/goods/templates/seckill/seckill_main.html"],function(t,i,e){return t.View.extend({template:i.template(e),initialize:function(t){return this.data=t,this.flag=!0,this},render:function(){if(this.data&&this.data.data&&this.data.data.ump&&this.data.data.ump.alone&&this.data.data.ump.alone.data){var t=this.data.data.ump.alone.data;this.data.diffDate=[0,0,0,0,0,0],createdDate=this.getTime(t.created_at),presaleDate=this.getTime(t.presale_at),finishedDate=this.getTime(t.finished_at),nowDate=this.getTime(t.now_at),1==t.status?this.isMaxDate(createdDate,nowDate)&&(this.setDiffDate(createdDate,presaleDate),this.begin("preSale")):2==t.status&&0!=t.finished_at_show&&"0000-00-00 00:00:00"!=t.finished_at&&(this.setDiffDate(finishedDate,nowDate),this.begin("endSale")),$(".main-price").hide(),this.$el.html(this.template(this.data));var i=this.data.data.stock+this.data.data.csale,e=this.data.data.stock/i;$(".sale-progress-bar-inner",this.$el).css({width:100*e+"%"}),$(".stock-percent",this.$el).html((100*e).toFixed(0)+"%")}else this.$el.html(this.template({}));return this},setDiffDate:function(t,i,e){var n=this.dateDiff(t,i);n.hours<0&&n.minutes<0&&n.seconds<0?this.reset():(this.flag=!1,this.data.diffDate[0]=parseInt(n.hours/10),this.data.diffDate[1]=n.hours%10,this.data.diffDate[2]=parseInt(n.minutes/10),this.data.diffDate[3]=n.minutes%10,this.data.diffDate[4]=parseInt(n.seconds/10),this.data.diffDate[5]=n.seconds%10)},getTime:function(t){return new Date(Date.parse(t.replace(/-/g,"/"))).getTime()},isMaxDate:function(t,i){return t>i?!0:!1},dateDiff:function(t,i){var e,n,s=this.getTime(this.data.data.ump.alone.data.now_at),a=0,o={};return i=this.isMaxDate(i,s)?i:s,a=t-i,o.hours=Math.floor(a/36e5),e=a%36e5,o.minutes=Math.floor(e/6e4),n=e%6e4,o.seconds=Math.floor(n/1e3),o},reset:function(){var t=this;t.flag=!0,t.data.diffDate=[0,0,0,0,0,0]},begin:function(t){var i=this;i.timer=setTimeout(function(){i.flag||(i.getData(t)?(i.reset(),i.trigger("main")):i.begin(t))},1e3)},getData:function(t){var i=this,e=i.data.diffDate;if(e[5]>0)e=[e[0],e[1],e[2],e[3],e[4],e[5]-1],i.changeNum(5,e[5]);else if(e[4]>0)e=[e[0],e[1],e[2],e[3],e[4]-1,9],i.changeNum(4,e[4]),i.changeNum(5,9);else if(e[3]>0)e=[e[0],e[1],e[2],e[3]-1,5,9],i.changeNum(3,e[3]),i.changeNum(4,5),i.changeNum(5,9);else if(e[2]>0)e=[e[0],e[1],e[2]-1,9,5,9],i.changeNum(2,e[2]),i.changeNum(3,9),i.changeNum(4,5),i.changeNum(5,9);else if(e[1]>0)e=[e[0],e[1]-1,5,9,5,9],i.changeNum(1,e[1]),i.changeNum(2,5),i.changeNum(3,9),i.changeNum(4,5),i.changeNum(5,9);else{if(!(e[0]>0))return!0;e=[e[0]-1,9,5,9,5,9],i.changeNum(0,e[0]),i.changeNum(1,9),i.changeNum(2,5),i.changeNum(3,9),i.changeNum(4,5),i.changeNum(5,9)}if(i.data.diffDate=e,"preSale"==t){var n=1*(i.data.diffDate[0]+""+i.data.diffDate[1]+i.data.diffDate[2]+i.data.diffDate[3]+i.data.diffDate[4]+i.data.diffDate[5]);300>n&&($(".js-setting-remind").remove(),$(".js-purchase-now-disabled").addClass("show"))}return!1},changeNum:function(t,i){$(".seckill").find("span.old:eq("+t+")").before('<span class="static new">'+i+"</span>"),$(".seckill .old:eq("+t+")").animate({top:"70px",opacity:"0"},300).remove(),$(".new").animate({top:"0px",opacity:"1"},300).removeClass("new").addClass("old")}})}),define("apps/goods/models/seckill_remind",["backbone"],function(t){return t.Model.extend({url:function(){return"/seckill/"+this.get("seckill_id")+"/remind.json"}})}),define("apps/goods/models/seckill_skudata",["backbone"],function(t){return t.Model.extend({url:function(){return this.id?"/seckill/"+this.id+"/getSeckillSku.json":void 0}})}),define("apps/goods/models/seckill_order",["backbone"],function(t){return t.Model.extend({url:function(){return console.log(this.get("seckill_id")),this.get("seckill_id")?"/seckill/"+this.get("seckill_id")+"/seckillOrder.json":void 0}})}),define("text!apps/goods/templates/seckill/seckill_purchase_now.html",[],function(){return'<div class="popup popup-sku remove-on-close">\n    <div class="goods-summary">\n        <div class="thumb"><img src="{{=_global.url.ms}}{{=it.img}}?imageMogr2/thumbnail/280x280"></div>\n        <div class="detail">\n            <p class="title">{{=it.title}}</p>\n            <div class="price-scope cart-price-num">\n                <i class="price-currency">{{=_global.setting.currency_unit}}</i>\n                {{?(it.is_sku)}}\n                <span class="price-integer">{{=it.price}}-{{=it.max_price}}</span>\n                {{??}}\n                {{?it.vip_price}}\n                <span class="price-integer">{{=parseInt(it.vip_price)}}</span>\n                <span class="price-decimal">{{=it.vip_price.substring(it.vip_price.indexOf("."), it.vip_price.indexOf(".") + 3)}}</span>\n                {{??}}\n                <span class="price-integer">{{=parseInt(it.price)}}</span>\n                <span class="price-decimal">{{=it.price.substring(it.price.indexOf("."), it.price.indexOf(".") + 3)}}</span>\n                {{?}}\n                {{?}}\n            </div>\n        </div>\n        <div class="close-popup if if-close" data-popup=".popup-sku"></div>\n    </div>\n    <div class="popup-sku-content">\n    <ul class="sku-control cart-sku-control">\n        {{for(var i in it.goods_props){}}\n        <li>\n            <h2>{{=it.goods_props[i].name}}</h2>\n            <div class="items cart-sku-items">\n                {{~it.goods_props[i].gps:v:index}}\n                <label class="cart-sku-click {{?(v.stock <= 0)}}disabled{{?}} sku-click-{{=it.goods_props[i].id}}{{=v.prop_vid}}" data-str="{{=it.goods_props[i].id}}:{{=v.prop_vid}}">{{=v.prop_value}}</label>\n                {{~}}\n            </div>\n        </li>\n        {{}}}\n    </ul>\n    {{?(it.btnType != 3)}}\n    <div class="quantity-control clearfix">\n        <label>数量</label>\n        <div class="quantity">\n            <button class="minus cart-num-minus disabled"><i class="if if-minis"></i></button>\n            <input type="tel" name="cart-num" value="1" >\n            <button class="plus cart-num-plus"><i class="if if-plus"></i></button>\n        </div>\n        <div class="stock">库存：<span class="cart-stock-num">{{=it.stock}}</span></div>\n    </div>\n    <div class="message-control">\n        <form class="form-horizontal" role="form">\n            {{~it.collect_fields:v:index}}\n            <div class="form-group">\n                <label>{{=v.name}}</label>\n{{switch(v.type){}}\n{{case \'date\':}}\n<input type="text" name="{{=v.type+index}}" {{?(v.required)}}required{{?}} class="form-item date-input" placeholder="请选择{{=v.name}}" />\n{{break;}}\n{{case \'time\':}}\n<input type="text" name="{{=v.type+index}}" {{?(v.required)}}required{{?}} class="form-item time-input" placeholder="请选择{{=v.name}}" />\n{{break;}}\n{{case \'multipleText\':}}\n<textarea name="{{=v.type+index}}" {{?(v.required)}}required{{?}} class="form-item">{{?v.value}}{{=v.value}}{{?}}</textarea>\n{{break;}}\n{{default:}}\n<input type="text" name="{{=v.type+index}}" {{?(v.required)}}required{{?}} {{?v.value}}value="{{=v.value}}"{{?}} class="form-item" placeholder="请填写{{=v.name}}">\n{{}}}\n            </div>\n            {{~}}\n        </form>\n    </div>\n    {{?}}\n{{switch(it.btnType){}}\n{{case 0:}}\n    <div class="popup-options cart-btn-two">\n        <button type="button" class="btn btn-block btn-cart cart-submit-btn">加入购物车</button>\n        <button type="button" class="btn btn-block btn-buy cart-buy-btn">立即购买</button>\n    </div>\n{{break;}}\n{{case 1:}}\n    <div class="popup-options">\n        <button type="button" class="btn btn-block btn-cart cart-submit-btn">加入购物车</button>\n    </div>\n{{break;}}\n{{case 2:}}\n    <div class="popup-options">\n        <button type="button" class="btn btn-block btn-buy cart-buy-btn">立即购买</button>\n    </div>\n{{break;}}\n{{case 3:}}\n    <div class="popup-options">\n        <button type="button" class="btn btn-block btn-buy cart-sku-submit-btn">确认修改</button>\n    </div>\n{{break;}}\n{{case 4:}}\n    <div class="popup-options">\n        <button type="button" class="btn btn-block btn-buy cart-submit-btn">确认</button>\n    </div>\n{{break;}}\n{{case 5:}}\n    <div class="popup-options">\n        <button type="button" class="btn btn-block btn-buy cart-buy-btn">确认</button>\n    </div>\n{{break;}}\n{{}}}\n</div>\n</div>'}),define("apps/goods/views/seckill/seckill_purchase_now",["backbone","doT","apps/goods/models/seckill_skudata","apps/goods/models/seckill_order","text!apps/goods/templates/seckill/seckill_purchase_now.html"],function(Backbone,doT,Model,SeckillOrderModel,Tpl){return Backbone.View.extend({el:"body",events:{"click .cart-num-plus":"numPlus","click .cart-num-minus":"numMinus",'change input[name="cart-num"]':"numChange","click .cart-submit-btn":"addCart","click .cart-sku-submit-btn":"updateSku","click .cart-buy-btn":"buy","click .close-popup":"closeModal","click .popup-overlay.visible":"closeModal"},template:doT.template(Tpl),initialize:function(){this.model=new Model,this.seckillOrderModel=new SeckillOrderModel},open:function(t,i){if(!_global.user){if($.device.weixin)return $.authRedirect(),!1;var e=decodeURIComponent(Backbone.history.location.pathname.substring(1)+Backbone.history.location.search);return Backbone.history.navigate("login?"+e,{trigger:!0,replace:!0}),!1}if($.device.weixin&&void 0!=_global.user.weixin_info)return $.authRedirect(),!1;if(i)var n=i,s=0;else{var a=$(t.currentTarget),n=(parseInt(a.attr("cart-type"))||0,a.attr("cart-gid")),s=a.attr("cart-pid")||0;t.stopPropagation(),t.preventDefault()}var o=this;$.indicator(),this.undelegateEvents(),this.selected={},o.model.set({id:i}),o.model.set({seckill_id:i}),this.model.fetch({success:function(t,i,e){if(i.id=n,i.btnType=5,o.skuStock(),i.collect_fields=o.getDefaultCollectFields(i.collect_fields),o.$el.append(o.template(i)),$(".cart-sku-click").bind("click",function(t){o.skuSelect(t)}),o.inputDom=$("input[name='cart-num']"),o.minusDom=$(".cart-num-minus"),o.plusDom=$(".cart-num-plus"),o.stockDom=$(".cart-stock-num"),o.priceDom=$(".cart-price-num"),o.stock=o.model.get("stock"),0!=s){var a=o.getPropStr(s),l=a.split(";");for(var r in l){var c=l[r].split(":").join(""),d=$(".sku-click-"+c);d.trigger("click")}}$(".popup-sku-content",o.$el).css({"max-height":$(window).height()-100}),$.popup(".popup-sku"),$(".date-input").calendar({dateFormat:"yyyy-mm-dd"}),$(".time-input").datetimePicker({toolbarTemplate:'<header class="bar bar-nav">	                        <button class="button button-link pull-right close-picker">确定</button>	                        <h1 class="title">选择日期和时间</h1>	                        </header>'}),o.delegateEvents(),$.indicator("hide")}})},getDefaultCollectFields:function(data){var collectFieldHistory=localStorage.getItem("collectFieldHistory");if(collectFieldHistory){collectFieldHistory=eval("("+collectFieldHistory+")");for(var i in data)data[i].value="",collectFieldHistory[data[i].type]&&(data[i].value=collectFieldHistory[data[i].type])}return data},numPlus:function(t){if(!$(t.currentTarget).hasClass("disabled")){var i=parseInt(this.inputDom.val())+1;this.inputDom.val(i).trigger("change")}},numMinus:function(t){if(!$(t.currentTarget).hasClass("disabled")){var i=parseInt(this.inputDom.val())-1;this.inputDom.val(i).trigger("change")}},numChange:function(){var t=this.inputDom.val();if(!/^[1-9]\d*$/.test(t)){if($.toast("请填写正整数"),!(parseInt(t)>0))return this.inputDom.val(1),!1;this.inputDom.val(parseInt(t))}t=parseInt(t),t>1?this.minusDom.removeClass("disabled"):1>=t&&(this.minusDom.addClass("disabled"),1>t&&($.toast("至少购买1件噢"),this.inputDom.val(1))),t>=this.stock?(this.plusDom.addClass("disabled"),t>this.stock&&($.toast("只有"+this.stock+"件啦"),this.inputDom.val(this.stock))):this.plusDom.removeClass("disabled")},getPropStr:function(t){var i=this.model.get("products");for(var e in i)if(i[e].id==t)return i[e].props;return!1},skuStock:function(t){this.props=this.model.get("goods_props");for(var i in this.props){var e=this.props[i];for(var n in e.gps){var s=e.gps[n],a=[e.id+":"+s.prop_vid];e.gps[n].stock=this.getStock(a)}}},getStock:function(t){var i=this.model.get("products"),e=0;for(var n in i)this.checkStock(t,i[n].props)&&(e+=i[n].stock);return e},checkStock:function(t,i){var e=!0;for(var n in t)if(-1==i.indexOf(t[n])){e=!1;break}return e},skuSelect:function(t){var i=$(t.currentTarget);if(this.selectInfo=null,!i.hasClass("disabled")){i.toggleClass("checked").siblings().removeClass("checked");var e=i.parent(".cart-sku-items").parent("li").index();if(i.hasClass("checked")?this.selected[e]=i.attr("data-str"):delete this.selected[e],this.skuEach(),Object.keys(this.props).length==Object.keys(this.selected).length){this.stock=this.getStock(this.selected),this.stockDom.text(this.stock),this.inputDom.trigger("change"),this.selectInfo=this.getSkuInfo();var n=this.selectInfo.price;this.selectInfo.vip_price&&(n=this.selectInfo.vip_price),this.priceDom.html('<i class="price-currency">￥</i>\n<span class="price-integer">'+parseInt(n)+'</span>\n<span class="price-decimal">'+n.substring(n.indexOf("."),n.indexOf(".")+3)+"</span>")}else this.stock=this.model.get("stock"),this.stockDom.text(this.stock),this.inputDom.trigger("change"),this.priceDom.html('<i class="price-currency">￥</i>\n<span class="price-integer">'+this.model.get("price")+"-"+this.model.get("max_price")+"</span>\n")}},skuEach:function(){var t=this;$(".cart-sku-control").children("li").each(function(){var i=$(this).index(),e=[],n=0;for(var s in t.selected)i!=s&&e.push(t.selected[s]);$(this).children(".cart-sku-items").children("label").each(function(){var i=[];i=$.copyObj(e),i.push($(this).attr("data-str")),n=t.getStock(i),0>=n?$(this).addClass("disabled"):$(this).removeClass("disabled")})})},getSkuInfo:function(){var t=this.model.get("products"),i={};for(var e in t){var n=t[e];if(this.checkStock(this.selected,n.props)){i={id:n.id,price:n.price,props_str:n.props_str,vip_price:n.vip_price};break}}return i},validityCollectFields:function(){var t=$.copyObj(this.model.get("collect_fields"));for(var i in t)"multipleText"!=t[i].type?t[i].value=$.trim($("input[name='"+t[i].type+i+"']").val()):t[i].value=$.trim($("textarea[name='"+t[i].type+i+"']").val());var e=$.validity(t);return e.status?t:($.toast(e.error),!1)},addCart:function(){this.cartSubmit(0)},updateSku:function(){this.trigger("updateSku",this.selectInfo)},buy:function(t){this.cartSubmit(1,t)},cartSubmit:function(t,i){var e={goods_id:this.model.get("id"),seckill_id:this.model.get("seckill_id"),quantity:parseInt(this.inputDom.val())},n=this;if(this.model.get("is_sku")){if(!this.selectInfo)return $.toast("请先选择规格尺寸"),!1;e.product_id=this.selectInfo.id}$.indicator(),$(i.target).removeClass("cart-buy-btn"),$(i.target).removeClass("btn-buy"),$(i.target).addClass("disabled-btn");var s=this.model.get("collect_fields");if(s){var a=this.validityCollectFields();if(!a)return!1;e.fields=a,$.localStorage&&this.setCollectFieldHistory(a)}this.seckillOrderModel.set({seckill_id:this.model.get("seckill_id")}),this.seckillOrderModel.set({goods:[e]}),this.seckillOrderModel.save("","",{success:function(i,e,s){e.status?(n.closeModal(),t?window.location.href=_global.url.trade_url+"order/confirm?_="+_global.shop.id+"&order_id="+e.order_id:(0==_global.cart.count&&$(".js-go-cart").append("<em></em>"),_global.cart.count++,$.toast("添加成功，在购物车等亲～"))):($.toast(e.msg),n.delegateEvents()),$.indicator("hide")}})},setCollectFieldHistory:function(data){var collectFieldHistory=localStorage.getItem("collectFieldHistory");collectFieldHistory=collectFieldHistory?eval("("+collectFieldHistory+")"):{};for(var i in data){var res=data[i];"date"!=res.type&&"time"!=res.type&&(collectFieldHistory[res.type]=res.value)}localStorage.setItem("collectFieldHistory",JSON.stringify(collectFieldHistory))},closeModal:function(){$.closeModal(".popup-sku"),this.undelegateEvents()}})}),define("text!apps/goods/templates/seckill/seckill_footer_tpl.html",[],function(){return'<div class="goods-actions seckill-actions">\n{{? it.data.status == 1 }}\n<!--remind_seted = 0  没有设置了提醒 -->\n{{? !it.data.remind_seted}}\n    <div class="btns cell">\n        <button class="btn-sm btn-group js-setting-remind" >\n        	<i class="if if-miaosha"></i>\n        设置提醒</button>\n        <button class="btn-sm btn-default btn-group js-purchase-now-disabled hide">立即抢购</button>\n    </div>\n{{?}}\n<!--remind_seted = 1  设置了提醒 -->\n{{? it.data.remind_seted == 1}}\n   <div class="btns cell">\n        <button class="btn-sm btn-group has-set-remind" >\n        	<i class="if if-miaosha"></i>\n        已设置,提前3分钟提醒</button>\n    </div>\n{{?}}\n{{?}}\n\n{{? it.data.status == 2 }}\n<div class="btns cell">\n    <button class="btn-sm btn-group js-purchase-now" >\n    立即抢购</button>\n</div>\n{{?}}\n</div>'}),define("apps/goods/views/seckill/seckill_footer_view",["backbone","doT","apps/goods/models/seckill_remind","apps/goods/views/seckill/seckill_purchase_now","text!apps/goods/templates/seckill/seckill_footer_tpl.html"],function(t,i,e,n,s){return t.View.extend({className:"bar bottom-bar",template:i.template(s),events:{"click .js-setting-remind":"settingRemind","click .js-purchase-now":"purchaseNow"},initialize:function(t){return this.data=t,this.seckillRemindModel=new e,this},render:function(){return this.$el.html(this.template(this.data)),this},settingRemind:function(){if(!_global.user){if($.device.weixin)return $.authRedirect(),!1;var i=decodeURIComponent(t.history.location.pathname.substring(1)+t.history.location.search);return t.history.navigate("login?"+i,{trigger:!0,replace:!0}),!1}if($.device.weixin&&void 0!=_global.user.weixin_info)return $.authRedirect(),!1;var e=this;e.seckillRemindModel.set({seckill_id:this.data.data.id}),$.indicator(),e.seckillRemindModel.save("","",{success:function(t,i,n){$.indicator("hide"),i.status?e.trigger("footer"):$.toast(i.msg)}})},purchaseNow:function(t){var i=new n;i.open(t,this.data.data.id)}})}),define("text!apps/goods/templates/bangmian/bangmian_main.html",[],function(){return'{{?it.data.ump.alone.data.bangmian_initiate_id != 0 && it.data.ump.alone.data.bmi_status != 2}}\n<div class="mod-pop">\n    <img src="/image/tishi.png">\n</div>\n<div class="ingroup">\n    <div class="bangmian-initiate">\n        <img src="{{=it.data.ump.alone.data.bmi_member_avatar || \'/image/default_head_img.jpg\'}}">\n        <span>{{=it.data.ump.alone.data.bmi_member_name}}</span>\n        <font>邀您帮免单</font>\n    </div>\n	<div class="endtime">\n        {{?it.data.ump.alone.data.bmi_end == 1}}\n            活动已结束\n        {{??}}\n    	距离结束：<font class="t_d">0</font>天<font class="t_h">0</font>时<font class="t_m">0</font>分<font class="t_s">0</font>秒\n        {{?}}\n    </div>\n    <div class="schedule">\n    	<div class="xian">\n            {{?it.data.ump.alone.data.peoples<= it.data.ump.alone.data.need_peoples}}\n                <div class="bottom"></div>\n        		<div class="top" style="width: {{=100*it.data.ump.alone.data.peoples/it.data.ump.alone.data.need_peoples}}%;"></div>\n        		{{?it.data.ump.alone.data.peoples==0}}\n        		<div class="start">0人</div>\n        		{{?}}\n        		<div class="in">实际参与{{=it.data.ump.alone.data.peoples}}人</div>\n        		<div class="end {{?it.data.ump.alone.data.need_peoples==it.data.ump.alone.data.peoples}}dq{{?}}">所需{{=it.data.ump.alone.data.need_peoples}}人</div>\n            {{??}}\n                <div class="bottom peoples-bg"></div>\n                <div class="top need-peoples-bg" style="width: {{=100*it.data.ump.alone.data.need_peoples/it.data.ump.alone.data.peoples}}%;"></div>\n                {{?it.data.ump.alone.data.need_peoples==0}}\n                <div class="start">0人</div>\n                {{?}}\n                <div class="in" >所需{{=it.data.ump.alone.data.need_peoples}}人</div>\n                <div class="end {{?it.data.ump.alone.data.need_peoples==it.data.ump.alone.data.peoples}}dq{{?}}">实际参与{{=it.data.ump.alone.data.peoples}}人</div>\n            {{?}}\n    	</div>\n    </div>\n    <div class="in-list">\n    	{{~it.data.ump.alone.data.bangmian_initiate_join.data:v:index}}\n    		<div class="img {{?index>50}} hide {{?}} ">\n    			<img src="{{=v.member_avatar || \'/image/default_head_img.jpg\'}}">\n    			<h6>{{=v.member_name || \'匿名\'}}</h6>\n    		</div>\n    	{{~}}\n    	<div class="if if-plus js-btn-group"></div>\n    </div>\n    {{?it.data.ump.alone.data.bangmian_initiate_join.data.length>50}}\n    <div class="more js-tx"><a>更多</a></div>\n    {{?}}\n    <div class="process-title clearfix">\n        <span>活动介绍</span>\n        <a href="/bangmian/rule/{{=it.data.ump.alone.data.bangmian_id}}/{{=it.data.ump.alone.data.bangmian_initiate_id}}">详细<i class="if if-chevron-right"></i></a>\n    </div>\n    <div class="process">\n        <ul class="clearfix">\n            <li>\n                <div class="step step1 light-gray">\n                    <div class="step-inner dark-gray"></div>\n                    <div class="step-mask">1</div>\n                </div>\n                <div class="step-text">购买活动商品</div>\n            </li>\n            <li>\n                <div class="step step2 light-gray {{?it.data.ump.alone.data.bangmian_initiate_join._count==0　&& it.data.ump.alone.data.bmi_status == 0}} orange-ft {{?}}">\n                    <div class="step-inner dark-gray {{?it.data.ump.alone.data.bangmian_initiate_join._count==0　&& it.data.ump.alone.data.bmi_status == 0　}} orange-bg {{?}}"></div>\n                    <div class="step-mask">2</div>\n                </div>\n                <div class="step-text">分享好友</div>\n            </li>\n            <li>\n                <div class="step step3 dark-gray {{?it.data.ump.alone.data.bangmian_initiate_join._count>0 && it.data.ump.alone.data.bmi_status == 0}} orange-ft orange-bg {{?}}">\n                    <div class="step-inner light-gray"></div>\n                    <div class="step-mask">3</div>\n                </div>\n                <div class="step-text">好友购买</div>\n            </li>\n            <li>\n                <div class="step step4 light-gray  {{?it.data.ump.alone.data.bmi_status==1 || it.data.ump.alone.data.bmi_status == 2}} orange-ft {{?}}"> \n                    <div class="step-inner dark-gray {{?it.data.ump.alone.data.bmi_status==1 || it.data.ump.alone.data.bmi_status == 2}} orange-bg {{?}}"></div>\n                    <div class="step-mask">4</div>\n                </div>\n                <div class="step-text">\n                    {{?it.data.ump.alone.data.bmi_status !=2}}\n                    帮忙成功免单\n                    {{??}}\n                    帮免失败\n                    {{?}}\n                </div>\n            </li>\n        </ul>\n    </div>\n</div>\n{{?}}\n';
}),define("apps/goods/views/bangmian/bangmian_main",["backbone","doT","text!apps/goods/templates/bangmian/bangmian_main.html"],function(i,e,n){return i.View.extend({template:e.template(n),events:{"click .js-btn-group":"group","click .mod-pop":"groupno","click .js-tx":"txshow"},initialize:function(t){return this.data=t,this},render:function(){this.$el.html(this.template(this.data)),this.data.data.ump.alone.data.finished_at&&"0000-00-00 00:00:00"!=this.data.data.ump.alone.data.finished_at&&0==this.data.data.ump.alone.data.bmi_end&&this.countDown(this.data);var t=this;return setTimeout(function(){$(".if-plus").css({height:$(".if-plus").width()+"px","line-height":$(".if-plus").width()+"px"});var i=$(".bottom").width(),e=$(".in").width(),n=0;n=t.data.data.ump.alone.data.peoples<=t.data.data.ump.alone.data.need_peoples?(t.data.data.ump.alone.data.peoples/t.data.data.ump.alone.data.need_peoples*i).toFixed(2):(t.data.data.ump.alone.data.need_peoples/t.data.data.ump.alone.data.peoples*i).toFixed(2),e/2>n?$(".in").css({left:0}):n>=e/2&&i-n>=e/2?$(".in").css({left:n-e/2+"px"}):($(".in").css({right:0}),$(".in").css({left:"auto"}))},100),this},countDown:function(i){function e(){t=endTime-nowTime,0==t&&(_this.trigger("main"),_this.trigger("footer"),clearInterval(o)),nowTime+=1e3,d=Math.floor(t/1e3/60/60/24),h=Math.floor(t/1e3/60/60%24),m=Math.floor(t/1e3/60%60),s=Math.floor(t/1e3%60),$(".t_d").html(d),$(".t_h").html(h),$(".t_m").html(m),$(".t_s").html(s)}var n=i.data.ump.alone.data.finished_at,a=i.data.ump.alone.data.now_at;endTime=new Date(Date.parse(n.replace(/-/g,"/"))).getTime(),nowTime=new Date(Date.parse(a.replace(/-/g,"/"))).getTime(),t=d=h=m=s=0,_this=this;var o=setInterval(e,1e3)},group:function(){$(".mod-pop").show()},groupno:function(){$(".mod-pop").hide()},txshow:function(){$(".in-list .img").removeClass("hide"),$(".js-tx").addClass("hide")}})}),define("apps/goods/models/bangmian",["backbone"],function(t){return t.Model.extend({url:function(){return"/bangmian/"+this.get("bangmian_id")+"/spread/"+this.get("bangmian_initiate_id")+".json"}})}),define("text!apps/goods/templates/bangmian/bangmian_share.html",[],function(){return'<section class="spread-qrcode">\n    <h3 class="spread-title">方法1：二维码图片分享</h3>\n    <div class="spread-qrcode-content" style="display: block;">\n        <div class="js-more-loading" style="margin: 0 auto"></div>\n    </div>\n    <div class="qrcode-info t_center"><div>正在加载二维码...</div></div>\n</section>\n<section class="spread-link">\n    <h3 class="spread-title">方法2：复制链接推广</h3>\n    <p class="copy-text js-copy-text">我非常想要这宝贝，大家快来帮我免单，能省一点、\n        是一点，猛戳链接：</p>\n</section>\n'}),define("apps/goods/views/bangmian/bangmian_share",["backbone","doT","apps/goods/models/bangmian","text!apps/goods/templates/bangmian/bangmian_share.html"],function(t,i,e,n){$("#views"),$("#panel-user");return t.View.extend({className:"view-guider-spread",template:i.template(n),events:{},initialize:function(t){this.bangmianModel=new e,this.bangmianModel.set({bangmian_id:t.bangmian_id,bangmian_initiate_id:t.bangmian_initiate_id})},render:function(){this.$el.html(this.template()),$(".js-more-loading",this.$el).loading("show");var t=this;return this.bangmianModel.fetch({success:function(i,e,n){$(".spread-qrcode-content",t.$el).html('<img style="margin: 10px auto;" src="'+e.bangmianQrcodeUrl+'">'),$(".js-copy-text",t.$el).append(e.bangmianSpreadUrl),$(".qrcode-info",t.$el).remove()}}),this}})}),define("text!apps/goods/templates/bangmian/bangmian_footer_tpl.html",[],function(){return'<div class="goods-actions bangmian-goods">\n	<a href="/" class="cell">\n        <i class="if if-store"></i>\n        <div>进店</div>\n    </a>\n    <div class="cell btns-cell">\n    	{{?it.data.ump.alone.data.bangmian_initiate_id == 0}} \n        <button class="btn-sm btn-buy js-btn-buy">立即购买</button>\n        {{??}}\n            {{?it.data.ump.alone.data.bmi_end == 1}}\n                <a href="/goods/{{=it.data.ump.alone.data.goods_id}}"class="btn-sm btn-buy abtn abtn-inline">我要发起</a>\n            {{?}}\n\n            {{?it.data.ump.alone.data.bmi_status == 2}}\n                <button class="btn-sm btn-buy">活动失败</button>\n                {{?it.data.ump.alone.data.is_self == 1}}\n                <a href="/goods/{{=it.data.ump.alone.data.goods_id}}"class="btn-sm btn-buy abtn abtn-inline">卷土重来</a>\n                {{?}}\n                {{?it.data.ump.alone.data.is_self == 2}}\n                <a href="/goods/{{=it.data.ump.alone.data.goods_id}}"class="btn-sm btn-buy abtn abtn-inline">我要发起</a>\n                {{?}}\n            {{??}}\n                {{?it.data.ump.alone.data.can_buy == 1}}\n                {{?it.data.ump.alone.data.is_self == 1}}\n                <button class="btn-sm btn-buy js-btn-find2buy">找人帮免</button>\n                {{?}}\n                {{?it.data.ump.alone.data.is_self == 2}}\n                <button class="btn-sm btn-buy js-btn-buy">立即帮忙</button>\n                <button class="btn-sm btn-buy js-btn-find2buy">找人帮免</button>\n                {{?}}\n                {{??}}\n                    <button class="btn-sm btn-buy js-btn-find2buy">找人帮免</button>\n                {{?}}\n                \n            {{?}}\n        {{?}}\n    </div>\n</div>'}),define("apps/goods/views/bangmian/bangmian_footer_view",["backbone","doT","components/cart/views/main","apps/goods/views/bangmian/bangmian_share","components/share/view","text!apps/goods/templates/bangmian/bangmian_footer_tpl.html"],function(t,i,e,n,s,a){return t.View.extend({className:"bar bottom-bar",template:i.template(a),events:{"click .js-btn-buy":"buy","click .js-btn-find2buy":"find2buy"},initialize:function(t){return this.data=t,this},render:function(){return this.$el.html(this.template(this.data)),this},buy:function(){var t=this,i=new e;i.umpOpen({gid:t.data.data.id,umpType:"bangmian",btnType:6,bangmian_id:t.data.data.ump.alone.data.bangmian_id,bangmian_initiate_id:t.data.data.ump.alone.data.bangmian_initiate_id})},find2buy:function(){var t={bangmian_id:this.data.data.ump.alone.data.bangmian_id,bangmian_initiate_id:this.data.data.ump.alone.data.bangmian_initiate_id},i=new n(t).render().$el;$("body").append((new s).render({cancel:1,content:i,open:1}).$el)}})}),define("components/cart/models/pintuan_skudata",["backbone"],function(t){return t.Model.extend({url:function(){return this.get("gid")?"/pintuan/goods_sku/"+this.get("gid")+"/item/"+this.get("pinid")+".json":void 0}})}),define("apps/trade/models/pintuan_buy",["backbone"],function(t){return t.Model.extend({url:function(){return this.id,"/pintuan/pintuan.json"}})}),define("apps/trade/models/buy",["backbone"],function(t){return t.Model.extend({url:function(){return this.id?"/confirm/buy/"+this.id+".json":"/confirm/buy.json"}})}),define("text!components/cart/templates/pintuan_main.html",[],function(){return'<div class="popup popup-sku remove-on-close">\n    <div class="goods-summary">\n        <div class="thumb"><img src="{{=_global.url.ms}}{{=it.img}}?imageMogr2/thumbnail/280x280"></div>\n        <div class="detail">\n            <p class="title">{{=it.title}}</p>\n            <div class="price-scope cart-price-num">\n                <i class="price-currency">{{=_global.setting.currency_unit}}</i>\n                {{?(it.is_sku)}}\n                <span class="price-integer">{{=it.price}}</span>\n                {{??}}\n                {{?it.vip_price}}\n                <span class="price-integer">{{=parseInt(it.vip_price)}}</span>\n                <span class="price-decimal">{{=it.vip_price.substring(it.vip_price.indexOf("."), it.vip_price.indexOf(".") + 3)}}</span>\n                {{??}}\n                <span class="price-integer">{{=parseInt(it.price)}}</span>\n                <span class="price-decimal">{{=it.price.substring(it.price.indexOf("."), it.price.indexOf(".") + 3)}}</span>\n                {{?}}\n                {{?}}\n            </div>\n        </div>\n        <div class="close-popup if if-close" data-popup=".popup-sku"></div>\n    </div>\n    <div class="popup-sku-content">\n    <ul class="sku-control cart-sku-control">\n        {{for(var i in it.goods_props){}}\n        <li>\n            <h2>{{=it.goods_props[i].name}}</h2>\n            <div class="items cart-sku-items">\n                {{~it.goods_props[i].gps:v:index}}\n                <label class="cart-sku-click {{?(v.stock <= 0)}}disabled{{?}} sku-click-{{=it.goods_props[i].id}}{{=v.prop_vid}}" data-str="{{=it.goods_props[i].id}}:{{=v.prop_vid}}">{{=v.prop_value}}</label>\n                {{~}}\n            </div>\n        </li>\n        {{}}}\n    </ul>\n    {{?(it.btnType != 3)}}\n    <div class="quantity-control clearfix">\n        <label>数量</label>\n        <div class="quantity">\n            <button class="minus cart-num-minus disabled"><i class="if if-minis"></i></button>\n            <input type="tel" name="cart-num" value="1" disabled="disabled">\n            <button class="plus cart-num-plus disabled"><i class="if if-plus"></i></button>\n        </div>\n        <div class="stock">库存：<span class="cart-stock-num">{{=it.stock}}</span></div>\n    </div>\n    <div class="message-control">\n        <form class="form-horizontal" role="form">\n            {{~it.collect_fields:v:index}}\n            <div class="form-group">\n                <label>{{=v.name}}</label>\n{{switch(v.type){}}\n{{case \'date\':}}\n<input type="text" name="{{=v.type+index}}" {{?(v.required)}}required{{?}} class="form-item date-input" placeholder="请选择{{=v.name}}" />\n{{break;}}\n{{case \'time\':}}\n<input type="text" name="{{=v.type+index}}" {{?(v.required)}}required{{?}} class="form-item time-input" placeholder="请选择{{=v.name}}" />\n{{break;}}\n{{case \'multipleText\':}}\n<textarea name="{{=v.type+index}}" {{?(v.required)}}required{{?}} class="form-item"></textarea>\n{{break;}}\n{{default:}}\n<input type="text" name="{{=v.type+index}}" {{?(v.required)}}required{{?}} class="form-item" placeholder="请填写{{=v.name}}">\n{{}}}\n            </div>\n            {{~}}\n        </form>\n    </div>\n    {{?}}\n<div class="popup-options">\n    <button type="button" class="btn btn-block btn-buy cart-buy-btn">立即购买</button>\n</div>\n</div></div>'}),define("components/cart/views/pintuan_main",["backbone","jquery","doT","components/cart/models/pintuan_skudata","apps/trade/models/pintuan_buy","apps/trade/models/buy","text!components/cart/templates/pintuan_main.html"],function(t,i,e,n,s,a,o){return t.View.extend({el:"body",events:{"click .cart-num-plus":"numPlus","click .cart-num-minus":"numMinus",'change input[name="cart-num"]':"numChange","click .cart-submit-btn":"addCart","click .cart-sku-submit-btn":"updateSku","click .cart-buy-btn":"buy","click .close-popup":"closeModal","click .popup-overlay.visible":"closeModal"},template:e.template(o),initialize:function(){this.model=new n,this.cartModel=new s,this.buyModel=new a},open:function(t,e){if(e)var n=e,s=0;else{var a=i(t.currentTarget),n=a.attr("data-gid"),s=a.attr("cart-pid")||0,o=a.attr("data-pid");this.type=parseInt(a.attr("data-type")),this.original_price=a.attr("data-originalprice"),this.price=a.attr("data-price"),this.ump_id=a.attr("data-umpid"),t.stopPropagation(),t.preventDefault()}var l=this;i.indicator(),this.undelegateEvents(),this.selected={},this.model.set({gid:n,pinid:o}),this.model.fetch({success:function(){if(l.skuStock(),l.$el.append(l.template(l.model.toJSON())),i(".cart-sku-click").bind("click",function(t){l.skuSelect(t)}),l.inputDom=i("input[name='cart-num']"),l.minusDom=i(".cart-num-minus"),l.plusDom=i(".cart-num-plus"),l.stockDom=i(".cart-stock-num"),l.priceDom=i(".cart-price-num"),l.stock=l.model.get("stock"),0!=s){var t=l.getPropStr(s),e=t.split(";");for(var n in e){var a=e[n].split(":").join(""),o=i(".sku-click-"+a);o.trigger("click")}}i(".popup-sku-content",l.$el).css({"max-height":i(window).height()-100}),i.popup(".popup-sku"),i(".date-input").calendar({dateFormat:"yyyy-mm-dd"}),i(".time-input").datetimePicker({toolbarTemplate:'<header class="bar bar-nav">                        <button class="button button-link pull-right close-picker">确定</button>                        <h1 class="title">选择日期和时间</h1>                        </header>'}),l.delegateEvents(),i.indicator("hide")}})},numPlus:function(t){if(!i(t.currentTarget).hasClass("disabled")){var e=parseInt(this.inputDom.val())+1;this.inputDom.val(e).trigger("change")}},numMinus:function(t){if(!i(t.currentTarget).hasClass("disabled")){var e=parseInt(this.inputDom.val())-1;this.inputDom.val(e).trigger("change")}},numChange:function(){var t=this.inputDom.val();if(!/^[1-9]\d*$/.test(t)){if(i.toast("请填写正整数"),!(parseInt(t)>0))return this.inputDom.val(1),!1;this.inputDom.val(parseInt(t))}t=parseInt(t),t>1?this.minusDom.removeClass("disabled"):1>=t&&(this.minusDom.addClass("disabled"),1>t&&(i.toast("至少购买1件"),this.inputDom.val(1))),t>=this.stock&&(this.plusDom.addClass("disabled"),t>this.stock&&(i.toast("只有"+this.stock+"件啦"),this.inputDom.val(this.stock)))},getPropStr:function(t){var i=this.model.get("products");for(var e in i)if(i[e].id==t)return i[e].props;return!1},skuStock:function(t){this.props=this.model.get("goods_props");for(var i in this.props){var e=this.props[i];for(var n in e.gps){var s=e.gps[n],a=[e.id+":"+s.prop_vid];e.gps[n].stock=this.getStock(a)}}},getStock:function(t){var i=this.model.get("products"),e=0;for(var n in i)this.checkStock(t,i[n].props)&&(e+=i[n].stock);return e},checkStock:function(t,i){var e=!0;for(var n in t)if(-1==i.indexOf(t[n])){e=!1;break}return e},skuSelect:function(t){var e=i(t.currentTarget);if(this.selectInfo=null,!e.hasClass("disabled")){e.toggleClass("checked").siblings().removeClass("checked");var n=e.parent(".cart-sku-items").parent("li").index();if(e.hasClass("checked")?this.selected[n]=e.attr("data-str"):delete this.selected[n],this.skuEach(),Object.keys(this.props).length==Object.keys(this.selected).length){this.stock=this.getStock(this.selected),this.stockDom.text(this.stock),this.inputDom.trigger("change"),this.selectInfo=this.getSkuInfo();var s=this.selectInfo.price;this.selectInfo.vip_price&&(s=this.selectInfo.vip_price),this.priceDom.html('<i class="price-currency">￥</i>\n<span class="price-integer">'+parseInt(s)+'</span>\n<span class="price-decimal">'+s.substring(s.indexOf("."),s.indexOf(".")+3)+"</span>")}else this.stock=this.model.get("stock"),this.stockDom.text(this.stock),this.inputDom.trigger("change"),this.priceDom.html('<i class="price-currency">￥</i>\n<span class="price-integer">'+this.model.get("price")+"</span>\n")}},skuEach:function(){var t=this;i(".cart-sku-control").children("li").each(function(){var e=i(this).index(),n=[],s=0;for(var a in t.selected)e!=a&&n.push(t.selected[a]);i(this).children(".cart-sku-items").children("label").each(function(){var e=[];e=i.copyObj(n),e.push(i(this).attr("data-str")),s=t.getStock(e),0>=s&&i(this).addClass("disabled")})})},getSkuInfo:function(){var t=this.model.get("products"),i={};for(var e in t){var n=t[e];if(this.checkStock(this.selected,n.props)){i={id:n.id,price:n.price,props_str:n.props_str,vip_price:n.vip_price};break}}return i},validityCollectFields:function(){var t=i.copyObj(this.model.get("collect_fields"));for(var e in t)"multipleText"!=t[e].type?t[e].value=i.trim(i("input[name='"+t[e].type+e+"']").val()):t[e].value=i.trim(i("textarea[name='"+t[e].type+e+"']").val());var n=i.validity(t);return n.status?t:(i.toast(n.error),!1)},addCart:function(){this.cartSubmit()},updateSku:function(){this.trigger("updateSku",this.selectInfo)},buy:function(){this.cartSubmit()},cartSubmit:function(){var t={type:this.type,ump_id:this.ump_id,price:this.price,original_price:this.original_price,goods_id:this.model.get("id"),quantity:parseInt(this.inputDom.val())};if(this.model.get("is_sku")){if(!this.selectInfo)return i.toast("请先选择规格尺寸"),!1;t.product_id=this.selectInfo.id}var e=this.model.get("collect_fields");if(e){var n=this.validityCollectFields();if(!n)return!1;t.fields=n}this.cartModel.set(t);var s=this;i.indicator(),this.undelegateEvents(),this.cartModel.save("","",{success:function(t,e,n){e.status?(s.closeModal(),s.type?window.location.href=_global.url.trade_url+"order/confirm?_="+_global.shop.id+"&order_id="+e.order_id+"&redirect_uri="+e.return_url:(0==_global.cart.count&&i(".js-go-cart").append("<em></em>"),_global.cart.count++,i.toast("添加成功，在购物车等亲～"))):(e.msg?i.toast(e.msg):i.toast(e.error),s.delegateEvents()),i.indicator("hide")}})},closeModal:function(){i.closeModal(".popup-sku"),this.undelegateEvents()}})}),define("text!apps/goods/templates/main.html",[],function(){return'<header class="bar top-bar">\n</header>\n\n<div class="view-container">\n    <div class="view-inner">\n        <section class="goods-main">\n            <div class="swiper-container goods-swiper">\n                <div class="swiper-wrapper ">\n                    {{~it.imgs:v:index}}\n                    <div class="swiper-slide">\n                        <img class="swiper-goods-list-img swiper-lazy" data-index="{{=index}}" data-src="{{=_global.url.ms}}{{=v.img}}?imageMogr2/thumbnail/640x/interlace/1">\n                    </div>\n                    {{~}}\n                </div>\n                {{?it.imgs.length>1}}\n                <div class="swiper-pagination"></div>\n                {{?}}\n            </div>\n\n            <div class="main-title" >\n                <h1>{{=it.title}}</h1>\n            </div>\n\n            <div class="main-price clearfix">\n                {{?it.onsale}}\n                {{? it.ump.alone.length != undefined}}\n                    <!-- 如果是营销活动[拼团,秒杀,砍价]就不显示 -->\n                    <div class="price-scope">\n                        <i class="price-currency">{{=_global.setting.currency_unit}}</i>\n                        {{?it.vip_price}}\n                        <span class="price-integer">{{=parseInt(it.vip_price)}}</span>\n                        <span class="price-decimal">{{=it.vip_price.substring(it.vip_price.indexOf("."), it.vip_price.indexOf(".") + 3)}}</span>\n                            {{?(it.is_sku)}}\n                            <label class="cl-gray" style="font-size: 1.2rem;">起</label>\n                            {{?}}\n                        {{??}}\n                            <span class="price-integer">{{=parseInt(it.price)}}</span>\n                            <span class="price-decimal">{{=it.price.substring(it.price.indexOf("."), it.price.indexOf(".") + 3)}}</span>\n                        {{?}}\n\n                        {{?it.credit_price}}\n                        <span class="price-credit">+</span>\n                        <span class="price-credit">{{=it.credit_price}}积分</span>\n                        {{?}}\n                    </div>\n                    {{?it.vip_price && it.price != \'0.00\'}}\n                    <del class="old-price">{{=_global.setting.currency_unit}}{{=it.price}}</del>\n                    {{?}}\n\n                    {{?it.original_price != \'0.00\'}}\n                    <del class="old-price"><i class="price-currency">{{?it.price_key}}{{=it.price_key}}{{??}}原价{{?}}</i>\n                        <span>{{=it.original_price}}</span>\n                    </del>\n                    {{?}}\n\n                {{?}}\n                <!--<button class="btn btn-sm btn-white pull-right">降价通知</button>-->\n                {{??}}\n                <div class="cl-gray" style="margin-bottom: 1rem;">\n                    商品已下架\n                </div>\n                {{?}}\n            </div>\n            {{? it.ump.alone.length != undefined}}\n                {{?it.vip_price}}\n                <div class="main-vip">\n                    <label class="label label-danger-o if if-user">会员折扣</label>\n                    <span class="cl-red">已打折</span>\n                </div>\n                {{?}}\n            {{?}}\n<!--\n            <div class="main-wexin-fans">\n                <label class="label label-danger-o if if-weixin">微信粉丝</label>\n                <span class="cl-red">已打5折</span>\n            </div>\n\n            <div class="main-miaosha">\n                <label class="label label-danger-o if if-miaosha">超级秒杀</label>\n                <span class="cl-red">已省8.99元</span>\n                <span class="countdown">剩余5天14时28分23秒</span>\n            </div>\n-->\n            <div class="js-ump"></div>\n            <div class="seckill"></div>\n            <div class="bangmian"></div>\n            \n            <div class="main-adds">\n                {{?it.is_virtual!=1}}\n                <span>运费：{{=it.postage}}</span>\n                {{?}}\n                <span class="js-is-csale">销量：{{=it.csale}}件</span>\n            </div>\n\n            {{?it.discount_info}}\n            {{~it.discount_info :discount_info}}\n            <div class="main-adds" style="border-top:1px solid #eee">\n                <div>\n                    <i style=\'background:red;color:white;font-style: normal;\'>促销</i>\n                    <span>{{=discount_info}}</span>\n                </div>\n\n            </div>\n            {{~}}\n            {{?}}\n\n\n            {{?(_global.setting.label_enabled == 1 && it.goods_label.length > 0)}}\n            <div class="shop-server">\n                {{~it.goods_label:val:ind }}\n                <span><i class="if if-dui"></i>{{=val.title}}</span>\n                {{~}}\n            </div>\n            {{?}}\n<!--\n            <div class="activity-list">\n                <label class="label label-danger-o">送积分</label>\n                <label class="label label-danger-o">满就减</label>\n            </div>\n-->\n        </section>\n        <div class="js-spellgroup">\n            \n        </div>\n        <div class="goods-component"></div>\n\n    </div>\n</div>\n\n<div class="bar bottom-bar"></div>\n{{?(_global.setting.label_enabled == 1 && it.goods_label.length > 0)}}\n<div class="popup popup-shopServer">\n    <div class="content-title"><h2>服务承诺</h2></div>\n    <div class="content-block">\n        {{~it.goods_label:val:ind }}\n        <div class="shopServer-list">\n            <p><img src="{{=_global.url.ms+val.logo}}"> {{=val.title}}</p>\n            <p>{{=val.content}}</p>\n        </div>\n        {{~}}\n    </div>\n    <div class="content-but">\n        <a href="#" class="close-popup">关闭</a>\n    </div>\n</div>\n{{?}}\n\n'}),define("apps/auction/models/time",["backbone"],function(t){return t.Model.extend({url:function(){return"/auction/status/"+this.id+".json?type="+this.get("type")}})}),define("text!apps/goods/templates/auction/auctionTpl.html",[],function(){return'{{?it.data.status==1||it.data.status==2}}\n<div class="view-auction-goods">\n	<div class="auction-main">\n	    <div class="goods-info">\n	    	<div class="goods-title clearfix">\n	    		<div class="remind">    		\n	    			<i class="if if-iconfont">&#xe69f;</i>	\n	    			<p>提醒</p>\n	    		</div>\n	    	</div>\n	        <p class="price">起拍价<span>￥{{=it.data.base_price}}</span></p>\n	        <p class="person"><span>{{=it.data.enroll_count}}报名</span>&nbsp;&nbsp;<span>{{=it.data.visit}}人围观</span></p>\n	    </div>\n	    <div class="auction-info clearfix">\n	        <ul>\n	            <li>\n	                <h3>{{=it.data.round}}</h3>\n	                <p>拍卖轮次</p>\n	            </li>\n	            <li>\n	                <h3>{{=it.data.round_time}}</h3>\n	                <p>每轮时间(分钟)</p>\n	            </li>\n	            <li>\n	                <h3>{{=it.data.delay_time}}</h3>\n	                <p>延时周期(分钟)</p>\n	            </li>\n	            <li>\n	                <h3>{{=it.data.increase}}</h3>\n	                <p>加价幅度(元)</p>\n	            </li>\n	            <li>\n	                <h3>{{=it.data.earnest}}</h3>\n	                <p>保证金(元)</p>\n	            </li>\n	            <li>\n	                <h3>\n	                	{{?it.data.reserve_price==0}}\n		                    无\n		                {{??}}\n		                    有\n		                {{?}}\n	                </h3>\n	                <p>保留价</p>\n	            </li>\n	        </ul>\n	    </div>\n	    <div class="auction-round">\n	        <p>拍卖轮次<a href=\'/auction/rounds/{{=it.data.id}}\'>全部<i class="if if-iconfont">&#xe67b;</i></a></p>\n	        <ul>	\n	        	{{~it.data.round_data: value:index}}\n		            <li class="clearfix">\n					    <div class="round">第<span>{{=value.round}}</span>轮</div>\n					    <div class="num">出价次数						    	\n				    		{{=value.bid_number}}\n					    </div>\n					   	{{?value.status==0}}\n					    	<div class="states">\n					    		<span class=\'onging\'>进行中</span>\n					    	</div>\n					    	<div class="victory">\n						    	{{?value.status==1}}\n						    		{{=value.mobile}}	\n						    	{{?}}\n						    </div>\n					    {{?}}					    \n					    {{?value.status==1}}\n					    	<div class="states">\n					    		<span class=\'beat\'>胜出</span>\n					    	</div>\n					    	<div class="victory">\n						    	{{?value.status==1}}\n						    		{{=value.mobile}}	\n						    	{{?}}\n						    </div>\n					    {{?}}			    \n					    {{?value.status==2}}\n					    	<div class="states_pass">\n					    		<span class=\'pass\'>\n					    			流拍\n					    			{{?value.bid_number==0}}\n					    				(无人出价)\n					    			{{??}}\n					    				(低于保留价)\n					    			{{?}}\n					    		</span>\n					    	</div>\n					    {{?}}\n				  	</li>\n	        	{{~}}\n	        </ul>\n	    </div>\n	    <div class="auction-attention">\n	        <ul>\n	            <li>\n	                <a href=\'/auction/notice\' class="clearfix">                   \n	                    <p>竞拍须知</p><i class="if if-iconfont">&#xe67b;</i>\n	                </a>   \n	            </li>\n	            <li>\n	                <a href=\'/auction\' class="clearfix">                   \n	                    <p>所有竞拍</p><i class="if if-iconfont">&#xe67b;</i>\n	                </a>  \n	            </li>\n	        </ul>\n	    </div>\n	</div>\n</div>\n{{?}}'}),define("apps/goods/views/auction/auction",["backbone","doT","apps/auction/models/time","text!apps/goods/templates/auction/auctionTpl.html"],function(t,i,e,n){return t.View.extend({template:i.template(n),initialize:function(t){return this.data=t,this.flag=!0,this.timeModel=new e,this},render:function(){this.$el.html(this.template(this.data));var i=this;if(1==this.data.data.status){var e=this.data.data.count_down;Number(e)>0&&(clearInterval(_global.FnCount),_global.FnCount=setInterval(function(){e-=1,0>e?(i.timeModel.set("id",i.data.data.id),i.timeModel.set("type","Start"),i.timeModel.fetch(),location.reload(),clearInterval(_global.FnCount)):$(".header-top").html(i.timer(e,i.data.data))},1e3),0==e&&(i.timeModel.set("id",i.data.data.id),i.timeModel.set("type","Start"),i.timeModel.fetch(),location.reload(),clearInterval(_global.FnCount)))}else if(2==this.data.data.status){var n="";n+='<span class="status ongoing">拍卖中</span><span class="status_title">',n+="第"+i.data.data.current_round+"轮拍卖正在进行中</span>",$(".header-top").html(n)}if(!_global.user){if($.device.weixin)return $.authRedirect(),!1;var s=decodeURIComponent(t.history.location.pathname.substring(1));return t.history.navigate("login?"+s,{trigger:!0,replace:!0}),!1}return $.device.weixin&&void 0!=_global.user.weixin_info?($.authRedirect(),!1):this},timer:function(t,i){var e=parseInt(t),n=0,s=0,a=0;e>60&&(n=parseInt(e/60),e=parseInt(e%60),n>60&&(s=parseInt(n/60),n=parseInt(n%60),s>24&&(a=parseInt(s/24),s=parseInt(s%24)))),10>a&&(a="0"+a),10>s&&(s="0"+s),10>n&&(n="0"+n),10>e&&(e="0"+e);var o="";return o+='<span class="status Preview">预展中</span><span class="status_title">',o+="第"+i.current_round+"轮拍卖",a>0&&(o+="<i>"+parseInt(a)+"</i>天"),s>0&&(o+="<i>"+parseInt(s)+"</i>时"),n>0&&(o+="<i>"+parseInt(n)+"</i>分"),o+="<i>"+parseInt(e)+"</i>秒",o+="&nbsp;后开始</span>"}})}),define("text!apps/goods/templates/auction/auction_footer_tpl.html",[],function(){return'<div class="goods-actions auction-goods">\n    <div class="cell btns-cell">     	\n    	{{?it.data.status==1}}    		\n	    	{{?it.data.my_enroll.status==0}}\n	    		<button class="btn-sm btn-buy pay_earnest f-width100 js-gopay" data-pid=\'{{=it.data.id}}\'>报名（支付保证金￥{{=it.data.earnest}}）</button> \n	    	{{?}}\n	    	{{?it.data.my_enroll.status==1}}\n	    		<button class="btn-sm btn-buy f-width100 js-gopay">预展中</button> \n	    	{{?}}\n    	{{?}}\n    	{{?it.data.status==2}}\n			{{?it.data.my_enroll.status==0}}			\n	    		<button class="btn-sm btn-buy pay_earnest f-width100 js-gopay" data-pid=\'{{=it.data.id}}\'>报名（支付保证金￥{{=it.data.earnest}}）</button> \n	    	{{?}}\n	    	{{?it.data.my_enroll.status==1}}\n		    	{{?it.data.my_enroll.order_to_pay==true}}\n		    		<a href="/auction/myauction?status=tosend">\n			    		<button class="btn-sm btn-buy f-width100 js-gopay">去支付</button> \n			    	</a>\n		    	{{?}}\n		    	{{?it.data.my_enroll.order_to_pay==false}}\n			    	<a href="/auction/bid_hall/{{=it.data.id}}">\n			    		<button class="btn-sm btn-buy f-width100 js-gopay">出价大厅</button> \n			    	</a>\n		    	{{?}}\n		    	{{?(typeof it.data.my_enroll.order_to_pay == \'undefined\')}}\n			    	<a href="/auction/bid_hall/{{=it.data.id}}">\n			    		<button class="btn-sm btn-buy f-width100 js-gopay">出价大厅</button> \n			    	</a>\n		    	{{?}}\n	    	{{?}}\n	    	{{?it.data.my_enroll.status==2}}			\n	    		<button class="btn-sm Already-breach f-width100">已违约</button> \n	    	{{?}}\n    	{{?}}\n    	\n    </div>\n</div>'}),define("components/phone/models/verify",["backbone"],function(t){return t.Model.extend({url:function(){return"/verify_member.json"}})}),define("components/phone/models/edit",["backbone"],function(t){return t.Model.extend({url:function(){return"/edit_mobile.json"}})}),define("components/phone/models/register",["backbone"],function(t){return t.Model.extend({url:function(){return"/register_mobile.json"}})}),define("text!components/phone/templates/edit.html",[],function(){return'<form class="form-horizontal" role="form" onsubmit="return false;">\n    {{?it.step == 1}}\n        <div class="form-group">\n            {{?_global.user.mobile_prefix != \'+86\'}}\n            <label>{{=_global.user.mobile_prefix}}</label>\n            {{??}}\n            <label>手机号码</label>\n            {{?}}\n            <input type="tel" name="phone" disabled class="form-item" placeholder="请输入手机号" value="{{=_global.user.mobile || \'\'}}" />\n        </div>\n\n        {{?it.type == \'password\'}}\n        <div class="form-group">\n            <label>登陆密码</label>\n            <input type="password" name="password" class="form-item" placeholder="请输入登陆密码" value="" />\n        </div>\n        {{?}}\n\n        {{?it.type == \'sms_str\'}}\n        <div class="form-group form-group-r">\n            <label>验证码</label>\n            <input type="text" name="sms_str" class="form-item" placeholder="请填写验证码">\n            <button type="button" class="btn-sm btn-white js-sms-code" smstype="2">获取验证码</button>\n        </div>\n        {{?}}\n\n        <div class="form-group">\n            <div class="form-item t_right">\n                <a class="item-text js-change-verify-type" type="{{?(it.type == \'password\')}}sms_str{{??}}password{{?}}">{{=it.typeText}}</a>\n            </div>\n        </div>\n\n        <div class="popup-options">\n            <button type="button" class="btn btn-block btn-success phone-step-btn" step="2">下一步</button>\n        </div>\n    {{?}}\n\n    {{?it.step == 2}}\n        <div class="form-group">\n            {{?_global.setting.is_foreign}}\n            <div class="cell-hd">\n                <select class="prefix-select" name="prefix">\n                    {{~_global.setting.prefix:value:index}}\n                    <option value="{{=value.code}}">{{=value.code}}</option>\n                    {{~}}\n                </select>\n            </div>\n            {{??}}\n            <label>手机号码</label>\n            {{?}}\n            <input type="tel" name="phone-new" class="form-item" placeholder="请输入新手机号" value="" />\n        </div>\n\n        <div class="form-group form-group-r">\n            <label>验证码</label>\n            <input type="text" name="sms_str" class="form-item" placeholder="请填写验证码">\n            <button type="button" class="btn-sm btn-white js-sms-code" smstype="0">获取验证码</button>\n        </div>\n\n        <div class="popup-options">\n            <button type="button" class="btn btn-block btn-success phone-save-btn" save="edit">保存</button>\n        </div>\n    {{?}}\n\n    {{?it.step == 3}}\n        <div class="form-group">\n            {{?_global.setting.is_foreign}}\n            <div class="cell-hd">\n                <select class="prefix-select" name="prefix">\n                    {{~_global.setting.prefix:value:index}}\n                    <option value="{{=value.code}}">{{=value.code}}</option>\n                    {{~}}\n                </select>\n            </div>\n            {{??}}\n            <label>手机号码</label>\n            {{?}}\n            <input type="tel" name="phone-new" class="form-item" placeholder="请输入手机号" value="" />\n        </div>\n\n        <div class="form-group form-group-r">\n            <label>验证码</label>\n            <input type="text" name="sms_str" class="form-item" placeholder="请填写验证码">\n            <button type="button" class="btn-sm btn-white js-sms-code" smstype="0">获取验证码</button>\n        </div>\n\n        <div class="form-group">\n            <label>设置密码</label>\n            <input type="password" name="password" class="form-item" placeholder="请输入登陆密码" value="" />\n        </div>\n\n        <div class="popup-options">\n            <button type="button" class="btn btn-block btn-success phone-save-btn" save="bind">保存</button>\n        </div>\n    {{?}}\n</form>';
}),define("components/phone/views/edit",["backbone","doT","components/phone/models/verify","components/phone/models/edit","components/phone/models/register","components/account/models/sms","text!components/phone/templates/edit.html"],function(t,i,e,n,s,a,o){var l=$("body");return t.View.extend({el:"body",template:i.template(o),events:{"click .phone-save-btn":"save","click .phone-bind-btn":"bindSave","click .js-change-verify-type":"changeVerifyType","click .phone-step-btn":"editPhoneStep","click .js-sms-code":"sendSmsCode","click .close-popup":"closeModal","click .popup-overlay.visible":"closeModal"},initialize:function(){this.verifyType="password",this.countdown=60,this.template=i.template(o),this.smsModel=new a,this.editModel=new n,this.registerModel=new s,this.verifyModel=new e},edit:function(){var t={step:1,type:this.verifyType,typeText:"切换短信验证"};l.append('<div class="popup popup-edit-phone remove-on-close"><h4 class="popup-title">更改手机</h4><div class="close-popup if if-close" data-popup=".popup-edit-phone"></div><div class="edit-form">'+this.template(t)+"</div></div>"),$.popup(".popup-edit-phone")},bind:function(){var t={step:3};l.append('<div class="popup popup-edit-phone remove-on-close"><h4 class="popup-title">绑定手机</h4><div class="close-popup if if-close" data-popup=".popup-edit-phone"></div><div class="edit-form">'+this.template(t)+"</div></div>"),$.popup(".popup-edit-phone")},complete:function(){var t={step:3};l.append('<div class="popup popup-edit-phone remove-on-close"><h4 class="popup-title">完善手机号</h4><div data-popup=".popup-edit-phone"></div><div class="edit-form">'+this.template(t)+"</div></div>"),$.popup(".popup-edit-phone")},changeVerifyType:function(t){var i=$(t.currentTarget).attr("type");this.verifyTypeCut(i)},verifyTypeCut:function(t){this.verifyType=t;var i={step:1,type:t,typeText:"password"==t?"切换短信验证":"切换密码验证"};$(".edit-form",this.$el).html(this.template(i))},editPhoneStep:function(t){var i=$(t.currentTarget).attr("step"),e=this,n={step:i};switch(i){case"2":var s="password"==this.verifyType?0:1;if(this.verifyModel.set("verify_type",s),s){var a=$.trim($('input[name="sms_str"]',this.$el).val());if(!Utils.validPostalCode(a))return $.toast("请输入正确验证码"),!1;this.verifyModel.set("sms_str",a)}else{var o=$('input[name="password"]',this.$el).val();if(!o)return $.toast("请先输入密码"),!1;this.verifyModel.set("password",o)}this.verifyModel.save("","",{success:function(t,i,s){i.success?$(".edit-form",e.$el).html(e.template(n)):$.toast(i.error)}})}},sendSmsCode:function(t){var i,e=$(t.currentTarget).attr("smstype"),n=_global.user.mobile_prefix;switch(this.smsModel.clear(),e){case"0":if(i=$.trim($('input[name="phone-new"]',this.$el).val()),i==_global.user.mobile)return $.toast("请使用其他手机"),!1;_global.setting.is_foreign&&this.smsModel.set({mobile_prefix:$('select[name="prefix"]').val()});break;case"2":i=_global.user.mobile,"+86"!=n&&this.smsModel.set({mobile_prefix:n})}return Utils.validNumber(i)?(this.smsModel.set({type:e,mobile:i}),void $.openImgPostalCode(t,this.smsModel.toJSON())):($.toast("请输入正确手机号"),!1)},save:function(t){var i={mobile:$.trim($('input[name="phone-new"]',this.$el).val()),sms_str:$('input[name="sms_str"]',this.$el).val()},e=this,n=$(t.currentTarget).attr("save");if(!Utils.validNumber(i.mobile))return $.toast("请输入正确手机号"),!1;if(!Utils.validPostalCode(i.sms_str))return $.toast("请输入正确验证码"),!1;switch(_global.setting.is_foreign&&(i.prefix=$('select[name="prefix"]',this.$el).val()),n){case"edit":if(i.mobile==_global.user.mobile)return $.toast("请使用其他手机"),!1;this.editModel.set(i).save("","",{success:function(t,n,s){n.success?(_global.user.mobile=i.mobile,e.trigger("successEdit"),e.closeModal()):$.toast(n.error)},error:function(t,i,e){$.toast(i.responseJSON.error.message)}});break;case"bind":if(i.password=$('input[name="password"]',this.$el).val(),!i.password)return $.toast("请设置密码"),!1;this.registerModel.set(i).save("","",{success:function(t,n,s){n.success?(_global.user.mobile=i.mobile,e.trigger("successEdit"),e.closeModal()):$.toast(n.error)},error:function(t,i,e){$.toast(i.responseJSON.error.message)}})}},closeModal:function(){$.closeModal(".popup-edit-phone"),this.undelegateEvents()}})}),define("components/phone/view",["backbone","doT","components/phone/views/edit"],function(t,i,e){return t.View.extend({initialize:function(){},edit:function(){var t=new e,i=this;return _global.user.is_verify_mobile?t.edit():t.bind(),t.on("successEdit",function(){i.trigger("success")}),this},bind:function(){var t=new e,i=this;return t.bind(),t.on("successEdit",function(){i.trigger("success")}),this},complete:function(){var t=new e,i=this;return t.complete(),t.on("successEdit",function(){i.trigger("success")}),this}})}),define("apps/goods/views/auction/auction_footer_view",["backbone","doT","components/user/view","text!apps/goods/templates/auction/auction_footer_tpl.html","components/phone/view"],function(t,i,e,n,s){return t.View.extend({className:"bar bottom-bar",template:i.template(n),events:{"click .pay_earnest":"earnest"},initialize:function(t){return this.data=t,this},render:function(){return this.$el.html(this.template(this.data)),this},earnest:function(t){var i=$(t.target).data("pid");if(void 0==_global.user.mobile||""==_global.user.mobile){var e=new s;return e.bind(),e.on("success",function(){window.location.href=""+_global.url.trade_url+"order/auction_enroll?_="+_global.shop.id+"&auction_id="+i}),$.loading("hide"),!1}window.location.href=""+_global.url.trade_url+"order/auction_enroll?_="+_global.shop.id+"&auction_id="+i}})}),define("text!apps/goods/templates/act_bar.html",[],function(){return'<div class="goods-actions seckill-actions">\n    <a href="/" class="cell"><i class="if if-store"></i><div>进店</div></a>\n    {{?it.onsale}}\n    {{?it.is_virtual}}\n    <div class="btns cell">\n        <button class="btn-sm btn-group js-open-cart" cart-gid="{{=it.id}}" cart-type="5" page-detail="pageDetail">立即购买</button>\n        \n    </div>\n    {{??}}\n    <div class="cell btns-cell">\n        <button class="btn-sm btn-cart js-open-cart" cart-gid="{{=it.id}}" cart-type="4">加入购物车</button>\n        <button class="btn-sm btn-buy js-open-cart" cart-gid="{{=it.id}}" cart-type="5">立即购买</button>\n    </div>\n    {{?}}\n    {{??}}\n    {{?it.is_virtual}}\n    <div class="btns cell">\n        <button style="width: 94%; margin-top: .6rem; line-height: 2.8rem; color: #fff;" class="btn-sm" disabled>立即购买</button>\n    </div>\n    {{??}}\n    <div class="cell btns-cell">\n        <button class="btn-sm" disabled>加入购物车</button>\n        <button class="btn-sm" disabled>立即购买</button>\n    </div>\n    {{?}}\n    {{?}} \n    \n    <!--<a href="" class="cell"><i class="if if-cart"></i>购物车</a>-->\n</div>  \n\n'}),define("text!apps/goods/templates/goods_info.html",[],function(){return'<section class="goods-taber">\n    <div class="tab-nav">\n        <a class="active js-tab" data-type="goods-info" href="javascript:;">商品详情</a>\n        <a class="js-tab" data-type="goods-prop" href="javascript:;">商品参数</a>\n        {{?_global.comment_open}}\n        <a class="js-tab" data-type="cmt-list" href="javascript:;">用户评价</a>\n        {{?}}\n        <!--<a class="js-tab" data-type="record-list" href="javascript:;">成交记录</a>-->\n    </div>\n    <div class="tab-content js-goods-tab-content">\n        <div class="tab active" id="goods-info">\n            <div class="goods-desc">\n                {{=it}}\n            </div>\n        </div>\n    </div>\n</section>'}),define("text!apps/goods/templates/pintuan/pintuanTpl.html",[],function(){return'<div class="spellgroup-top">\n    <div class="spellgroup-title">\n        <font>团</font>{{=it.data.title}}\n    </div>\n    {{?it.data.is_pintuan==1&&it.data.is_presale==1}}\n    <div class="spellgroup-time">距离开始：<font></font>时<font></font>分<font></font>秒</div>\n    {{?}}\n    {{?it.data.is_pintuan==1&&it.data.is_presale==0}}\n    <div class="spellgroup-in-num">共<font>{{=it.data.cactor}}人</font>参团</div>\n    {{?}}\n</div>\n<div class="spellgroup-kuyuan">\n    <div class="max_price">原价：<font>￥{{=it.max_price}}</font></div>\n    <div class="kucun">库存：<font>{{=it.data.stock-it.data.csale}}</font></div>\n</div>\n<!-- {{?it.data.member_is_pintuan!=\'\'}}\n\n<div class="invitation-frame">\n    <div class="frame">\n        <font>￥</font>\n        <span>{{=it.data.member_is_pintuan.pintuan_price}}</span>\n        <a class="tuan">{{=it.data.member_is_pintuan.cpeoples}}人团</a>\n        {{?!it.data.member_is_pintuan.status==0}}\n        <a href="/ingroup/{{=it.data.member_is_pintuan.id}}" class="invitation-btn">邀请好友拼团</a>\n        {{?}}\n        {{?it.data.member_is_pintuan.status==0}}\n            {{?it.data.member_is_pintuan.order_status==19}}\n            <a href="{{=_global.url.trade_url}}order/confirm?_={{=_global.shop.id}}&order_id={{=it.data.member_is_pintuan.order_id}}&redirect_uri={{=_global.url.shop_url}}ingroup/{{=it.data.member_is_pintuan.id}}" class="invitation-btn">已开团去支付</a>\n            {{?}}\n            {{?it.data.member_is_pintuan.order_status==20}}\n            <a href="{{=_global.url.trade_url}}order/{{=it.data.member_is_pintuan.order_id}}?_={{=_global.shop.id}}&redirect_uri={{=_global.url.shop_url}}ingroup/{{=it.data.member_is_pintuan.id}}" class="invitation-btn">已开团去支付</a>\n            {{?}}\n        {{?}}\n        <div class="triangle"></div>\n    </div>\n</div>\n{{?}} -->\n\n<div class="spellgroup-list">\n    {{~it.data.pintuan_item:v:index}}\n    <div class="spellgroup-li">\n        <div class="spellgroup-num">{{=v.cpeoples}}人团</div>\n        <div class="spellgroup-price {{?it.data.is_pintuan==1&&it.data.is_presale==0}} dq{{?}}">￥{{=v.price}}</div>\n        \n        \n        {{?it.data.is_presale==1}}\n        <!-- 是 -->\n            <!-- 吧所有的灰0 -->\n            <a class="btn-sm dq" data-gid="{{=it.data.id}}" data-pid="{{=v.id}}" data-type="2" data-originalprice="{{=it.data.price}}" data-price="{{=v.price}}" data-umpid="{{=v.id}}" >去开团</a>\n        {{??}}\n        <!-- 否 -->\n\n            <!-- 根据这个开团是否可以显示 -->\n            {{?v.is_pintuan==0}}\n                <a class="btn-sm dq" data-gid="{{=it.data.id}}" data-pid="{{=v.id}}" data-type="2" data-originalprice="{{=it.data.price}}" data-price="{{=v.price}}" data-umpid="{{=v.id}}" >去开团</a>\n            {{??}}\n                <a class="btn-sm btn-buy js-kt " data-gid="{{=it.data.id}}" data-pid="{{=v.id}}" data-type="2" data-originalprice="{{=it.data.price}}" data-price="{{=v.price}}" data-umpid="{{=v.id}}" >去开团</a>\n            {{?}}\n        {{?}}\n        {{?v.pintuan_create>0 && it.data.btn_ct_status==1}}\n        <a class="btn-sm btn-buy btn-ct" href="/ingroup/grouplist/{{=v.id}}" >去参团</a>\n        {{?}}\n    </div>\n    {{~}}\n</div>\n{{?it.data.is_presale!=1}}\n<div class="spellgroup-oneli">\n    <div class="spellgroup-num">1个人任性买</div>\n    <div class="spellgroup-price">￥{{=it.data.price}}</div>\n    <a class="btn-sm btn-cart {{?it.data.is_one_pintuan!=1}}dq{{??}} js-kt{{?}}" data-gid="{{=it.data.id}}" data-pid="0" data-type="1" data-originalprice="{{=it.data.price}}" data-price="{{=it.data.price}}"  data-umpid="{{=it.data.id}}">去购买</a>\n</div>\n{{?}}\n{{?it.data.member_is_pintuan!=\'\'}}\n<div class="pintuanlist">\n    <div class="pintuanlist-top">\n        <span>本活动已参加</span>\n        <a href="/ingroup/list">我的拼团<i class="if if-chevron-right"></i></a>\n    </div>\n    <ul>\n        {{~it.data.member_is_pintuan:v:index}}\n        <li>\n            <div class="imgname">\n                <div class="img">\n                    <img src="{{=v.tz_member_avatar || \'/image/default_head_img.jpg\'}}?imageMogr2/thumbnail/100x100!">\n                    <span>团</span>\n                </div>\n            </div>\n            <div class="katuanzt">\n                <div class="order_name {{?v.initiate_status!=1}} ptz {{?}}">\n                    <font>{{=v.tz_member_name || \'佚名\'}}</font>\n                </div>\n                <div class="order_zt">\n                    <font>{{=v.cpeoples}}人团</font>\n                    \n                    {{?v.initiate_status==0}}\n                    <div class="zt">开团待支付</div>\n                    {{?}}\n                    {{?v.initiate_status==1}}\n                    <div class="zt">拼团中</div>\n                    <div class="cavailable">还差<div class="proples">{{=v.cavailable_proples}}</div>人</div>\n                    {{?}}\n                    {{?v.initiate_status==2}}\n                    <div class="zt cg">拼团成功</div>\n                    {{?}}\n                    {{?v.initiate_status==3}}\n                    <div class="zt fail">拼团失败</div>\n                    {{?}}\n                </div>\n                <div class="order_zt">\n                    <div class="time_zt" id="time{{=v.id}}"></div>\n                </div>\n            </div>\n            {{?v.initiate_status==0}}\n                {{?v.status==0&&v.order_status==19}}\n                <a href="{{=_global.url.trade_url}}order/confirm?_={{=_global.shop.id}}&order_id={{=v.order_id}}&redirect_uri={{=_global.url.shop_url}}ingroup/{{=v.pintuan_initiate_id}}" class="btn-sm btn-buy">去支付</a>\n                {{?}}\n                {{?v.status==0&&v.order_status==20}}\n                <a href="{{=_global.url.trade_url}}order/{{=v.order_id}}?_={{=_global.shop.id}}&redirect_uri={{=_global.url.shop_url}}ingroup/{{=v.pintuan_initiate_id}}" class="btn-sm btn-buy">去支付</a>\n                {{?}}\n            {{?}}\n            {{?v.initiate_status==1}}\n                {{?v.status==0&&v.order_status==19}}\n                <a href="{{=_global.url.trade_url}}order/confirm?_={{=_global.shop.id}}&order_id={{=v.order_id}}&redirect_uri={{=_global.url.shop_url}}ingroup/{{=v.pintuan_initiate_id}}" class="btn-sm btn-buy">去支付</a>\n                {{?}}\n                {{?v.status==0&&v.order_status==20}}\n                <a href="{{=_global.url.trade_url}}order/{{=v.order_id}}?_={{=_global.shop.id}}&redirect_uri={{=_global.url.shop_url}}ingroup/{{=v.pintuan_initiate_id}}" class="btn-sm btn-buy">去支付</a>\n                {{?}}\n                {{?v.status==1}}\n                <a href="/ingroup/{{=v.pintuan_initiate_id}}" class="btn-sm btn-buy">邀请好友</a>\n                {{?}}\n                {{?v.status==3}}\n                <a href="/ingroup/{{=v.pintuan_initiate_id}}" class="btn-sm btn-buy">查看详情</a>\n                {{?}}\n            {{?}}\n            {{?v.initiate_status==2}}\n            <a href="/ingroup/{{=v.pintuan_initiate_id}}" class="btn-sm btn-buy">查看详情</a>\n            {{?}}\n            {{?v.initiate_status==3}}\n            <a href="/ingroup/{{=v.pintuan_initiate_id}}" class="btn-sm btn-buy">查看详情</a>\n            {{?}}\n\n            \n            \n        </li>\n        {{~}}\n        <!-- <li>\n            <div class="imgname">\n                <div class="img">\n                    <img src="/image/default_head_img.jpg">\n                    <span>团</span>\n                </div>\n            </div>\n            <div class="katuanzt">\n                <div class="order_zt">\n                    <font>程小青</font>\n                    <div class="zt">开团待支付</div>\n                </div>\n                <div class="order_zt">\n                    <font>10人团</font>\n                    <div class="time_zt"><font>1</font>天<font>1</font>时<font>1</font>分<font>1</font>秒</div>\n                </div>\n            </div>\n            <a class="btn-sm btn-buy">去支付</a>\n        </li>\n        <li>\n            <div class="imgname">\n                <div class="img">\n                    <img src="/image/default_head_img.jpg">\n                    <span>团</span>\n                </div>\n            </div>\n            <div class="katuanzt">\n                <div class="order_zt">\n                    <font>程小青</font>\n                    <div class="zt">拼团中</div>\n                </div>\n                <div class="order_zt">\n                    <font>10人团</font>\n                    <div class="time_zt"><font>1</font>天<font>1</font>时<font>1</font>分<font>1</font>秒</div>\n                </div>\n            </div>\n            <a class="btn-sm btn-buy dq">邀请好友</a>\n        </li>\n        <li>\n            <div class="imgname">\n                <div class="img">\n                    <img src="/image/default_head_img.jpg">\n                    <span>团</span>\n                </div>\n            </div>\n            <div class="katuanzt">\n                <div class="order_zt cg">\n                    <font>程小青</font>\n                    <div class="zt">拼团成功</div>\n                </div>\n                <div class="order_zt">\n                    <font>10人团</font>\n                </div>\n            </div>\n            <a class="btn-sm btn-buy dq">查看详情</a>\n        </li>\n        <li>\n            <div class="imgname">\n                <div class="img">\n                    <img src="/image/default_head_img.jpg">\n                    <span>团</span>\n                </div>\n            </div>\n        \n            <div class="katuanzt">\n                <div class="order_zt fail">\n                    <font>程小青</font>\n                    <div class="zt">拼团失败</div>\n                </div>\n                <div class="order_zt">\n                    <font>10人团</font>\n                </div>\n            </div>\n            <a class="btn-sm btn-buy dq">查看详情</a>\n        </li> -->\n    </ul>\n</div>\n{{?}}\n<div class="introduction">\n    <div class="introduction-top">\n        <span>玩法介绍</span>\n        <a href="/ingroup/rule">查看详情<i class="if if-chevron-right"></i></a>\n    </div>\n    <div class="step">\n        <div class="step-li"><font class="dq">1</font><span class="dq">选择<br/>心仪产品</span></div>\n        <div class="step-li"><font>2</font><span>支付开团</span></div>\n        <div class="step-li"><font>3</font><span>等待好友<br/>参团</span></div>\n        <div class="step-li"><font>4</font><span>达到人数<br/>团购成功</span></div>\n    </div>\n</div>\n'}),define("text!components/footer/tpl.html",[],function(){return'<div class="foot-links" id=\'bottomNav\'>\n{{?_global.shop_bottom_nav[0].link_status==1}}\n    <a href="{{=_global.url.shop_url}}">店铺主页</a>\n{{?}}\n\n{{?_global.shop_bottom_nav[1].link_status==1}}\n    <a href="{{=_global.url.shop_url}}user">会员中心</a>\n{{?}}\n\n{{?_global.shop_bottom_nav[2].link_status==1}}\n    {{?_global.guider.status==0}}\n    <a href="{{=_global.url.shop_url}}guide">我的小店</a></li>\n    <a href="{{=_global.url.shop_url}}guider">{{=_global.guider_alias}}中心</a></li>\n    {{?}}\n    {{?_global.guider.status==1 || !_global.guider.id}}\n    <a href="/guider/apply">{{=_global.guider_alias}}申请</a>\n    {{?}}\n{{?}}\n\n{{~_global.shop_bottom_nav:value:index}}\n	{{?index > 3}}\n        {{?value.link_status == 1}}\n		<a href="{{=value.link_url||\'javascript:void(0)\'}}">{{=value.name}}</a>\n        {{?}}\n	{{?}}\n{{~}}\n</div>'}),define("components/footer/view",["backbone","doT","text!components/footer/tpl.html"],function(t,i,e){return t.View.extend({className:"footer",template:i.template(e),events:{},initialize:function(){},render:function(){return this.$el.html(this.template()),this}})}),define("text!components/modules/slide/tpl.html",[],function(){return'{{var window_width=document.body.clientWidth,item_height=\'auto\';}}\n{{?it.style<4}}\n<div class="image-list style{{=it.style}}">\n    <ul class="clearfix">\n        {{?it.style > 1}}\n        {{for(var i = 0;i < it.style;i++){}}\n        <li>\n            {{for(var j = i;j< it.item_list.length;j = j + it.style){}}\n                {{?it.item_list[j]}}\n                <a {{?(j < it.item_list.length - 2)}}style="padding-bottom: 8px;" {{?}}href="{{=it.item_list[j].link_url||\'javacript:void(0)\'}}"><img class="lazy" data-original="{{=_global.url.ms+it.item_list[j].img}}?imageMogr2/thumbnail/640x"  alt="{{=it.item_list[j].title||\'\'}}">\n                    {{?it.item_list[j].title}}<p>{{=it.item_list[j].title}}</p>{{?}}\n                </a>\n                {{?}}\n            {{}}}\n        </li>\n        {{}}}\n        {{??}}\n        {{~it.item_list:value:index}}\n            <li>\n                <a href="{{=value.link_url||\'javacript:void(0)\'}}"><img class="lazy" data-original="{{=_global.url.ms+value.img}}?imageMogr2/thumbnail/640x"  alt="{{=value.title||\'\'}}">\n                    {{?value.title}}<p>{{=value.title}}</p>{{?}}\n                </a>\n            </li>\n        {{~}}\n        {{?}}\n    </ul>\n</div>\n{{?}}\n{{?it.style==4}}\n{{ var ad_w1=(window_width-24)/2;}}\n<div class="image-ad clearfix images-tpl">\n    <div>\n        {{?it.item_list[0]}}<a href="{{=it.item_list[0].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w1}}px;height:{{=(ad_w1+8)}}px;"><img class="lazy" data-original="{{=_global.url.ms+it.item_list[0].img}}?imageMogr2/thumbnail/640x"  alt="{{=it.item_list[0].title||\'\'}}"></a>{{?}}\n    </div>\n    <div>\n        {{?it.item_list[1]}}<a href="{{=it.item_list[1].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w1}}px;height:{{=(ad_w1/2)}}px;"><img class="lazy" data-original="{{=_global.url.ms+it.item_list[1].img}}?imageMogr2/thumbnail/640x"  alt="{{=it.item_list[1].title||\'\'}}"></a>{{?}}\n        {{?it.item_list[2]}}<a href="{{=it.item_list[2].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w1}}px;height:{{=(ad_w1/2)}}px;"><img class="lazy" data-original="{{=_global.url.ms+it.item_list[2].img}}?imageMogr2/thumbnail/640x"  alt="{{=it.item_list[2].title||\'\'}}"></a>{{?}}\n    </div>\n</div>\n{{?}}\n{{?it.style==5}}\n{{var ad_w2=(window_width-24)/3;}}\n<div class="image-ad2 clearfix images-tpl">\n    <div class="clearfix">\n        {{?it.item_list[0]}}<a href="{{=it.item_list[0].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w2}}px;height:{{=ad_w2}}px;"><img class="lazy" data-original="{{=_global.url.ms+it.item_list[0].img}}?imageMogr2/thumbnail/640x"  alt="{{=it.item_list[0].title||\'\'}}"></a>{{?}}\n        {{?it.item_list[1]}}<a href="{{=it.item_list[1].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w2*2}}px;height:{{=ad_w2}}px"><img class="lazy" data-original="{{=_global.url.ms+it.item_list[1].img}}?imageMogr2/thumbnail/640x"  alt="{{=it.item_list[1].title||\'\'}}"></a>{{?}}\n    </div>\n    <div class="clearfix">\n        {{?it.item_list[2]}}<a href="{{=it.item_list[2].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w2*2}}px;height:{{=ad_w2}}px"><img class="lazy" data-original="{{=_global.url.ms+it.item_list[2].img}}?imageMogr2/thumbnail/640x"  alt="{{=it.item_list[2].title||\'\'}}"></a>{{?}}\n        {{?it.item_list[3]}}<a href="{{=it.item_list[3].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w2}}px;height:{{=ad_w2}}px;"><img class="lazy" data-original="{{=_global.url.ms+it.item_list[3].img}}?imageMogr2/thumbnail/640x"  alt="{{=it.item_list[3].title||\'\'}}"></a>{{?}}\n    </div>\n</div>\n{{?}}\n{{?it.style==6}}\n{{var ad_w3=(window_width-24)/2;}}\n<div class="image-ad3 clearfix images-tpl">\n    <div>\n        {{?it.item_list[0]}}<a href="{{=it.item_list[0].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w3}}px;height:{{=(ad_w3/2)}}px;"><img class="lazy" data-original="{{=_global.url.ms+it.item_list[0].img}}?imageMogr2/thumbnail/640x"  alt="{{=it.item_list[0].title||\'\'}}"></a>{{?}}\n        {{?it.item_list[1]}}<a href="{{=it.item_list[1].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w3}}px;height:{{=ad_w3}}px;"><img class="lazy" data-original="{{=_global.url.ms+it.item_list[1].img}}?imageMogr2/thumbnail/640x"  alt="{{=it.item_list[1].title||\'\'}}"></a>{{?}}\n    </div>\n    <div>\n        {{?it.item_list[2]}}<a href="{{=it.item_list[2].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w3}}px;height:{{=ad_w3}}px;"><img class="lazy" data-original="{{=_global.url.ms+it.item_list[2].img}}?imageMogr2/thumbnail/640x"  alt="{{=it.item_list[2].title}}"></a>{{?}}\n        {{?it.item_list[3]}}<a href="{{=it.item_list[3].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w3}}px;height:{{=(ad_w3/2)}}px;"><img class="lazy" data-original="{{=_global.url.ms+it.item_list[3].img}}?imageMogr2/thumbnail/640x"  alt="{{=it.item_list[3].title}}"></a>{{?}}\n    </div>\n</div>\n{{?}}\n{{?it.style==7}}\n{{ var ad_w4=(window_width-32)/3;}}\n<div listorder="5" class="image-ad4 clearfix images-tpl">\n    <div>\n        {{?it.item_list[0]}}<a href="{{=it.item_list[0].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w4}}px;height:{{=ad_w4}}px;"><img class="lazy" data-original="{{=_global.url.ms+it.item_list[0].img}}?imageMogr2/thumbnail/640x"  alt="{{=it.item_list[0].title||\'\'}}"></a>{{?}}\n        {{?it.item_list[1]}}<a href="{{=it.item_list[1].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w4}}px;height:{{=ad_w4}}px;"><img class="lazy" data-original="{{=_global.url.ms+it.item_list[1].img}}?imageMogr2/thumbnail/640x"  alt="{{=it.item_list[1].title||\'\'}}"></a>{{?}}\n    </div>\n    <div>\n        {{?it.item_list[2]}}<a href="{{=it.item_list[2].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w4}}px;height:{{=ad_w4}}px;"><img class="lazy" data-original="{{=_global.url.ms+it.item_list[2].img}}?imageMogr2/thumbnail/640x"  alt="{{=it.item_list[2].title||\'\'}}"></a>{{?}}\n        {{?it.item_list[3]}}<a href="{{=it.item_list[3].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w4}}px;height:{{=ad_w4}}px;"><img class="lazy" data-original="{{=_global.url.ms+it.item_list[3].img}}?imageMogr2/thumbnail/640x"  alt="{{=it.item_list[3].title}}"></a>{{?}}\n    </div>\n    <div>\n        {{?it.item_list[4]}}<a href="{{=it.item_list[4].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w4}}px;height:{{=ad_w4*2+8}}px;"><img class="lazy" data-original="{{=_global.url.ms+it.item_list[4].img}}?imageMogr2/thumbnail/640x"  alt="{{=it.item_list[4].title||\'\'}}"></a>{{?}}\n    </div>\n</div>\n{{?}}\n{{?it.style==8}}\n<div class="swiper-container">\n    <div class="swiper-wrapper">\n        {{~it.item_list:value:index}}\n        <div class="swiper-slide">\n            <a href="{{=value.link_url||\'javacript:void(0)\'}}">\n            <img class="swiper-lazy" data-src="{{=_global.url.ms+value.img}}?imageMogr2/thumbnail/640x" >\n                </a>\n            {{?value.title}}<div class="title">{{=value.title}}</div>{{?}}\n        </div>\n        {{~}}\n    </div>\n    <div class="swiper-pagination"></div>\n</div>\n{{?}}'}),define("components/modules/slide/view",["backbone","doT","text!components/modules/slide/tpl.html","Swiper","lazyLoad"],function(t,i,e,n,s){return t.View.extend({template:i.template(e),initialize:function(){},render:function(){return this.model.item_list=$.changeLink(this.model.item_list),this.$el.html(this.template(this.model)),8==this.model.style&&this.$el.find(".swiper-container").swiper({loop:!0,pagination:$(".swiper-pagination",this.$el)[0],autoplay:3500,autoplayDisableOnInteraction:!1,preloadImages:!0,lazyLoading:!0}),$("img.lazy",this.$el).lazyload(),this}})}),define("text!components/modules/text/tpl.html",[],function(){return'<section class="mod-text">\n    {{=it}}\n</section>'}),define("components/modules/text/view",["backbone","doT","lazyLoad","text!components/modules/text/tpl.html"],function(t,i,e,n){return t.View.extend({template:i.template(n),initialize:function(){},render:function(){var t=this.model.text,i=new RegExp("src","g"),e="";return t&&(e=t.replace(i,'class="lazy" data-original')),this.$el.html(this.template(e)),$("img.lazy").lazyload(),this}})}),define("text!components/modules/banner/tpl.html",[],function(){return'{{?it.style==1 }}\n<section class="mod-shop-header1">\n    <div class="mod-shop-header1-bg" {{?(it.banner_img || typeof it.banner_img !="undefined" )}} style="background-image: url({{=_global.url.ms+it.banner_img}}?imageMogr2/thumbnail/640x215)" {{?}}>\n        <div class="mod-shop-header1-title">{{=_global.shop.name || \'店铺名称\'}}</div>\n        <div class="mod-shop-header1-logo">\n            <img src="{{=_global.url.ms+_global.shop.logo}}?imageMogr2/thumbnail/160x160!">\n        </div>\n    </div>\n    <ul class="mod-shop-header1-nav clearfix">\n        <li>\n            <a href="/list">\n                <i class="count">{{=it.all_goods ||\'0\'}}</i>\n                <span class="text">全部商品</span>\n            </a>\n        </li>\n        <li>\n            <a href="/new">\n                <i class="count">{{=it.new_goods ||\'0\'}}</i>\n                <span class="text">新上商品</span>\n            </a>\n        </li>\n        <li>\n            <a href="/user">\n                <i class="if if-user"></i>\n                <span class="text">会员中心</span>\n            </a>\n        </li>\n    </ul>\n</section>\n{{?}}\n{{?it.style==2 }}\n<section class="mod-shop-header2" {{?(it.banner_img || typeof it.banner_img !="undefined" )}} style="background-image: url({{=_global.url.ms+it.banner_img}}?imageMogr2/thumbnail/640x430)"{{?}}>\n    <div class="mod-shop-header2-title">{{=_global.shop.name || \'店铺名称\'}}</div>\n    <div class="mod-shop-header2-logo">\n        <img src="{{=_global.url.ms+_global.shop.logo}}?imageMogr2/thumbnail/160x160!">\n    </div>\n    <ul class="mod-shop-header2-nav clearfix">\n        <li class="active" style="border-bottom-color:{{=it.active_color}};">\n            <a href="/">\n                <i class="if if-store"></i>\n                <span class="text">首页</span>\n            </a>\n        </li>\n        <li>\n            <a href="/list">\n                <i class="if if-allgoods"></i>\n                <span class="text">全部商品</span>\n            </a>\n        </li>\n        <li>\n            <a href="/new">\n                <i class="if if-new"></i>\n                <span class="text">新上商品</span>\n            </a>\n        </li>\n        <li>\n            <a href="/user">\n                <i class="if if-user"></i>\n                <span class="text">个人中心</span>\n            </a>\n        </li>\n    </ul>\n</section>\n{{?}}'}),define("components/modules/banner/view",["backbone","doT","text!components/modules/banner/tpl.html"],function(t,i,e){return t.View.extend({template:i.template(e),initialize:function(){},render:function(){return this.$el.html(this.template(this.model)),this}})}),define("text!components/modules/goods/tpl.html",[],function(){return'{{?it.style==1}}\n<section class="mod-goods-com">\n    {{?it.title}}<div class="com-title">{{=it.title}}</div>{{?}}\n    {{?it.img}}<img src="{{=_global.url.ms+it.img}}">{{?}}\n    {{?it.desc}}<div class="com-desc">{{=it.desc}}</div>{{?}}\n    <div class="swiper-goods-container">\n        <div class="swiper-wrapper">\n            {{~it.goods :value:index}}\n            <div class="swiper-slide">\n                <a href="/goods/{{=value.id}}">\n                    <div class="goods-image"><img src="{{=_global.url.ms+value.img}}?imageMogr2/thumbnail/240x240!"></div>\n                    <div class="goods-info">\n                        <p class="goods-title">{{=value.title}}</p>\n                        <p class="goods-price">{{=_global.setting.currency_unit+value.price}}</p>\n                    </div>\n                </a>\n            </div>\n            {{~}}\n        </div>\n    </div>\n</section>\n{{??}}\n<section class="mod-goods-list">\n    <ul class="goods-list clearfix style-{{=it.size}}">\n        {{\n        var img_size;\n        if(it.size==\'big\')\n        {\n        img_size=\'640x640!\'\n\n    }else if(it.size==\'small\')\n    {\n    img_size=\'320x320!\'\n}else{\nimg_size=\'240x240!\'\n}\n}}\n{{~it.goods :value:index}}\n<li>\n    <a href="/goods/{{=value.id}}">\n        <div class="goods-image"><img class="lazy" data-original="{{=_global.url.ms+value.img}}?imageMogr2/thumbnail/{{=img_size}}"></div>\n        {{?it.show_title || it.show_price || it.show_cart || it.show_csale}}\n        <div class="goods-info">\n            {{?it.show_title}}<p class="goods-title">{{=value.title}}</p>{{?}}\n            {{?it.show_price}}<p class="goods-price">{{=_global.setting.currency_unit+value.price}}</p>{{?}}\n            {{?it.show_csale}}<p class="goods-sale">销量：{{=value.total_csale}}件</p>{{?}}\n            {{?it.show_cart}}<i class="goods-buy if if-cart-add js-open-cart" cart-gid="{{=value.id}}"></i>{{?}}\n        </div>\n        {{?}}\n    </a>\n</li>\n{{~}}\n</ul>\n</section>\n{{?}}';
}),define("components/modules/goods/view",["backbone","doT","lazyLoad","Swiper","text!components/modules/goods/tpl.html","components/cart/views/main"],function(t,i,e,n,s,a){return t.View.extend({template:i.template(s),events:{"click .js-open-cart":"openSku"},initialize:function(){},render:function(){return this.$el.html(this.template(this.model)),1==this.model.style&&$(".swiper-goods-container",this.$el).swiper({slidesPerView:"auto",paginationClickable:!0,spaceBetween:10}),$("img.lazy").lazyload(),this},openSku:function(t){var i=new a;i.open(t)}})}),define("text!components/modules/nav/tpl.html",[],function(){return"<section>\n    {{?it.style=='tag'}}\n    <ul class=\"mod-tag-nav clearfix\">\n        {{~$.changeLink(it.item_list):value:index}}\n        <li>\n            <a style=\"{{=value.bg_color ? 'background-color:'+value.bg_color+';': ''+it.icon_size ? 'line-height:'+it.icon_size+'px;':''}}\" class=\"clearfix\" href=\"{{=value.link_url || 'javascript:void(0)' }}\">\n                <img style=\"{{=it.icon_size ? 'width:'+it.icon_size+'px;height:'+it.icon_size+'px;' : ''}}\" src=\"{{=_global.url.ms+value.img}}?imageMogr2/thumbnail/160x160!\">\n                <span style=\"width: {{=it.nev_len}}px;{{=value.font_color ? 'color:'+value.font_color+';': ''}}\">{{=value.title || ''}}</span>\n            </a>\n        </li>\n        {{~}}\n    </ul>\n    {{?}}\n    {{?it.style=='nav'}}\n    <ul class=\"mod-nav {{=it.display_icon}}\">\n        {{~$.changeLink(it.item_list):value:index}}\n        <li style=\"{{=value.bg_color ? 'background-color:'+value.bg_color+';': ''}}\">\n            <a href=\"{{=value.link_url || 'javascript:void(0)' }}\">\n                {{?it.display_icon !='no-icon'}}\n                <i style=\"{{=it.icon_size ? 'width:'+it.icon_size+'px;height:'+it.icon_size+'px;' : ''}}\"><img src=\"{{=_global.url.ms+value.img}}?imageMogr2/thumbnail/160x160!\"></i>\n                {{?}}\n                <span style=\"width: {{=it.nev_len}}px;{{=value.font_color ? 'color:'+value.font_color+';': ''}}\">{{=value.title || ''}}</span>\n            </a>\n        </li>\n        {{~}}\n    </ul>\n    {{?}}\n</section>"}),define("components/modules/nav/view",["backbone","doT","text!components/modules/nav/tpl.html"],function(t,i,e){return t.View.extend({template:i.template(e),initialize:function(){},render:function(){var t=this.model.item_list.length;return this.model.nev_len=$(window).width()/t,this.$el.html(this.template(this.model)),this}})}),define("text!components/modules/search/tpl.html",[],function(){return'{{?it==null || it.style==1}}\n<section class="mod-search js-search">\n    <div class="search-inner">\n        <i class="if if-search"></i> 在店铺内搜索\n    </div>\n</section>\n\n{{??}}\n<section class="mod-search-top" style="background-color: {{=it.bg_color}}">\n    <div class="search-inner js-search" style="background-color: {{=it.active_color}}">\n        <i class="if if-search"></i> 在店铺内搜索\n    </div>\n    <a class="my-link js-open-user" data-panel="right" href="javascript:;"><i class="if if-user"></i></a>\n</section>\n{{?}}'}),define("components/modules/search/view",["backbone","doT","components/user/view","components/account/views/main","components/search/view","apps/super/list/collection/search","text!components/modules/search/tpl.html"],function(t,i,e,n,s,a,o){var l=$("#panel-user");return t.View.extend({template:i.template(o),events:{"click .js-search":"search","click .js-open-user":"open","click .js-search-shop":"searchShop","click .js-search-mall":"searchMall","click .js-clear":"clear"},initialize:function(){},render:function(){return this.$el.html(this.template(this.model)),this},search:function(){$("body").append((new s).render().$el)},open:function(){if(_global.user){if($.device.weixin&&void 0!=_global.user.weixin_info)return $.authRedirect(),!1;l.html((new e).$el)}else{if($.device.weixin)return $.authRedirect(),!1;var t=new n;$("body").append(t.render().$el),t.on("success",function(t){l.html((new e).$el)})}},searchShop:function(i){var i=$.trim($(".js-search-input",this.$el).val());if(""==i||null==i)return void $.toast("请输入关键字！");var e=decodeURIComponent($.getUrlParam("q"));"/list"==t.history.location.pathname&&""!=i&&i!=e&&this.trigger("search",i),t.history.navigate("list?q="+i,{trigger:!0})},searchMall:function(){var t=$.trim($(".js-search-input",this.$el).val());if(""==t||null==t)return void $.toast("请输入关键字！");var i="http://mall"+_global.mall_info.id+"."+_global.url.base_domain+"/super/search?title="+t;console.log(i),$.loading(""),this.collection=new a;this.collection.fetch({data:{keyword:t},success:function(t,e){$(window).unbind("scroll"),window.location.href=i}}),console.log(t)},clear:function(){$(".js-search-input",this.$el).val("")}})}),define("text!components/modules/notice/tpl.html",[],function(){return'<section class="mod-notice">\n    <i class="if if-notice"></i>\n    <!--  1 wuxin�޸� -->\n    <marquee scrollamount="4"><a href="{{=it.link_url || \'javascript:void(0)\' }}">{{=it.notice}}</a></marquee>\n    <!-- wuxin�޸� -->\n</section>'}),define("components/modules/notice/view",["backbone","doT","text!components/modules/notice/tpl.html"],function(t,i,e){return t.View.extend({template:i.template(e),initialize:function(){},render:function(){return this.$el.html(this.template(this.model)),this}})}),define("components/modules/goods_tag/collection",["backbone.paginator"],function(t){return Backbone.PageableCollection.extend({url:"/goods.json",state:{pagesInRange:0,pageSize:20},queryParams:{totalPages:null,totalRecords:null,pageSize:"limit",currentPage:null,offset:function(){return(this.state.currentPage-1)*this.state.pageSize}},parseState:function(t,i,e,n){return{totalRecords:t._count}},parseRecords:function(t,i){return t.data}})}),define("text!components/modules/goods_tag/item.html",[],function(){return'<a href="/goods/{{=it.id}}">\n    <div class="goods-image"></div>\n    {{?it.content.show_title || it.content.show_price || it.content.show_cart}}\n    <div class="goods-info">\n        {{?it.content.show_title}}<p class="goods-title">{{=it.title}}</p>{{?}}\n        {{?it.content.show_price}}\n        <p class="goods-price">{{=_global.setting.currency_unit+it.price}}\n            {{?it.original_price != \'0.00\'}}\n            <del><i>{{?it.price_key}}{{=it.price_key}}{{??}}原价{{?}}{{=it.original_price}}</i></del>\n            {{?}}\n        </p>\n        {{?}}\n        {{?it.content.show_csale}}<p class="goods-sale">销量：{{=it.total_csale}}件</p>{{?}}\n        {{?it.content.show_cart}}<i class="goods-buy if if-cart-add js-open-cart" cart-gid="{{=it.id}}"></i>{{?}}\n    </div>\n    {{?}}\n</a>'}),define("components/modules/goods_tag/itemView",["backbone","doT","text!components/modules/goods_tag/item.html","components/cart/views/main"],function(t,i,e,n){return t.View.extend({tagName:"li",className:"clearfix",template:i.template(e),events:{"click .js-open-cart":"openSku"},initialize:function(){},render:function(){var t,i=this.model.toJSON(),e=this;this.$el.html(this.template(i)),t="big"==i.content.size?"640x":"small"==i.content.size?"320x":"240x";var n=new Image,s=$(n);return s.addClass("lazy"),s.attr("data-original",_global.url.ms+i.img+"?imageMogr2/thumbnail/"+t),n.onload=function(){if("big"!=i.content.size){var t=n.width,e=n.height,a=(t-e)/2;t>e?s.attr("style","height: 100%;object-position: "+-a+"px 0;"):e>t&&s.attr("style","object-position: 0 "+a+"px;")}},$(".goods-image",e.$el).html(n),this},openSku:function(t){var i=new n;i.open(t)}})}),define("text!components/modules/goods_tag/tpl.html",[],function(){return'<section class="mod-goods-list">\n    {{?it.selected_tag.length==1}}\n    <div class="list-title clearfix">\n        <h2>{{=it.selected_tag[0].name}}</h2>\n        {{?it.selected_tag[0].id>0}}\n        <a href="/tag/{{=it.selected_tag[0].id}}">更多<i class="if if-chevron-right"></i></a>\n        {{??}}\n        <a href="/list">更多<i class="if if-chevron-right"></i></a>\n        {{?}}\n    </div>\n    {{?}}\n    {{?it.selected_tag.length>1}}\n    <div class="tab-nav goods-list-tab">\n        {{~it.selected_tag:value:index}}\n        <a class="js-tab-tag {{?index==0}}active{{?}}" data-id="{{=value.id}}" href="javascript:void(0);">{{=value.name}}</a>\n        {{~}}\n    </div>\n    {{?}}\n    <ul class="js-goods-list goods-list clearfix style-{{=it.size}}">\n\n    </ul>\n</section>'}),define("components/modules/goods_tag/view",["backbone","doT","lazyLoad","components/modules/goods_tag/collection","components/modules/goods_tag/itemView","text!components/modules/goods_tag/tpl.html"],function(t,i,e,n,s,a){return t.View.extend({template:i.template(a),events:{"click .js-tab-tag ":"setTab"},initialize:function(){this.collection=new n,this.collection.on("sync",this.renderEach,this)},render:function(){return"undefined"!=typeof this.model.selected_tag[0]&&(this.model.selected_tag[0].id&&(this.collection.queryParams.goods_tag_id=this.model.selected_tag[0].id),this.collection.queryParams.limit=this.model.number,this.collection.queryParams.column=this.model.sort,this.collection.fetch()),this.$el.html(this.template(this.model)),this},setTab:function(t){var i=$(t.currentTarget);$(i).hasClass("active")||($(i).addClass("active").siblings().removeClass("active"),i.data("id")&&(this.collection.queryParams.goods_tag_id=i.data("id")),this.collection.fetch())},renderEach:function(){$(".js-goods-list",this.$el).html(""),this.collection.each(this.renderItem,this),$("img.lazy").lazyload()},renderItem:function(t){t.set("content",this.model),$(".js-goods-list",this.$el).append(new s({model:t}).render().$el)}})}),define("text!components/modules/phone/tpl.html",[],function(){return'<section class="mod-tel">\n    <a href="tel:{{=it.phone||\'\'}}"><i class="if if-tel pull-left"></i>{{=it.name||\'客服电话\'}}：{{=it.phone||\'\'}}<i class="if if-chevron-right pull-right"></i></a>\n</section>'}),define("components/modules/phone/view",["backbone","doT","text!components/modules/phone/tpl.html"],function(t,i,e){return t.View.extend({template:i.template(e),initialize:function(){},render:function(){return this.$el.html(this.template(this.model)),this}})}),define("text!components/modules/video/tpl.html",[],function(){return'<section class="mod-video">\n    {{=it.code}}\n</section>'}),define("components/modules/video/view",["backbone","doT","text!components/modules/video/tpl.html"],function(t,i,e){return t.View.extend({template:i.template(e),initialize:function(){},render:function(){return this.$el.html(this.template(this.model)),this}})}),define("text!components/modules/image/tpl.html",[],function(){return'<section class="mod-image-list">\n    <div style="background-color: {{=it.bg_color}}">\n        <table style="width: {{=document.body.clientWidth-document.body.clientWidth%4}}px">\n            {{=it.html}}\n        </table>\n    </div>\n</section>'}),define("components/modules/image/view",["backbone","doT","text!components/modules/image/tpl.html"],function(t,i,e){return t.View.extend({template:i.template(e),initialize:function(){},render:function(){var t=this.model.tableContent,i=new RegExp("src","g"),e=new RegExp("<tr></tr>","g"),n="";return t&&(n=t.replace(i,'class="lazy" data-original')),($.device.ios||$.device.ipad||$.device.iphone||$.device.safari)&&(n=n.replace(e,"<tr><td></td><td></td><td></td><td></td></tr>")),this.model.html=n,this.$el.html(this.template(this.model)),$("img.lazy").lazyload(),this}})}),define("text!components/modules/white/tpl.html",[],function(){return'<div class="mod-white" style="height:{{=it.height}}px"></div>'}),define("components/modules/white/view",["backbone","doT","text!components/modules/white/tpl.html"],function(t,i,e){return t.View.extend({template:i.template(e),initialize:function(){},render:function(){return this.$el.html(this.template(this.model)),this}})}),define("text!components/modules/title/tpl.html",[],function(){return'<div class="mod-title">\n    <a class="title-link clearfix" href="{{=it.link_url ||\'javascript:;\'}}">\n        {{?it.icon}}<div class="title-img"><img src="{{=_global.url.ms+it.icon}}"></div>{{?}}\n        <div class="title-name">{{=it.title||\'标题名\'}}</div>\n        {{?it.more}}<span class="more-enter">{{=it.more||\'更多\'}} <span class="if if-chevron-right"></span></span>{{?}}\n    </a>\n</div>'}),define("components/modules/title/view",["backbone","doT","text!components/modules/title/tpl.html"],function(t,i,e){return t.View.extend({template:i.template(e),initialize:function(){},render:function(){var t=$.switchLink(this.model);return this.$el.html(this.template(t)),this}})}),define("text!components/modules/guider_nav/tpl.html",[],function(){return'<section class="mod-guider-nav">\n    <ul class="clearfix">\n        <li>\n            <a href="/guider/order">\n                <i class="if if-order"></i>\n                <p>推广订单</p>\n                <div><span>{{=it.guider_order_num}}</span>个</div>\n            </a>\n        </li>\n        <li>\n            <a href="/guider/team">\n                <i class="if if-team"></i>\n                <p>我的团队</p>\n                <div><span>{{=it.guider_team_num}}</span>个</div>\n            </a>\n        </li>\n        <!--<li>-->\n            <!--<a href="/guider/stat">-->\n                <!--<i class="if if-pie"></i>-->\n                <!--<p>推广统计</p>-->\n                <!--<div><span>1233</span>个</div>-->\n            <!--</a>-->\n        <!--</li>-->\n        {{?(_global.from!=\'rrdtk\')}}\n        <li>\n            <a href="/guider/spread">\n                <i class="if if-spread"></i>\n                <p>开始推广</p>\n                <div>推广方式和说明</div>\n            </a>\n        </li>\n        {{?}}\n        <li>\n            <a href="/guider/setting">\n                <i class="if if-setting"></i>\n                <p>店铺设置</p>\n                <div>修改店铺信息</div>\n            </a>\n        </li>\n        {{?it.hero_open==1}}\n        <li>\n            <a href="/guider/armory">\n                <i class="if if-ranking"></i>\n                <p>英雄榜</p>\n                <div>你上榜了吗</div>\n            </a>\n        </li>\n        {{?}}\n        {{~$.changeLink(it.item_list):value:index}}\n        <li>\n            <a href="{{=value.link_url || \'javascript:void(0)\' }}">\n                <i><img src="{{=_global.url.ms+value.img}}?imageMogr2/thumbnail/100x100!"></i>\n                <p>{{=value.title ||\'导航\'}}</p>\n                <div>{{=value.desc || \'副导航\'}}</div>\n            </a>\n        </li>\n        {{~}}\n    </ul>\n</section>'}),define("components/modules/guider_nav/view",["backbone","doT","text!components/modules/guider_nav/tpl.html"],function(t,i,e){return t.View.extend({template:i.template(e),initialize:function(){},render:function(){return this.$el.html(this.template(this.model)),this}})}),define("text!components/modules/guider_banner/tpl.html",[],function(){return'{{?it.style==1 || it.style==\'user\'}}\n<section class="mod-shop-header1">\n    <div class="mod-shop-header1-bg" {{?(it.banner_img || typeof it.banner_img !="undefined" )}} style="background-image: url({{=_global.url.ms+it.banner_img}}?imageMogr2/thumbnail/640x215)" {{?}}>\n        {{?it.guider_style == \'shop\'}}\n        <div class="mod-shop-header1-title">{{=_global.shop.name || \'店铺名称\'}}</div>\n        <div class="mod-shop-header1-logo"><img src="{{=_global.url.ms+_global.shop.logo}}?imageMogr2/thumbnail/160x160!"></div>\n        {{?}}\n        {{?it.guider_style == \'user\'}}\n        <div class="mod-shop-header1-title">{{=it.guide.title || \'\'}}</div>\n        <div class="mod-shop-header1-logo">\n            {{?(it.guide.logo.indexOf("http")!=-1)}}\n            <img src="{{=it.guide.logo || \'/image/default_head_img.jpg\'}}">\n            {{??}}\n            <img src="{{=_global.url.ms+it.guide.logo}}?imageMogr2/thumbnail/160x160!">\n            {{?}}\n        </div>\n        {{?}}\n        {{?!it.guider_style }}\n        <div class="mod-shop-header1-title">{{=it.guide.title || \'\'}}</div>\n        <div class="mod-shop-header1-logo">\n            {{?(it.guide.logo.indexOf("http")!=-1)}}\n            <img src="{{=it.guide.logo || \'/image/default_head_img.jpg\'}}">\n            {{??}}\n            <img src="{{=_global.url.ms+it.guide.logo}}?imageMogr2/thumbnail/160x160!">\n            {{?}}\n        </div>\n        {{?}}\n    </div>\n    <ul class="mod-shop-header1-nav clearfix">\n        <li>\n            <a href="/list">\n                <i class="count">{{=it.all_goods ||\'0\'}}</i>\n                <span class="text">全部商品</span>\n            </a>\n        </li>\n        <li>\n            <a href="/new">\n                <i class="count">{{=it.new_goods ||\'0\'}}</i>\n                <span class="text">新上商品</span>\n            </a>\n        </li>\n        <li>\n            <a href="/user">\n                <i class="if if-user"></i>\n                <span class="text">会员中心</span>\n            </a>\n        </li>\n    </ul>\n</section>\n{{?}}\n{{?it.style==2 || it.style==\'shop\'}}\n<section class="mod-shop-header2" {{?(it.banner_img || typeof it.banner_img !="undefined" )}} style="background-image: url({{=_global.url.ms+it.banner_img}}?imageMogr2/thumbnail/640x430)"{{?}}>\n    {{?it.guider_style == \'user\'}}\n    <div class="mod-shop-header2-logo">\n        {{?(it.guide.logo.indexOf("http")!=-1)}}\n        <img src="{{=it.guide.logo || \'/image/default_head_img.jpg\'}}">\n        {{??}}\n        <img src="{{=_global.url.ms+it.guide.logo}}?imageMogr2/thumbnail/160x160!">\n        {{?}}\n    </div>\n    <div class="mod-shop-header2-title">{{=it.guide.title || \'\'}}</div>\n    {{?}}\n    {{?it.guider_style == \'shop\'}}\n    <div class="mod-shop-header2-logo"><img src="{{=_global.url.ms+_global.shop.logo}}?imageMogr2/thumbnail/160x160!"></div>\n    <div class="mod-shop-header2-title">{{=_global.shop.name || \'店铺名称\'}}</div>\n    {{?}}\n    {{?!it.guider_style}}\n    <div class="mod-shop-header2-title">{{=it.guide.title || \'\'}}</div>\n    <div class="mod-shop-header2-logo">\n        {{?(it.guide.logo.indexOf("http")!=-1)}}\n        <img src="{{=it.guide.logo || \'/image/default_head_img.jpg\'}}">\n        {{??}}\n        <img src="{{=_global.url.ms+it.guide.logo}}?imageMogr2/thumbnail/160x160!">\n        {{?}}\n    </div>\n    {{?}}\n    <ul class="mod-shop-header2-nav clearfix">\n        <li class="active" style="border-bottom-color:{{=it.active_color}};">\n            <a href="/">\n                <i class="if if-store"></i>\n                <span class="text">首页</span>\n            </a>\n        </li>\n        <li>\n            <a href="/list">\n                <i class="if if-allgoods"></i>\n                <span class="text">全部商品</span>\n            </a>\n        </li>\n        <li>\n            <a href="/new">\n                <i class="if if-new"></i>\n                <span class="text">新上商品</span>\n            </a>\n        </li>\n        <li>\n            <a href="/user">\n                <i class="if if-user"></i>\n                <span class="text">个人中心</span>\n            </a>\n        </li>\n    </ul>\n</section>\n{{?}}'}),define("components/modules/guider_banner/view",["backbone","doT","text!components/modules/guider_banner/tpl.html"],function(t,i,e){return t.View.extend({template:i.template(e),initialize:function(){},render:function(){_global.from_guider?this.model.guide=_global.from_guider:this.model.guide=_global.guider;var t={title:_global.shop.name||"",desc:_global.shop.share_description,link:window.location.href,imgUrl:_global.shop.logo.indexOf("http")>-1?_global.shop.logo:_global.url.ms+_global.shop.logo},i=this.model.guide.title;return""==i&&(i=this.model.guide.title=this.model.guide.nickname+"的小店"),"user"==this.model.style||void 0!=this.model.guider_style&&"user"==this.model.guider_style||1==this.model.style?($.setTitle(i),t.title=this.model.guide.title?this.model.guide.title:i,_global.from_guider&&(t.imgUrl=this.model.guide.logo.indexOf("http")>-1?this.model.guide.logo:_global.url.ms+this.model.guide.logo),_global.guider&&(t.title=_global.guider.title?_global.guider.title:_global.guider.nickname+"的小店",t.imgUrl=_global.guider.logo.indexOf("http")>-1?_global.guider.logo:_global.url.ms+_global.guider.logo)):$.setTitle(_global.shop.name),$.setForward(t),this.$el.html(this.template(this.model)),this}})}),define("components/modules/guider_apply/model",["backbone"],function(t){return t.Model.extend({url:function(){return"/guider/is_guider.json"}})}),define("text!components/modules/guider_apply/tpl.html",[],function(){return'{{?it.original.status==-1}}\n<section class="mod-guider">\n    <div class="promoter">\n        <span class="cl-red">{{=it.nickname}}</span> 推荐你成为 <span class="cl-red">{{=_global.shop.name}}</span> {{=_global.guider_alias}}。\n    </div>\n    {{?it.original.pay || it.original.subscribe}}\n    <ul class="apply-block">\n        {{?it.original.subscribe}}\n        <li class="clearfix">\n            <div class="pull-left">\n                <p>关注微信公众号</p>\n            </div>\n            {{?it.subscribe==0}}\n            <a href="/guider/subscribe" class="btn pull-right btn-sm btn-success">关 注</a>\n            {{??}}\n            <span class="success-red">已完成</span>\n            {{?}}\n        </li>\n        {{?}}\n        {{?it.original.pay}}\n        <li class="clearfix">\n            <div class="pull-left">\n                <p>满足消费金额</p>\n                <small>\n                    需要消费 <span class="cl-red">¥{{=parseFloat(it.original.pay_money).toFixed(2)}}</span> {{?it.poor_amount>0}} ,还差\n                    <span class="cl-red">¥{{=parseFloat(it.poor_amount).toFixed(2)}}</span>\n                    {{?}}\n                </small>\n            </div>\n            {{?(it.poor_amount>0)}}\n            <a class="pull-right" href="/"><button class="btn btn-sm btn-success">去逛逛</button></a>\n            {{??}}\n            <span class="success-red">已完成</span>\n            {{?}}\n        </li>\n        {{?}}\n    </ul>\n    {{?}}\n</section>\n{{?}}\n{{?it.original.status==1}}\n<section>\n    <li class="list-empty">\n        <i class="if if-info"></i>\n        <p>正在审核</p>\n    </li>\n</section>\n{{?}}\n\n{{?it.original.status==2}}\n<section>\n    <li class="list-empty">\n        <i class="if if-info"></i>\n        <p>审核不通过</p>\n    </li>\n</section>\n{{?}}'}),define("components/modules/guider_apply/view",["backbone","doT","components/modules/guider_apply/model","text!components/modules/guider_apply/tpl.html"],function(t,i,e,n){return t.View.extend({template:i.template(n),events:{},initialize:function(){},render:function(){this.guideModel=new e,this.guideModel.on("sync",this.renderHtml,this),this.guideModel.fetch()},renderHtml:function(){return this.guideModel.set("original",this.model),_global.qrcode_local=this.guideModel.get("qrcode_local"),this.guideModel.get("status")&&this.trigger("success"),this.$el.html(this.template(this.guideModel.toJSON())),this}})}),define("text!components/modules/guider_text/tpl.html",[],function(){return'<section class="mod-guider-text">\n    <div class="promoter">{{=_global.guider_alias}}特权</div>\n    <ul class="apply-block">\n        <li class="clearfix">\n            <i class="if if-store"></i>\n            <div class="pull-left">\n                <p>独立微店</p>\n                <small>拥有自己的微店及推广二维码；</small>\n            </div>\n        </li>\n        <li class="clearfix">\n            <i class="if if-rmb-o"></i>\n            <div class="pull-left">\n                <p>销售拿佣金</p>\n                <small>微店卖出商品，您可以获得佣金；</small>\n            </div>\n        </li>\n        <li class="clearfix">\n            <small>{{=_global.guider_alias}}的商品销售统一由厂家直接收款、直接发货，并提供产品的售后服务，分销佣金由厂家统一设置。</small>\n        </li>\n    </ul>\n</section>'}),define("components/modules/guider_text/view",["backbone","doT","text!components/modules/guider_text/tpl.html"],function(t,i,e){return t.View.extend({template:i.template(e),initialize:function(){},render:function(){return this.$el.html(this.template()),this}})}),define("text!components/modules/scene/tpl.html",[],function(){return' <style>\n        html,body,.views,.page-view,.view-container,.view-inner,.swiper-container{height:100%;}\n        .modules-scene{\n            position: relative;\n            height: 100%;\n        }\n        .swiper-slide,.swiper-slide img{\n            width:100%;\n            height:100%;\n        }\n    </style>\n {{?it.music && it.on_music }}\n    <div class="bgm-btn"></div>\n <audio id="bgm" src="{{=_global.url.ms+it.music.url}}" autoplay="autoplay" loop style="display: none;"></audio>\n {{?}}\n <div class="swiper-container">\n        <div class="swiper-wrapper">\n            {{~it.item_list:value:index}}\n            <div data-href="{{=value.link_url||\'javacript:void(0)\'}}" class="swiper-slide">\n                <a href="{{=value.link_url||\'javacript:void(0)\'}}">\n                <img src="{{=_global.url.ms+value.img}}?imageMogr2/thumbnail/640x" >\n                {{?index+1<it.item_list.length}}<a href="javascript:;" class="m-tips"></a>{{?}}\n                </a>\n            </div>\n            {{~}}\n        </div>\n    </div>'}),define("components/modules/scene/view",["backbone","doT","text!components/modules/scene/tpl.html","Swiper","lazyLoad"],function(t,i,e,n,s){return t.View.extend({el:".modules-scene",template:i.template(e),events:{"click .swiper-slide":"slideGo"},initialize:function(){},render:function(){if(this.model.item_list=$.changeLink(this.model.item_list),this.$el.html(this.template(this.model)),this.model.item_list.length>0&&this.$el.find(".swiper-container").swiper({direction:"vertical",loop:this.model.loop,mousewheelControl:!0,pagination:null}),this.model.music&&this.model.on_music){var t=!0,i=document.getElementById("bgm");$("body").bind("touchstart",function(e){t&&(t=!1,i.play())}),$(".bgm-btn").bind("touchstart",function(t){t.preventDefault(),t.stopPropagation(),i.paused?(i.play(),$(".bgm-btn").removeClass("mut")):(i.pause(),$(".bgm-btn").addClass("mut"))})}return this},slideGo:function(t){var i=$(t.currentTarget).attr("data-href");"javacript:void(0)"!=i&&this.$el.remove()}})}),define("text!components/modules/voice/tpl.html",[],function(){return'<div class="mod-voice">\n    {{?it.style == 1}}\n    	{{?it.align == 1}}\n    	<div class="voice-left clearfix">{{?}}\n    	{{?it.align == 2}}\n    	<div class="voice-right clearfix">{{?}}\n\n		<img src="{{=_global.url.ms}}{{=it.voice_img || _global.shop.logo}}?imageMogr2/thumbnail/160x160!" width="40" height="40" class="voice-logo">\n		<span class="voice-bar">\n			<i class="voice-animation-static"></i>\n			<i class="voice-animation-play"></i>\n		</span>\n		<span class="hidden">\n			<audio preload {{?it.play == 1}}data-play="off"{{??}}data-play="on"{{?}} data-trans=\'off\' src="{{=_global.url.ms+it.voice_audio.url}}"></audio>	\n		</span>\n	</div>\n	{{??}}\n	<div class="voice-music clearfix">\n		<i class="voice-btn"></i>\n		{{?it.title}}<span class="voice-title">{{=it.title}}</span>{{?}}\n		<span class="hidden">\n			<audio preload {{?it.loop == 1}}loop="loop"{{?}} {{?it.play == 1}}data-play="off"{{??}}data-play="on"{{?}} data-trans=\'off\' src="{{=_global.url.ms+it.voice_audio.url}}"></audio>	\n		</span>\n	</div>{{?}}\n</div>\n'}),define("components/modules/voice/view",["backbone","doT","text!components/modules/voice/tpl.html"],function(t,i,e){return t.View.extend({template:i.template(e),events:{"click .voice-bar":"aplay","click .voice-btn":"aplay"},initialize:function(){},render:function(){return this.$el.html(this.template(this.model)),this},aplay:function(){var t=this.$el.find("audio");"off"==t.attr("data-trans")?(this.$el.find(".mod-voice").addClass("voice-play"),t.attr("data-trans","on"),t.get(0).play()):(this.$el.find(".mod-voice").removeClass("voice-play"),t.attr("data-trans","off"),t.get(0).pause(),"off"==t.attr("data-play")&&(t.get(0).currentTime="0"))}})}),define("components/modules/snatch_nav/model",["backbone"],function(t){return t.Model.extend({url:function(){return"snatch/snatch_notice.json"}})}),define("text!components/modules/snatch_nav/tpl.html",[],function(){return'<ul class="snatch-nav">\n    <li><a href="/snatch/record">\n        <i class="s-img">\n        <img src="/image/snatch-nav2.png?imageMogr2/thumbnail/160x160!"></i>\n        <div class="s-cont">\n            <h3 style="color: #CA6ACA;">往期揭晓</h3>\n            <span>查看哪些人中奖了</span>\n        </div>\n    </a></li>\n    <li><a href="/snatch/user/1">\n        <i class="s-img">\n        <img src="/image/snatch-nav4.png?imageMogr2/thumbnail/160x160!"></i>\n        <div class="s-cont">\n            <h3 style="color: #3ECCCB;">我的夺宝</h3>\n            <span>查看我参与的夺宝</span>\n        </div>\n    </a></li>\n</ul>\n{{?it.data && it.data.length>0}}\n<div class="snatch-notice">\n    <i class="if if-notice"></i>\n    <div class="js-snatch-notice warp">\n        <ul>\n            {{~it.data:val:index}}\n            <li><a href="/snatch/detail/{{=val.snatch_id}}">恭喜<span class="user-name"> {{=val.user_name}} </span>获得了 {{=val.name||\'\'}}</a></li>\n            {{~}}\n        </ul>\n    </div>\n</div>\n{{?}}'}),define("components/modules/snatch_nav/view",["backbone","doT","components/modules/snatch_nav/model","text!components/modules/snatch_nav/tpl.html"],function(t,i,e,n){return t.View.extend({template:i.template(n),initialize:function(){},render:function(){this.model=new e,this.model.on("sync",this.renderHtml,this),this.model.fetch()},renderHtml:function(){this.$el.html(this.template(this.model.toJSON()));var t=this;if(this.model.get("data")&&this.model.get("data").length>0){setInterval(function(){t.autoScroll(".js-snatch-notice")},3e3)}return this},autoScroll:function(t){$(t,this.$el).find("ul").animate({marginTop:"-3.5rem"},500,function(){$(this).css({marginTop:0}).find("li:first").appendTo(this)})}})}),define("components/modules/snatch_goods/collection",["backbone.paginator"],function(t){return Backbone.PageableCollection.extend({url:"/snatch/snatch_list.json",state:{pagesInRange:0,pageSize:10},queryParams:{totalPages:null,totalRecords:null,pageSize:"limit",currentPage:null,offset:function(){return(this.state.currentPage-1)*this.state.pageSize}},parseState:function(t,i,e,n){return{totalRecords:t._count,total:t.total}},parseRecords:function(t,i){return t.data}})}),define("apps/snatch/models/cart",["backbone"],function(t){return t.Model.extend({url:function(){return this.isNew()?"/snatch/snatch_cart.json":"snatch_cart/"+this.id+".json"}})}),define("text!components/modules/snatch_goods/item.html",[],function(){return'<a href="/snatch/detail/{{=it.id}}">\n    {{\n    var img_size;\n    if(it.content.size==\'big\')\n    {\n    img_size=\'640x640!\'\n\n    }else if(it.content.size==\'small\')\n    {\n    img_size=\'320x320!\'\n    }else{\n    img_size=\'240x240!\'\n    }\n    }}\n    <div class="goods-image"><img class="lazy" data-original="{{=_global.url.ms+it.goods_img}}?imageMogr2/thumbnail/{{=img_size}}"></div>\n    <div class="goods-info">\n        <p class="goods-title">{{=it.name||\'\'}}</p>\n        <div class="goods-progress">\n            <p class="txt">开奖进度<strong>{{=it.rate||0}}%</strong></p>\n            <p class="bar-wrap">\n                <span class="progress" style="width:{{=it.rate||0}}%;"><i class="color"></i></span>\n            </p>\n            {{?it.content.size!=\'small\'}}\n            <ul class="txt clearfix">\n                <li class="pull-left">总需{{=it.total_num}}</li>\n                <li class="pull-right">剩余<span class="clr-red">{{=it.total_num-it.buy_number}}</span></li>\n            </ul>\n            {{?}}\n        </div>\n        <span class="button-add-cart js-add-cart">\n            <span class="button-round"></span>\n        </span>\n    </div>\n</a>'}),define("components/modules/snatch_goods/item",["backbone","doT","apps/snatch/models/cart","text!components/modules/snatch_goods/item.html"],function(t,i,e,n){return t.View.extend({tagName:"li",className:"clearfix",template:i.template(n),events:{"click .js-add-cart":"addCart"},initialize:function(){
this.cartmodel=new e},render:function(){return this.$el.html(this.template(this.model.toJSON())),this},addCart:function(t){var i=this;this.undelegateEvents(),$(t.currentTarget).loading("show"),this.cartmodel.set("snatch_id",this.model.get("id")),this.cartmodel.set("type",0),this.cartmodel.save("","",{success:function(e,n,s){$(t.currentTarget).html('<span class="button-round"></span>'),i.delegateEvents();var a=20,o=$(".global-cart"),l=$(t.currentTarget).parent().siblings(".goods-image").find("img"),r=$('<img width="'+l.width()+'" src="'+l.attr("src")+'" />');r.css({position:"absolute",top:l.offset().top,left:l.offset().left,"z-index":100}),$("body").append(r);var c=(r.offset().left-o.offset().left-o.width()/2)/a,d=(r.offset().top-o.offset().top-o.height()/2)/a,p=r.width()/a,u=r.height()/a;m&&clearInterval(m);var m=setInterval(function(){r.width()>0?r.css({top:r.offset().top-d,left:r.offset().left-c,width:r.width()-p,height:r.height()-u}):(m&&clearInterval(m),r.remove(),o.find(".if-cart").html("<em>"+n.total+"</em>"))},a)},error:function(e,n,s){i.delegateEvents(),$(t.currentTarget).html('<span class="button-round"></span>'),$.toast(n.responseJSON.error)}}),t.stopPropagation(),t.preventDefault()}})}),define("text!components/modules/snatch_goods/tpl.html",[],function(){return'<section class="mod-snatch">\n    <div class="filter">\n        <ul>\n            <li data-column="number" class="js-column active">人气</li>\n            <li data-column="created_at" class="js-column">最新</li>\n            <li data-column="rate" class="js-column">进度</li>\n            <li data-column="total_num" class="js-column">总需<i class="if if-sort"></i></li>\n        </ul>\n    </div>\n    <div class="mod-goods-list">\n        <ul class="goods-list style-{{=it.size}} clearfix js-goods-list">\n        </ul>\n        <div class="js-more-loading"></div>\n    </div>\n    <div class="bar bottom-left-bar global-icon">\n        <a class="global-cart" href="/snatch/cart"><i class="if if-cart"></i></a>\n    </div>\n</section>\n'}),define("text!apps/guider/templates/empty.html",[],function(){return'<li class="list-empty"{{?it.is_background}} style="background-image: none;background-color: transparent;"{{?}}>\n    <i class="if if-info"></i>\n    <p>{{=it.info}}</p>\n    {{?it.show}}\n    <div class="t_center">\n        <a href="/" class="btn btn-danger-o btn-sm">去逛逛</a>\n    </div>\n    {{?}}\n</li>'}),define("components/modules/snatch_goods/view",["backbone","doT","lazyLoad","components/modules/snatch_goods/collection","components/modules/snatch_goods/item","text!components/modules/snatch_goods/tpl.html","text!apps/guider/templates/empty.html"],function(t,i,e,n,s,a,o){return t.View.extend({template:i.template(a),events:{"click .js-column":"setColumn"},initialize:function(){this.collection=new n,this.collection.on("sync",this.renderEach,this)},render:function(){return this.collection.queryParams.column="number",this.collection.queryParams.direction="desc",this.collection.fetch(),$(".js-more-loading",this.$el).loading("show"),this.$el.html(this.template(this.model)),this.bottomLoad(),this},renderEach:function(){if($(".js-more-loading",this.$el).loading("hide"),this.collection.state.total>0&&$(".global-cart .if-cart",this.$el).html("<em>"+this.collection.state.total+"</em>"),0==this.collection.state.totalRecords){var t=i.template(o),e="店铺还没有添加商品";$(".js-goods-list",this.$el).html(t({info:e,is_background:1})),$(".js-goods-list",this.$el).find("li").css("width","100%")}else this.collection.each(this.renderItem,this),$("img.lazy").lazyload(),this.isRequest=!1},renderItem:function(t){t.set("content",this.model),$(".js-goods-list",this.$el).append(new s({model:t}).render().$el)},setColumn:function(t){var i=$(t.currentTarget),e=this,n=function(){$(".js-goods-list",e.$el).html(""),i.addClass("active").siblings().removeClass("active"),e.collection.queryParams.column=i.attr("data-column"),$(".js-more-loading",e.$el).loading("show"),e.collection.getFirstPage({fetch:!0})};"total_num"==i.attr("data-column")?(i.find(".if-sort").hasClass("sort-asc")?(this.collection.queryParams.direction="desc",i.find(".if-sort").addClass("sort-desc").removeClass("sort-asc")):(this.collection.queryParams.direction="asc",i.find(".if-sort").addClass("sort-asc").removeClass("sort-desc")),n()):i.hasClass("active")||(this.collection.queryParams.direction="desc",$(".js-column").find(".if-sort").removeClass("sort-desc").removeClass("sort-asc"),n())},bottomLoad:function(){this.isRequest=!1;var t=this;$(window).on("scroll",function(i){var e=$(window).scrollTop(),n=$(document).height(),s=$(window).height();e>=n-s-100&&t.collection.hasNextPage()&&0==t.isRequest&&(t.isRequest=!0,$(".js-more-loading",t.$el).loading("show"),t.collection.getNextPage())})}})}),define("text!components/modules/partner_banner/tpl.html",[],function(){return'<section class="partner-banner">\n    <img src="/image/partner_banner.png">\n</section>'}),define("components/modules/partner_banner/view",["backbone","doT","text!components/modules/partner_banner/tpl.html"],function(t,i,e){return t.View.extend({template:i.template(e),initialize:function(){},render:function(){return this.$el.html(this.template()),this}})}),define("text!components/modules/partner_apply/tpl.html",[],function(){return'<section class="partner-apply-form">\n    <div class="list-block">\n        <div class="item-content">\n            <select name="partner-apply-type">\n                {{~it.modes:v:index}}\n                    <option value="{{=v.value}}">{{=v.text}}</option>\n                {{~}}\n            </select>\n        </div>\n{{~it.fields:v:index}}\n<div class="item-content">\n{{switch(v.type){}}\n{{case \'date\':}}\n<input type="text" name="{{=v.type+index}}" {{?(v.required)}}required{{?}} class="form-item date-input" placeholder="{{=v.name}}" value="{{=v.value || \'\'}}" />\n{{break;}}\n{{case \'time\':}}\n<input type="text" name="{{=v.type+index}}" {{?(v.required)}}required{{?}} class="form-item time-input" placeholder="{{=v.name}}" value="{{=v.value || \'\'}}" />\n{{break;}}\n{{case \'multipleText\':}}\n<textarea name="{{=v.type+index}}" {{?(v.required)}}required{{?}} class="form-item">{{=v.value}}</textarea>\n{{break;}}\n{{default:}}\n<input type="text" name="{{=v.type+index}}" {{?(v.required)}}required{{?}} class="form-item" placeholder="{{=v.name}}" value="{{=v.value || \'\'}}">\n{{}}}\n</div>\n{{~}}\n    </div>\n    <div class="list-btn">\n        <a class="btn btn-apply js-partner-apply-btn">我要申请</a>\n    </div>\n</section>'}),define("components/modules/partner_apply/view",["backbone","doT","text!components/modules/partner_apply/tpl.html"],function(t,i,e){return t.View.extend({template:i.template(e),events:{},initialize:function(){},render:function(){switch(this.model.type){case 0:this.model.modes=[{value:0,text:"区域模式"}];break;case 1:this.model.modes=[{value:1,text:"团队模式"}];break;default:this.model.modes=[{value:-1,text:"请选择"+_global.partner_setting.partner_alias+"模式"},{value:0,text:"区域模式"},{value:1,text:"团队模式"}]}return this.$el.html(this.template(this.model)),$(".date-input").calendar({dateFormat:"yyyy-mm-dd"}),$(".time-input").datetimePicker({toolbarTemplate:'<header class="bar bar-nav">                        <button class="button button-link pull-right close-picker">确定</button>                        <h1 class="title">选择日期和时间</h1>                        </header>'}),this}})}),define("text!components/modules/partner_intro/tpl.html",[],function(){return'<section class="partner-intro">\n    <ul>\n        <li class="area">\n            <div class="title">区域{{=_global.partner_setting.partner_alias}}</div>\n            <div class="sub">区域商品卖出，您可以获得商家分红；</div>\n        </li>\n        <li class="team">\n            <div class="title">团队{{=_global.partner_setting.partner_alias}}</div>\n            <div class="sub">你的团队成员有商品卖出，您可获得商家分红；</div>\n        </li>\n    </ul>\n</section>'}),define("components/modules/partner_intro/view",["backbone","doT","text!components/modules/partner_intro/tpl.html"],function(t,i,e){return t.View.extend({template:i.template(e),initialize:function(){},render:function(){return this.$el.html(this.template()),this}})}),define("text!components/modules/partner_head/tpl.html",[],function(){return'<section class="partner-head clearfix">\n    <a href="/partner/user">\n        <div class="user-img">\n            {{?_global.partner.avatar.indexOf("http")!=-1}}\n            <img class="avatar" src="{{=_global.partner.avatar}}">\n            {{??}}\n            <img class="avatar" src="{{=_global.partner.avatar ? _global.url.ms + _global.partner.avatar : \'/image/default_head_img.jpg\'}}">\n            {{?}}\n        </div>\n        <div class="user-info">\n            <p class="username">\n                {{=it.nickname}}\n                {{?it.is_team_type && it.partner_team_type_name}}<span class="label">{{=it.partner_team_type_name}}</span>{{?}}\n                {{?it.is_shareholder_type && it.partner_shareholder_type_name}}<span class="label">{{=it.partner_shareholder_type_name}}</span>{{?}}\n            </p>\n            <p class="mobile">{{=it.mobile || \'&nbsp;\'}}</p>\n        </div>\n    </a>\n</section>'}),define("components/modules/partner_head/view",["backbone","doT","text!components/modules/partner_head/tpl.html"],function(t,i,e){return t.View.extend({template:i.template(e),initialize:function(){},render:function(){return this.$el.html(this.template(this.model)),this}})}),define("text!components/modules/partner_account/tpl.html",[],function(){return'<section class="partner-account">\n    <ul class="account-info clearfix">\n        <li>\n            <a href="/balance?type=10">\n                <div class="intro-text">累计收益</div>\n                {{var total = it.total.split(\'.\');}}\n                <div class="account-price"><span class="price-currency">{{=_global.setting.currency_unit}}</span><span class="price-integer">{{=total[0]}}</span><span class="price-decimal">.{{=total[1]}}</span></div>\n            </a>\n        </li>\n    </ul>\n    <ul class="account-info-list">\n        <li>\n            <a href="/partner/unsettled">\n                <span>未结算</span>\n                <span class="f_right cl-price">{{=_global.setting.currency_unit}}{{=it.expect}}</span>\n            </a>\n        </li>\n    </ul>\n</section>'}),define("components/modules/partner_account/view",["backbone","doT","text!components/modules/partner_account/tpl.html"],function(t,i,e){return t.View.extend({template:i.template(e),initialize:function(){},render:function(){return this.$el.html(this.template(this.model)),this}})}),define("text!components/modules/partner_navs/tpl.html",[],function(){return'<section class="partner-navs">\n    {{?_global.partner.is_team_type}}\n    <ul class="list-block">\n        <li class="no-arrow">\n            <a><i class="if if-team"></i>团队合伙人</a>\n        </li>\n    </ul>\n    <div class="tab-nav">\n        <a href="/partner/team">\n            <span class="word">\n                <span class="num">{{=it.team}}</span>\n                <span class="title">我的团队</span>\n            </span>\n        </a>\n        <a href="/partner/order?type=team">\n            <span class="word">\n                <span class="num cl-price"><span class="currency">{{=_global.setting.currency_unit}}</span>{{=it.team_total}}</span>\n                <span class="title">累计收益</span>\n            </span>\n        </a>\n    </div>\n    {{?}}\n\n    {{?_global.partner.is_region_type}}\n    <ul class="list-block">\n        <li class="no-arrow">\n            <a><i class="if if-area"></i>区域合伙人</a>\n        </li>\n    </ul>\n    <div class="tab-nav">\n        <a href="/partner/area">\n            <span class="word">\n                <!--<span class="num cl-price"><span class="currency">{{=_global.setting.currency_unit}}</span>{{=it.region_total}}</span>-->\n                <span class="num main">区域贡献</span>\n                <span class="title">查看详情</span>\n            </span>\n        </a>\n        <a href="/partner/order?type=region">\n            <span class="word">\n                <span class="num cl-price"><span class="currency">{{=_global.setting.currency_unit}}</span>{{=it.region_total}}</span>\n                <span class="title">累计收益</span>\n            </span>\n        </a>\n    </div>\n    {{?}}\n\n    {{?_global.partner.is_shareholder_type}}\n    <ul class="list-block">\n        <li class="no-arrow">\n            <a><i class="if if-sharehoder"></i>股东合伙人</a>\n        </li>\n    </ul>\n    <div class="tab-nav">\n        <a href="/partner/shareholder">\n            <span class="word">\n                <span class="num cl-price"><span class="currency">{{=_global.setting.currency_unit}}</span>{{=it.shareholder_total}}</span>\n                <span class="title">累计收益</span>\n            </span>\n        </a>\n    </div>\n    {{?}}\n\n    {{?it.fellow_enabled}}\n    <ul class="list-block">\n        <li class="no-arrow">\n            <a><i class="if if-fellow"></i>伙伴合伙人</a>\n        </li>\n    </ul>\n    <div class="tab-nav">\n        {{?_global.partner.is_fellow_type}}\n        <a href="/partner/fellow/members">\n            <span class="word">\n                <span class="num main">{{=it.fellow_type_name || \'默认\'}}</span>\n                <span class="title">伙伴级别</span>\n            </span>\n        </a>\n        <a href="/partner/order?type=fellow">\n            <span class="word">\n                <span class="num cl-price"><span class="currency">{{=_global.setting.currency_unit}}</span>{{=it.fellow_total}}</span>\n                <span class="title">累计收益</span>\n            </span>\n        </a>\n        {{??}}\n        <a href="/partner/fellow/instr" class="cl-gray">\n            您尚未达到伙伴条件，<label class="clr-blue">查看条件</label>\n        </a>\n        {{?}}\n    </div>\n    {{?}}\n\n    {{?it.itemList.length > 0}}\n    <ul class="list-block">\n        <li class="no-arrow">\n            <a><i class="if if-share"></i>{{=it.navName || \'自定义菜单\'}}</a>\n        </li>\n    </ul>\n    <div class="tab-nav float">\n        {{~it.itemList:v:index}}\n        <a {{?v.link_url}}href="{{=v.link_url}}"{{?}}>\n            <span class="word">\n                <span class="num">\n                    {{?v.img}}\n                    <img src="{{=_global.url.ms}}{{=v.img}}" />\n                    {{??}}\n                    <i class="if if-more cl-gray"></i>\n                    {{?}}\n                </span>\n                <span class="title">{{=v.title}}</span>\n            </span>\n        </a>\n        {{~}}\n        {{?it.itemList.length % 2 != 0}}\n        <a><span class="word"></span></a>\n        {{?}}\n    </div>\n    {{?}}\n</section>'}),define("components/modules/partner_navs/view",["backbone","doT","text!components/modules/partner_navs/tpl.html"],function(t,i,e){return t.View.extend({template:i.template(e),initialize:function(){},render:function(){return this.$el.html(this.template(this.model)),this}})}),define("components/modules/collect_list/collection",["backbone.paginator"],function(t){return Backbone.PageableCollection.extend({url:"/collect/collect.json",state:{pagesInRange:0,pageSize:10},queryParams:{totalPages:null,totalRecords:null,pageSize:"limit",currentPage:null,offset:function(){return(this.state.currentPage-1)*this.state.pageSize}},parseState:function(t,i,e,n){return{totalRecords:t._count,total:t.total}},parseRecords:function(t,i){return t.data}})}),define("text!components/modules/collect_list/item.html",[],function(){return'<a class="goods-item" href="/collect/detail/{{=it.id}}">\n    {{\n    var img_size;\n    if(it.content.size==\'big\')\n    {\n    img_size=\'640x320!\'\n\n    }else if(it.content.size==\'small\')\n    {\n    img_size=\'320x320!\'\n    }else{\n    img_size=\'240x240!\'\n    }\n    }}\n\n\n    {{? it.content.size==\'list\'}}\n      {{? it.picture}}\n        <div class="goods-img">\n            <img class="lazy" data-original="{{=_global.url.ms+it.picture}}?imageMogr2/thumbnail/{{=img_size}}">\n        </div>\n      {{??}}\n        <div class="goods-img">\n            <img class="lazy" data-original="{{=_global.url.ms+it.pic}}?imageMogr2/thumbnail/{{=img_size}}">\n        </div>\n      {{?}}\n    {{??}}\n        <div class="goods-img" style="background-image: url(\'{{=_global.url.ms+it.pic}}?imageMogr2/thumbnail/{{=img_size}}\')">\n\n        </div>\n    {{?}}\n\n    <div class="goods-info">\n        <p class="goods-title">{{=it.name||\'\'}}</p>\n        <div class="goods-progress">\n            {{? it.content.size == \'list\' }}\n                <span class="progress" style="width:{{=(it.ratio > 100 ? 100 : it.ratio)}}%"></span>\n                {{? it.ratio > 20}}\n                <span class="percentage" style="right:{{=((100 - it.ratio)< 0 ? 0 : (100 - it.ratio))}}%">{{=it.ratio||0}}%</span>\n                {{??}}\n                <span class="percentage" style="left:{{=it.ratio||0}}%">{{=it.ratio||0}}%</span>\n                {{?}}\n            {{?}}\n            {{? it.content.size == \'big\' }}\n            <svg viewbox="0 0 100 100">\n                <circle cx="50" cy="50" r="45" stroke-width="4" stroke="#ccc" fill="none"></circle>\n                <circle cx="50" cy="50" r="45" stroke-width="4" stroke="#ff6600" fill="none"\n                        transform="rotate(-90 50 50)"\n                        stroke-dasharray="{{=(it.ratio/100) * Math.PI * 90}} 283">\n                </circle>\n            </svg>\n            <span>{{=it.ratio||0}}%</span>\n            {{?}}\n        </div>\n        <p class="goods-text">\n            <span><i class="if if-user"></i>{{=it.buyer}}人</span>\n            <span><i class="if if-rmb-o"></i>{{=it.amount_have}}元</span>\n            {{? it.be_day != 0}}\n            <span><i class="if if-time"></i>{{=it.be_day}}天</span>\n            {{?}}\n        </p>\n    </div>\n</a>\n\n\n\n\n'}),define("components/modules/collect_list/item",["backbone","doT","text!components/modules/collect_list/item.html"],function(t,i,e){return t.View.extend({tagName:"li",className:"clearfix",template:i.template(e),events:{},initialize:function(){},render:function(){return this.$el.html(this.template(this.model.toJSON())),this}})}),define("text!components/modules/collect_list/tpl.html",[],function(){return'<div class="collect">\n    <div class="collect-tab">\n        <ul>\n            <li type="1" class="j-sort active">最新上线</li>\n            <li type="2" class="j-sort">即将结束</li>\n            <li type="3" class="j-sort">完结项目</li>\n        </ul>\n    </div>\n    <div class="collect-goods">\n        <ul class="goods-list style-{{=it.size}} js-goods-list"></ul>\n        <div class="js-more-loading"></div>\n    </div>\n</div>\n\n<div class="aside-bar">\n    <a href="javascript:;" class="if if-my-zhongchou js-my-zhongchou">\n        <em></em>\n    </a>\n</div>'}),define("components/modules/collect_list/view",["backbone","doT","lazyLoad","components/modules/collect_list/collection","components/modules/collect_list/item","text!components/modules/collect_list/tpl.html","text!apps/guider/templates/empty.html"],function(t,i,e,n,s,a,o){return t.View.extend({template:i.template(a),events:{"click .j-sort":"setColumn","click .js-my-zhongchou":"goMyFav"},initialize:function(){this.collection=new n,this.collection.on("sync",this.renderEach,this)},render:function(){return this.collection.queryParams.type="1",this.collection.fetch(),$(".js-more-loading",this.$el).loading("show"),this.$el.html(this.template(this.model)),this.bottomLoad(),this},renderEach:function(){if($(".js-more-loading",this.$el).loading("hide"),0==this.collection.state.totalRecords){var t=i.template(o),e="暂无项目";$(".js-goods-list",this.$el).html(t({info:e,is_background:1})),$(".js-goods-list",this.$el).find("li").css("width","100%")}else this.collection.each(this.renderItemList,this),$("img.lazy").lazyload(),this.isRequest=!1},renderItemList:function(t){t.set("content",this.model),$(".js-goods-list",this.$el).append(new s({model:t}).render().$el)},goMyFav:function(){_global.user?t.history.navigate("/collect/record/follow",{trigger:!0,replace:!1}):$.toast("请先登陆")},setColumn:function(t){var i=this;if(!$(t.currentTarget).hasClass("active")){$(t.currentTarget).addClass("active").siblings().removeClass("active");var e=$(t.currentTarget).attr("type");i.collection.queryParams.type=e,$(".js-goods-list",this.$el).html(""),i.collection.getFirstPage()}},bottomLoad:function(){this.isRequest=!1;var t=this;$(window).on("scroll",function(i){var e=$(window).scrollTop(),n=$(document).height(),s=$(window).height();e>=n-s-100&&t.collection.hasNextPage()&&0==t.isRequest&&(t.isRequest=!0,$(".js-more-loading",t.$el).loading("show"),t.collection.getNextPage())})}})}),define("text!components/modules/credit_head/tpl.html",[],function(){return'<div class="credit-mall-header">\n    <ul class="mall-item">\n        <li>\n            <i class="if if-credit-circle"></i>\n            <span>积分</span>\n            <span class="record-num">{{= it.credit_num||0}}</span>\n        </li>\n        <li>\n             <a href="/credit/record" style="color: #000;">\n                <i class="if if-credit-record"></i>\n                <span>积分详情</span>\n             </a>\n        </li>\n    </ul>\n</div>'}),define("components/modules/credit_head/view",["backbone","doT","text!components/modules/credit_head/tpl.html"],function(t,i,e){return t.View.extend({template:i.template(e),initialize:function(){},render:function(){return this.$el.html(this.template(this.model)),this}})}),define("components/modules/credit_goods/collection",["backbone.paginator"],function(t){return Backbone.PageableCollection.extend({url:"/credit/getCreditGoods.json",state:{pagesInRange:0,pageSize:10},queryParams:{totalPages:null,totalRecords:null,pageSize:"limit",currentPage:null,offset:function(){return(this.state.currentPage-1)*this.state.pageSize}},parseState:function(t,i,e,n){return{totalRecords:t._count}},parseRecords:function(t,i){return t.data}})}),define("text!components/modules/credit_goods/item.html",[],function(){return'<a class="clearfix" href="/goods/{{=it.goods_id}}">\n    <div class="goods-title">{{=it.title}}</div>\n    <p class="goods-credit">\n        {{?it.price}}\n        <span>{{=_global.setting.currency_unit}}{{=parseInt(it.price)}}</span>\n        <span>+</span>\n        {{?}}\n        <span>{{=it.credit_price}}</span>\n        <i class="if if-credit-money"></i>\n    </p>\n    <img class="lazy" data-original="{{=_global.url.ms+it.img}}?imageMogr2/thumbnail/320x320!">\n</a>'}),define("components/modules/credit_goods/item",["backbone","doT","text!components/modules/credit_goods/item.html"],function(t,i,e){return t.View.extend({tagName:"li",className:"clearfix",template:i.template(e),events:{},initialize:function(){},render:function(){return this.$el.html(this.template(this.model.toJSON())),this}})}),define("text!components/modules/credit_goods/tpl.html",[],function(){return'<div class="mall-goods">\n    <div class="goods-header">\n        <div class="tab-goods">\n            <div class="all-goods j-mall-type active" data-type="1">全部商品</div>\n            <div class="able-goods j-mall-type" data-type="2">我能换的</div>\n            <div class="credit-switch-left credit-switch"></div>\n        </div>\n    </div>\n\n    <div class="goods-list-wrapper">\n        <ul class="goods-list clearfix"></ul>\n        <div class="js-more-loading"></div>\n    </div>\n</div>'}),define("components/modules/credit_goods/view",["backbone","doT","lazyLoad","components/modules/credit_goods/collection","components/modules/credit_goods/item","text!components/modules/credit_goods/tpl.html","text!apps/guider/templates/empty.html"],function(t,i,e,n,s,a,o){return t.View.extend({template:i.template(a),events:{"click .j-mall-type":"changeType"},initialize:function(){this.collection=new n,this.collection.on("sync",this.renderEach,this)},render:function(){if(window.localStorage.getItem("creditType")){var t=window.localStorage.getItem("creditType");this.collection.queryParams.type=t}else this.collection.queryParams.type="1";return this.collection.fetch(),$(".js-more-loading",this.$el).loading("show"),this.$el.html(this.template(this.model)),"1"==t?$(".credit-switch",this.$el).addClass("credit-switch-left").removeClass("credit-switch-right"):($(".all-goods",this.$el).removeClass("active").siblings().addClass("active"),$(".credit-switch",this.$el).addClass("credit-switch-right").removeClass("credit-switch-left")),this.bottomLoad(),this},renderEach:function(){if($(".js-more-loading",this.$el).loading("hide"),0==this.collection.state.totalRecords){var t=i.template(o),e="暂无商品";$(".goods-list",this.$el).html(t({info:e,is_background:1})),$(".goods-list",this.$el).find("li").css("width","100%")}else this.collection.each(this.renderItemList,this),$("img.lazy").lazyload(),this.isRequest=!1},renderItemList:function(t){$(".goods-list",this.$el).append(new s({model:t}).render().$el)},changeType:function(t){var i=$(t.currentTarget),e=i.data("type");i.hasClass("active")||(i.addClass("active").siblings().removeClass("active"),"1"==e?($(".credit-switch",this.$el).addClass("credit-switch-left").removeClass("credit-switch-right"),window.localStorage.setItem("creditType","1")):($(".credit-switch",this.$el).addClass("credit-switch-right").removeClass("credit-switch-left"),window.localStorage.setItem("creditType","2")),this.collection.queryParams.type=e,$(".goods-list",this.$el).html(""),this.collection.getFirstPage())},bottomLoad:function(){this.isRequest=!1;var t=this;$(window).on("scroll",function(i){var e=$(window).scrollTop(),n=$(document).height(),s=$(window).height();e>=n-s-100&&t.collection.hasNextPage()&&0==t.isRequest&&(t.isRequest=!0,$(".js-more-loading",t.$el).loading("show"),t.collection.getNextPage())})}})}),define("text!components/modules/team_head/tpl.html",[],function(){return'<div class="view-team">\n    <div class="Upper">\n        <div class="InUpper">\n             <div class="title">\n                {{?it.member}}\n                <i>\n                    <img src="{{=it.member.avatar}}" class="team_logo" />\n                    {{?_global.teamer.is_captain==1}}\n                    <img src="image/captains_logo.png" class="captains" />\n                    {{?}}\n                </i>    \n                {{?}}\n\n            </div>\n            <div class="name">\n                <span>\n                    {{=it.nickname}}\n                </span>\n                <span>\n                    {{=it.mobile}}\n                </span>\n            </div>\n        </div>\n        <div class="royalty">\n            <div class="left">\n                <h2>{{=it.total_bonus}}</h2>\n                <p>累计提成(元)</p>\n            </div>\n            <div class="right">\n                <h2>{{=it.team_order_count}}</h2>\n                <p>贡献订单</p>\n            </div>\n        </div>\n    </div>\n    <div class="team_name">     \n        <a href="/team/edit" class="clearfix">\n            {{?it.team}}\n            <div class="logo">\n            {{?it.team.logo.indexOf("/")!=0}}\n                <img src="{{=_global.url.ms}}{{=it.team.logo}}"/>\n            {{??}}\n                <img src="{{=it.team.logo}}"/>\n            {{?}}\n            </div>\n            {{?}}\n            <div class="logo_name">\n                {{?it.team}}\n                <h4>{{=it.team.name}}</h4>\n                {{?}}\n                {{?it.team}}\n                <p>编号:{{=it.team.id}}</p>\n                {{?}}\n                <i class="if"></i>\n            </div>\n        </a>\n    </div>\n    {{?_global.teamer.is_captain==1}}\n    <div class="content">\n        <ul class="InContent">\n            <li>\n                <a href="/team/invite/{{=_global.teamer.id}}">\n                    <i class="if first"></i>\n                    <p>成员邀请</p>\n                    {{? it.to_audit_count >0}}\n                    <span class="number">{{=it.to_audit_count}}</span>\n                    {{?}}\n                </a>\n                \n            </li>\n            <li>\n                <a href="/team/order">\n                    <i class="if second"></i>\n                    <p>{{=_global.team_alias}}订单</p>\n                </a>\n                \n            </li>\n            <li>\n                <a href="/team/bonus">\n                   <i class="if third"></i>\n                    <p>{{=_global.team_alias}}提成</p> \n                </a>\n                \n            </li>\n        </ul>\n    </div>\n    {{?}}\n</div>'}),define("components/modules/team_head/view",["backbone","doT","text!components/modules/team_head/tpl.html"],function(t,i,e){return t.View.extend({template:i.template(e),initialize:function(){},render:function(){return this.$el.html(this.template(this.model)),this}})}),define("text!components/modules/team_navs/tpl.html",[],function(){return'<div class="view-team">\n    <div class="main">\n        <ul class="Inmain">\n            <li>\n                <a href="/balance?type=11" class="clearfix">                   \n                    <p> \n                        <i class="if if-iconfont">&#xe67f;</i>我的提成\n                    </p>\n                    <div class="if next"></div>\n                </a>                \n            </li>\n            <li class="current">\n                <a href="/team/contribution_order" class="clearfix">                    \n                    <p>\n                        <i class="if if-iconfont">&#xe687;</i>\n                        贡献订单\n                        <span>共计{{=it.team_order_count}}笔订单</span>\n                        <div class="if next"></div>\n                    </p>                    \n                </a>\n            </li>\n            <li>\n                <a href="/team/member_list" class="clearfix"> \n                    <p>\n                        <i class="if if-iconfont">&#xe688;</i>\n                        {{=_global.team_alias}}成员                    \n                        <span>共{{=it.team_count}}位成员</span>\n                        <div class="if next"></div>\n                    </p>\n                </a>                \n            </li>\n            <li>\n                <a href="/team/hero" class="clearfix">\n                    <p>\n                        <i class="if if-iconfont">&#xe684;</i>\n                        {{=_global.team_alias}}榜                    \n                        <span>本月排行第{{=it.rank}}名</span>\n                        <div class="if next"></div>\n                    </p>\n                </a>                \n            </li>\n        </ul>\n    </div>\n</div>'}),define("components/modules/team_navs/view",["backbone","doT","text!components/modules/team_navs/tpl.html"],function(t,i,e){return t.View.extend({template:i.template(e),initialize:function(){},render:function(){return this.$el.html(this.template(this.model)),this}})}),function(t,i,e){function n(t,e){this.wrapper="string"==typeof t?i.querySelector(t):t,this.scroller=this.wrapper.children[0],this.scrollerStyle=this.scroller.style,this.options={resizeScrollbars:!0,mouseWheelSpeed:20,snapThreshold:.334,startX:0,startY:0,scrollY:!0,directionLockThreshold:5,momentum:!0,bounce:!0,bounceTime:600,bounceEasing:"",preventDefault:!0,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:!0,useTransition:!0,useTransform:!0};for(var n in e)this.options[n]=e[n];this.translateZ=this.options.HWCompositing&&l.hasPerspective?" translateZ(0)":"",this.options.useTransition=l.hasTransition&&this.options.useTransition,this.options.useTransform=l.hasTransform&&this.options.useTransform,this.options.eventPassthrough=this.options.eventPassthrough===!0?"vertical":this.options.eventPassthrough,this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault,this.options.scrollY="vertical"==this.options.eventPassthrough?!1:this.options.scrollY,this.options.scrollX="horizontal"==this.options.eventPassthrough?!1:this.options.scrollX,this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough,
this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold,this.options.bounceEasing="string"==typeof this.options.bounceEasing?l.ease[this.options.bounceEasing]||l.ease.circular:this.options.bounceEasing,this.options.resizePolling=void 0===this.options.resizePolling?60:this.options.resizePolling,this.options.tap===!0&&(this.options.tap="tap"),"scale"==this.options.shrinkScrollbars&&(this.options.useTransition=!1),this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1,this.x=0,this.y=0,this.directionX=0,this.directionY=0,this._events={},this._init(),this.refresh(),this.scrollTo(this.options.startX,this.options.startY),this.enable()}function s(t,e,n){var s=i.createElement("div"),a=i.createElement("div");return n===!0&&(s.style.cssText="position:absolute;z-index:9999",a.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px"),a.className="iScrollIndicator","h"==t?(n===!0&&(s.style.cssText+=";height:7px;left:2px;right:2px;bottom:0",a.style.height="100%"),s.className="iScrollHorizontalScrollbar"):(n===!0&&(s.style.cssText+=";width:7px;bottom:2px;top:2px;right:1px",a.style.width="100%"),s.className="iScrollVerticalScrollbar"),s.style.cssText+=";overflow:hidden",e||(s.style.pointerEvents="none"),s.appendChild(a),s}function a(e,n){this.wrapper="string"==typeof n.el?i.querySelector(n.el):n.el,this.wrapperStyle=this.wrapper.style,this.indicator=this.wrapper.children[0],this.indicatorStyle=this.indicator.style,this.scroller=e,this.options={listenX:!0,listenY:!0,interactive:!1,resize:!0,defaultScrollbars:!1,shrink:!1,fade:!1,speedRatioX:0,speedRatioY:0};for(var s in n)this.options[s]=n[s];this.sizeRatioX=1,this.sizeRatioY=1,this.maxPosX=0,this.maxPosY=0,this.options.interactive&&(this.options.disableTouch||(l.addEvent(this.indicator,"touchstart",this),l.addEvent(t,"touchend",this)),this.options.disablePointer||(l.addEvent(this.indicator,l.prefixPointerEvent("pointerdown"),this),l.addEvent(t,l.prefixPointerEvent("pointerup"),this)),this.options.disableMouse||(l.addEvent(this.indicator,"mousedown",this),l.addEvent(t,"mouseup",this))),this.options.fade&&(this.wrapperStyle[l.style.transform]=this.scroller.translateZ,this.wrapperStyle[l.style.transitionDuration]=l.isBadAndroid?"0.001s":"0ms",this.wrapperStyle.opacity="0")}var o=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(i){t.setTimeout(i,1e3/60)},l=function(){function n(t){return o===!1?!1:""===o?t:o+t.charAt(0).toUpperCase()+t.substr(1)}var s={},a=i.createElement("div").style,o=function(){for(var t,i=["t","webkitT","MozT","msT","OT"],e=0,n=i.length;n>e;e++)if(t=i[e]+"ransform",t in a)return i[e].substr(0,i[e].length-1);return!1}();s.getTime=Date.now||function(){return(new Date).getTime()},s.extend=function(t,i){for(var e in i)t[e]=i[e]},s.addEvent=function(t,i,e,n){t.addEventListener(i,e,!!n)},s.removeEvent=function(t,i,e,n){t.removeEventListener(i,e,!!n)},s.prefixPointerEvent=function(i){return t.MSPointerEvent?"MSPointer"+i.charAt(9).toUpperCase()+i.substr(10):i},s.momentum=function(t,i,n,s,a,o){var l,r,c=t-i,d=e.abs(c)/n;return o=void 0===o?6e-4:o,l=t+d*d/(2*o)*(0>c?-1:1),r=d/o,s>l?(l=a?s-a/2.5*(d/8):s,c=e.abs(l-t),r=c/d):l>0&&(l=a?a/2.5*(d/8):0,c=e.abs(t)+l,r=c/d),{destination:e.round(l),duration:r}};var l=n("transform");return s.extend(s,{hasTransform:l!==!1,hasPerspective:n("perspective")in a,hasTouch:"ontouchstart"in t,hasPointer:t.PointerEvent||t.MSPointerEvent,hasTransition:n("transition")in a}),s.isBadAndroid=/Android /.test(t.navigator.appVersion)&&!/Chrome\/\d/.test(t.navigator.appVersion),s.extend(s.style={},{transform:l,transitionTimingFunction:n("transitionTimingFunction"),transitionDuration:n("transitionDuration"),transitionDelay:n("transitionDelay"),transformOrigin:n("transformOrigin")}),s.hasClass=function(t,i){var e=new RegExp("(^|\\s)"+i+"(\\s|$)");return e.test(t.className)},s.addClass=function(t,i){if(!s.hasClass(t,i)){var e=t.className.split(" ");e.push(i),t.className=e.join(" ")}},s.removeClass=function(t,i){if(s.hasClass(t,i)){var e=new RegExp("(^|\\s)"+i+"(\\s|$)","g");t.className=t.className.replace(e," ")}},s.offset=function(t){for(var i=-t.offsetLeft,e=-t.offsetTop;t=t.offsetParent;)i-=t.offsetLeft,e-=t.offsetTop;return{left:i,top:e}},s.preventDefaultException=function(t,i){for(var e in i)if(i[e].test(t[e]))return!0;return!1},s.extend(s.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3}),s.extend(s.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(t){return t*(2-t)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(t){return e.sqrt(1- --t*t)}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(t){var i=4;return(t-=1)*t*((i+1)*t+i)+1}},bounce:{style:"",fn:function(t){return(t/=1)<1/2.75?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}},elastic:{style:"",fn:function(t){var i=.22,n=.4;return 0===t?0:1==t?1:n*e.pow(2,-10*t)*e.sin((t-i/4)*(2*e.PI)/i)+1}}}),s.tap=function(t,e){var n=i.createEvent("Event");n.initEvent(e,!0,!0),n.pageX=t.pageX,n.pageY=t.pageY,t.target.dispatchEvent(n)},s.click=function(t){var e,n=t.target;/(SELECT|INPUT|TEXTAREA)/i.test(n.tagName)||(e=i.createEvent("MouseEvents"),e.initMouseEvent("click",!0,!0,t.view,1,n.screenX,n.screenY,n.clientX,n.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,0,null),e._constructed=!0,n.dispatchEvent(e))},s}();n.prototype={version:"5.1.3",_init:function(){this._initEvents(),(this.options.scrollbars||this.options.indicators)&&this._initIndicators(),this.options.mouseWheel&&this._initWheel(),this.options.snap&&this._initSnap(),this.options.keyBindings&&this._initKeys()},destroy:function(){this._initEvents(!0),this._execEvent("destroy")},_transitionEnd:function(t){t.target==this.scroller&&this.isInTransition&&(this._transitionTime(),this.resetPosition(this.options.bounceTime)||(this.isInTransition=!1,this._execEvent("scrollEnd")))},_start:function(t){if((1==l.eventType[t.type]||0===t.button)&&this.enabled&&(!this.initiated||l.eventType[t.type]===this.initiated)){!this.options.preventDefault||l.isBadAndroid||l.preventDefaultException(t.target,this.options.preventDefaultException)||t.preventDefault();var i,n=t.touches?t.touches[0]:t;this.initiated=l.eventType[t.type],this.moved=!1,this.distX=0,this.distY=0,this.directionX=0,this.directionY=0,this.directionLocked=0,this._transitionTime(),this.startTime=l.getTime(),this.options.useTransition&&this.isInTransition?(this.isInTransition=!1,i=this.getComputedPosition(),this._translate(e.round(i.x),e.round(i.y)),this._execEvent("scrollEnd")):!this.options.useTransition&&this.isAnimating&&(this.isAnimating=!1,this._execEvent("scrollEnd")),this.startX=this.x,this.startY=this.y,this.absStartX=this.x,this.absStartY=this.y,this.pointX=n.pageX,this.pointY=n.pageY,this._execEvent("beforeScrollStart")}},_move:function(t){if(this.enabled&&l.eventType[t.type]===this.initiated){this.options.preventDefault&&t.preventDefault();var i,n,s,a,o=t.touches?t.touches[0]:t,r=o.pageX-this.pointX,c=o.pageY-this.pointY,d=l.getTime();if(this.pointX=o.pageX,this.pointY=o.pageY,this.distX+=r,this.distY+=c,s=e.abs(this.distX),a=e.abs(this.distY),!(d-this.endTime>300&&10>s&&10>a)){if(this.directionLocked||this.options.freeScroll||(s>a+this.options.directionLockThreshold?this.directionLocked="h":a>=s+this.options.directionLockThreshold?this.directionLocked="v":this.directionLocked="n"),"h"==this.directionLocked){if("vertical"==this.options.eventPassthrough)t.preventDefault();else if("horizontal"==this.options.eventPassthrough)return void(this.initiated=!1);c=0}else if("v"==this.directionLocked){if("horizontal"==this.options.eventPassthrough)t.preventDefault();else if("vertical"==this.options.eventPassthrough)return void(this.initiated=!1);r=0}r=this.hasHorizontalScroll?r:0,c=this.hasVerticalScroll?c:0,i=this.x+r,n=this.y+c,(i>0||i<this.maxScrollX)&&(i=this.options.bounce?this.x+r/3:i>0?0:this.maxScrollX),(n>0||n<this.maxScrollY)&&(n=this.options.bounce?this.y+c/3:n>0?0:this.maxScrollY),this.directionX=r>0?-1:0>r?1:0,this.directionY=c>0?-1:0>c?1:0,this.moved||this._execEvent("scrollStart"),this.moved=!0,this._translate(i,n),d-this.startTime>300&&(this.startTime=d,this.startX=this.x,this.startY=this.y)}}},_end:function(t){if(this.enabled&&l.eventType[t.type]===this.initiated){this.options.preventDefault&&!l.preventDefaultException(t.target,this.options.preventDefaultException)&&t.preventDefault();var i,n,s=(t.changedTouches?t.changedTouches[0]:t,l.getTime()-this.startTime),a=e.round(this.x),o=e.round(this.y),r=e.abs(a-this.startX),c=e.abs(o-this.startY),d=0,p="";if(this.isInTransition=0,this.initiated=0,this.endTime=l.getTime(),!this.resetPosition(this.options.bounceTime)){if(this.scrollTo(a,o),!this.moved)return this.options.tap&&l.tap(t,this.options.tap),this.options.click&&l.click(t),void this._execEvent("scrollCancel");if(this._events.flick&&200>s&&100>r&&100>c)return void this._execEvent("flick");if(this.options.momentum&&300>s&&(i=this.hasHorizontalScroll?l.momentum(this.x,this.startX,s,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:a,duration:0},n=this.hasVerticalScroll?l.momentum(this.y,this.startY,s,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:o,duration:0},a=i.destination,o=n.destination,d=e.max(i.duration,n.duration),this.isInTransition=1),this.options.snap){var u=this._nearestSnap(a,o);this.currentPage=u,d=this.options.snapSpeed||e.max(e.max(e.min(e.abs(a-u.x),1e3),e.min(e.abs(o-u.y),1e3)),300),a=u.x,o=u.y,this.directionX=0,this.directionY=0,p=this.options.bounceEasing}return a!=this.x||o!=this.y?((a>0||a<this.maxScrollX||o>0||o<this.maxScrollY)&&(p=l.ease.quadratic),void this.scrollTo(a,o,d,p)):void this._execEvent("scrollEnd")}}},_resize:function(){var t=this;clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){t.refresh()},this.options.resizePolling)},resetPosition:function(t){var i=this.x,e=this.y;return t=t||0,!this.hasHorizontalScroll||this.x>0?i=0:this.x<this.maxScrollX&&(i=this.maxScrollX),!this.hasVerticalScroll||this.y>0?e=0:this.y<this.maxScrollY&&(e=this.maxScrollY),i==this.x&&e==this.y?!1:(this.scrollTo(i,e,t,this.options.bounceEasing),!0)},disable:function(){this.enabled=!1},enable:function(){this.enabled=!0},refresh:function(){this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth,this.wrapperHeight=this.wrapper.clientHeight,this.scrollerWidth=this.scroller.offsetWidth,this.scrollerHeight=this.scroller.offsetHeight,this.maxScrollX=this.wrapperWidth-this.scrollerWidth,this.maxScrollY=this.wrapperHeight-this.scrollerHeight,this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0,this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0,this.hasHorizontalScroll||(this.maxScrollX=0,this.scrollerWidth=this.wrapperWidth),this.hasVerticalScroll||(this.maxScrollY=0,this.scrollerHeight=this.wrapperHeight),this.endTime=0,this.directionX=0,this.directionY=0,this.wrapperOffset=l.offset(this.wrapper),this._execEvent("refresh"),this.resetPosition()},on:function(t,i){this._events[t]||(this._events[t]=[]),this._events[t].push(i)},off:function(t,i){if(this._events[t]){var e=this._events[t].indexOf(i);e>-1&&this._events[t].splice(e,1)}},_execEvent:function(t){if(this._events[t]){var i=0,e=this._events[t].length;if(e)for(;e>i;i++)this._events[t][i].apply(this,[].slice.call(arguments,1))}},scrollBy:function(t,i,e,n){t=this.x+t,i=this.y+i,e=e||0,this.scrollTo(t,i,e,n)},scrollTo:function(t,i,e,n){n=n||l.ease.circular,this.isInTransition=this.options.useTransition&&e>0,!e||this.options.useTransition&&n.style?(this._transitionTimingFunction(n.style),this._transitionTime(e),this._translate(t,i)):this._animate(t,i,e,n.fn)},scrollToElement:function(t,i,n,s,a){if(t=t.nodeType?t:this.scroller.querySelector(t)){var o=l.offset(t);o.left-=this.wrapperOffset.left,o.top-=this.wrapperOffset.top,n===!0&&(n=e.round(t.offsetWidth/2-this.wrapper.offsetWidth/2)),s===!0&&(s=e.round(t.offsetHeight/2-this.wrapper.offsetHeight/2)),o.left-=n||0,o.top-=s||0,o.left=o.left>0?0:o.left<this.maxScrollX?this.maxScrollX:o.left,o.top=o.top>0?0:o.top<this.maxScrollY?this.maxScrollY:o.top,i=void 0===i||null===i||"auto"===i?e.max(e.abs(this.x-o.left),e.abs(this.y-o.top)):i,this.scrollTo(o.left,o.top,i,a)}},_transitionTime:function(t){if(t=t||0,this.scrollerStyle[l.style.transitionDuration]=t+"ms",!t&&l.isBadAndroid&&(this.scrollerStyle[l.style.transitionDuration]="0.001s"),this.indicators)for(var i=this.indicators.length;i--;)this.indicators[i].transitionTime(t)},_transitionTimingFunction:function(t){if(this.scrollerStyle[l.style.transitionTimingFunction]=t,this.indicators)for(var i=this.indicators.length;i--;)this.indicators[i].transitionTimingFunction(t)},_translate:function(t,i){if(this.options.useTransform?this.scrollerStyle[l.style.transform]="translate("+t+"px,"+i+"px)"+this.translateZ:(t=e.round(t),i=e.round(i),this.scrollerStyle.left=t+"px",this.scrollerStyle.top=i+"px"),this.x=t,this.y=i,this.indicators)for(var n=this.indicators.length;n--;)this.indicators[n].updatePosition()},_initEvents:function(i){var e=i?l.removeEvent:l.addEvent,n=this.options.bindToWrapper?this.wrapper:t;e(t,"orientationchange",this),e(t,"resize",this),this.options.click&&e(this.wrapper,"click",this,!0),this.options.disableMouse||(e(this.wrapper,"mousedown",this),e(n,"mousemove",this),e(n,"mousecancel",this),e(n,"mouseup",this)),l.hasPointer&&!this.options.disablePointer&&(e(this.wrapper,l.prefixPointerEvent("pointerdown"),this),e(n,l.prefixPointerEvent("pointermove"),this),e(n,l.prefixPointerEvent("pointercancel"),this),e(n,l.prefixPointerEvent("pointerup"),this)),l.hasTouch&&!this.options.disableTouch&&(e(this.wrapper,"touchstart",this),e(n,"touchmove",this),e(n,"touchcancel",this),e(n,"touchend",this)),e(this.scroller,"transitionend",this),e(this.scroller,"webkitTransitionEnd",this),e(this.scroller,"oTransitionEnd",this),e(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var i,e,n=t.getComputedStyle(this.scroller,null);return this.options.useTransform?(n=n[l.style.transform].split(")")[0].split(", "),i=+(n[12]||n[4]),e=+(n[13]||n[5])):(i=+n.left.replace(/[^-\d.]/g,""),e=+n.top.replace(/[^-\d.]/g,"")),{x:i,y:e}},_initIndicators:function(){function t(t){for(var i=l.indicators.length;i--;)t.call(l.indicators[i])}var i,e=this.options.interactiveScrollbars,n="string"!=typeof this.options.scrollbars,o=[],l=this;this.indicators=[],this.options.scrollbars&&(this.options.scrollY&&(i={el:s("v",e,this.options.scrollbars),interactive:e,defaultScrollbars:!0,customStyle:n,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenX:!1},this.wrapper.appendChild(i.el),o.push(i)),this.options.scrollX&&(i={el:s("h",e,this.options.scrollbars),interactive:e,defaultScrollbars:!0,customStyle:n,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenY:!1},this.wrapper.appendChild(i.el),o.push(i))),this.options.indicators&&(o=o.concat(this.options.indicators));for(var r=o.length;r--;)this.indicators.push(new a(this,o[r]));this.options.fadeScrollbars&&(this.on("scrollEnd",function(){t(function(){this.fade()})}),this.on("scrollCancel",function(){t(function(){this.fade()})}),this.on("scrollStart",function(){t(function(){this.fade(1)})}),this.on("beforeScrollStart",function(){t(function(){this.fade(1,!0)})})),this.on("refresh",function(){t(function(){this.refresh()})}),this.on("destroy",function(){t(function(){this.destroy()}),delete this.indicators})},_initWheel:function(){l.addEvent(this.wrapper,"wheel",this),l.addEvent(this.wrapper,"mousewheel",this),l.addEvent(this.wrapper,"DOMMouseScroll",this),this.on("destroy",function(){l.removeEvent(this.wrapper,"wheel",this),l.removeEvent(this.wrapper,"mousewheel",this),l.removeEvent(this.wrapper,"DOMMouseScroll",this)})},_wheel:function(t){if(this.enabled){t.preventDefault(),t.stopPropagation();var i,n,s,a,o=this;if(void 0===this.wheelTimeout&&o._execEvent("scrollStart"),clearTimeout(this.wheelTimeout),this.wheelTimeout=setTimeout(function(){o._execEvent("scrollEnd"),o.wheelTimeout=void 0},400),"deltaX"in t)1===t.deltaMode?(i=-t.deltaX*this.options.mouseWheelSpeed,n=-t.deltaY*this.options.mouseWheelSpeed):(i=-t.deltaX,n=-t.deltaY);else if("wheelDeltaX"in t)i=t.wheelDeltaX/120*this.options.mouseWheelSpeed,n=t.wheelDeltaY/120*this.options.mouseWheelSpeed;else if("wheelDelta"in t)i=n=t.wheelDelta/120*this.options.mouseWheelSpeed;else{if(!("detail"in t))return;i=n=-t.detail/3*this.options.mouseWheelSpeed}if(i*=this.options.invertWheelDirection,n*=this.options.invertWheelDirection,this.hasVerticalScroll||(i=n,n=0),this.options.snap)return s=this.currentPage.pageX,a=this.currentPage.pageY,i>0?s--:0>i&&s++,n>0?a--:0>n&&a++,void this.goToPage(s,a);s=this.x+e.round(this.hasHorizontalScroll?i:0),a=this.y+e.round(this.hasVerticalScroll?n:0),s>0?s=0:s<this.maxScrollX&&(s=this.maxScrollX),a>0?a=0:a<this.maxScrollY&&(a=this.maxScrollY),this.scrollTo(s,a,0)}},_initSnap:function(){this.currentPage={},"string"==typeof this.options.snap&&(this.options.snap=this.scroller.querySelectorAll(this.options.snap)),this.on("refresh",function(){var t,i,n,s,a,o,l=0,r=0,c=0,d=this.options.snapStepX||this.wrapperWidth,p=this.options.snapStepY||this.wrapperHeight;if(this.pages=[],this.wrapperWidth&&this.wrapperHeight&&this.scrollerWidth&&this.scrollerHeight){if(this.options.snap===!0)for(n=e.round(d/2),s=e.round(p/2);c>-this.scrollerWidth;){for(this.pages[l]=[],t=0,a=0;a>-this.scrollerHeight;)this.pages[l][t]={x:e.max(c,this.maxScrollX),y:e.max(a,this.maxScrollY),width:d,height:p,cx:c-n,cy:a-s},a-=p,t++;c-=d,l++}else for(o=this.options.snap,t=o.length,i=-1;t>l;l++)(0===l||o[l].offsetLeft<=o[l-1].offsetLeft)&&(r=0,i++),this.pages[r]||(this.pages[r]=[]),c=e.max(-o[l].offsetLeft,this.maxScrollX),a=e.max(-o[l].offsetTop,this.maxScrollY),n=c-e.round(o[l].offsetWidth/2),s=a-e.round(o[l].offsetHeight/2),this.pages[r][i]={x:c,y:a,width:o[l].offsetWidth,height:o[l].offsetHeight,cx:n,cy:s},c>this.maxScrollX&&r++;this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0),this.options.snapThreshold%1===0?(this.snapThresholdX=this.options.snapThreshold,this.snapThresholdY=this.options.snapThreshold):(this.snapThresholdX=e.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold),this.snapThresholdY=e.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold))}}),this.on("flick",function(){var t=this.options.snapSpeed||e.max(e.max(e.min(e.abs(this.x-this.startX),1e3),e.min(e.abs(this.y-this.startY),1e3)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,t)})},_nearestSnap:function(t,i){if(!this.pages.length)return{x:0,y:0,pageX:0,pageY:0};var n=0,s=this.pages.length,a=0;if(e.abs(t-this.absStartX)<this.snapThresholdX&&e.abs(i-this.absStartY)<this.snapThresholdY)return this.currentPage;for(t>0?t=0:t<this.maxScrollX&&(t=this.maxScrollX),i>0?i=0:i<this.maxScrollY&&(i=this.maxScrollY);s>n;n++)if(t>=this.pages[n][0].cx){t=this.pages[n][0].x;break}for(s=this.pages[n].length;s>a;a++)if(i>=this.pages[0][a].cy){i=this.pages[0][a].y;break}return n==this.currentPage.pageX&&(n+=this.directionX,0>n?n=0:n>=this.pages.length&&(n=this.pages.length-1),t=this.pages[n][0].x),a==this.currentPage.pageY&&(a+=this.directionY,0>a?a=0:a>=this.pages[0].length&&(a=this.pages[0].length-1),i=this.pages[0][a].y),{x:t,y:i,pageX:n,pageY:a}},goToPage:function(t,i,n,s){s=s||this.options.bounceEasing,t>=this.pages.length?t=this.pages.length-1:0>t&&(t=0),i>=this.pages[t].length?i=this.pages[t].length-1:0>i&&(i=0);var a=this.pages[t][i].x,o=this.pages[t][i].y;n=void 0===n?this.options.snapSpeed||e.max(e.max(e.min(e.abs(a-this.x),1e3),e.min(e.abs(o-this.y),1e3)),300):n,this.currentPage={x:a,y:o,pageX:t,pageY:i},this.scrollTo(a,o,n,s)},next:function(t,i){var e=this.currentPage.pageX,n=this.currentPage.pageY;e++,e>=this.pages.length&&this.hasVerticalScroll&&(e=0,n++),this.goToPage(e,n,t,i)},prev:function(t,i){var e=this.currentPage.pageX,n=this.currentPage.pageY;e--,0>e&&this.hasVerticalScroll&&(e=0,n--),this.goToPage(e,n,t,i)},_initKeys:function(i){var e,n={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40};if("object"==typeof this.options.keyBindings)for(e in this.options.keyBindings)"string"==typeof this.options.keyBindings[e]&&(this.options.keyBindings[e]=this.options.keyBindings[e].toUpperCase().charCodeAt(0));else this.options.keyBindings={};for(e in n)this.options.keyBindings[e]=this.options.keyBindings[e]||n[e];l.addEvent(t,"keydown",this),this.on("destroy",function(){l.removeEvent(t,"keydown",this)})},_key:function(t){if(this.enabled){var i,n=this.options.snap,s=n?this.currentPage.pageX:this.x,a=n?this.currentPage.pageY:this.y,o=l.getTime(),r=this.keyTime||0,c=.25;switch(this.options.useTransition&&this.isInTransition&&(i=this.getComputedPosition(),this._translate(e.round(i.x),e.round(i.y)),this.isInTransition=!1),this.keyAcceleration=200>o-r?e.min(this.keyAcceleration+c,50):0,t.keyCode){case this.options.keyBindings.pageUp:this.hasHorizontalScroll&&!this.hasVerticalScroll?s+=n?1:this.wrapperWidth:a+=n?1:this.wrapperHeight;break;case this.options.keyBindings.pageDown:this.hasHorizontalScroll&&!this.hasVerticalScroll?s-=n?1:this.wrapperWidth:a-=n?1:this.wrapperHeight;break;case this.options.keyBindings.end:s=n?this.pages.length-1:this.maxScrollX,a=n?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:s=0,a=0;break;case this.options.keyBindings.left:s+=n?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:a+=n?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:s-=n?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:a-=n?1:5+this.keyAcceleration>>0;break;default:return}if(n)return void this.goToPage(s,a);s>0?(s=0,this.keyAcceleration=0):s<this.maxScrollX&&(s=this.maxScrollX,this.keyAcceleration=0),a>0?(a=0,this.keyAcceleration=0):a<this.maxScrollY&&(a=this.maxScrollY,this.keyAcceleration=0),this.scrollTo(s,a,0),this.keyTime=o}},_animate:function(t,i,e,n){function s(){var u,m,h,g=l.getTime();return g>=p?(a.isAnimating=!1,a._translate(t,i),void(a.resetPosition(a.options.bounceTime)||a._execEvent("scrollEnd"))):(g=(g-d)/e,h=n(g),u=(t-r)*h+r,m=(i-c)*h+c,a._translate(u,m),void(a.isAnimating&&o(s)))}var a=this,r=this.x,c=this.y,d=l.getTime(),p=d+e;this.isAnimating=!0,s()},handleEvent:function(t){switch(t.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(t);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(t);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(t);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(t);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(t);break;case"keydown":this._key(t);break;case"click":t._constructed||(t.preventDefault(),t.stopPropagation())}}},a.prototype={handleEvent:function(t){switch(t.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(t);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(t);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(t)}},destroy:function(){this.options.interactive&&(l.removeEvent(this.indicator,"touchstart",this),l.removeEvent(this.indicator,l.prefixPointerEvent("pointerdown"),this),l.removeEvent(this.indicator,"mousedown",this),l.removeEvent(t,"touchmove",this),l.removeEvent(t,l.prefixPointerEvent("pointermove"),this),l.removeEvent(t,"mousemove",this),l.removeEvent(t,"touchend",this),l.removeEvent(t,l.prefixPointerEvent("pointerup"),this),l.removeEvent(t,"mouseup",this)),this.options.defaultScrollbars&&this.wrapper.parentNode.removeChild(this.wrapper)},_start:function(i){var e=i.touches?i.touches[0]:i;i.preventDefault(),i.stopPropagation(),this.transitionTime(),this.initiated=!0,this.moved=!1,this.lastPointX=e.pageX,this.lastPointY=e.pageY,this.startTime=l.getTime(),this.options.disableTouch||l.addEvent(t,"touchmove",this),this.options.disablePointer||l.addEvent(t,l.prefixPointerEvent("pointermove"),this),this.options.disableMouse||l.addEvent(t,"mousemove",this),this.scroller._execEvent("beforeScrollStart")},_move:function(t){var i,e,n,s,a=t.touches?t.touches[0]:t;l.getTime();this.moved||this.scroller._execEvent("scrollStart"),this.moved=!0,i=a.pageX-this.lastPointX,this.lastPointX=a.pageX,e=a.pageY-this.lastPointY,this.lastPointY=a.pageY,n=this.x+i,s=this.y+e,this._pos(n,s),t.preventDefault(),t.stopPropagation()},_end:function(i){if(this.initiated){if(this.initiated=!1,i.preventDefault(),i.stopPropagation(),l.removeEvent(t,"touchmove",this),l.removeEvent(t,l.prefixPointerEvent("pointermove"),this),l.removeEvent(t,"mousemove",this),this.scroller.options.snap){var n=this.scroller._nearestSnap(this.scroller.x,this.scroller.y),s=this.options.snapSpeed||e.max(e.max(e.min(e.abs(this.scroller.x-n.x),1e3),e.min(e.abs(this.scroller.y-n.y),1e3)),300);(this.scroller.x!=n.x||this.scroller.y!=n.y)&&(this.scroller.directionX=0,this.scroller.directionY=0,this.scroller.currentPage=n,this.scroller.scrollTo(n.x,n.y,s,this.scroller.options.bounceEasing))}this.moved&&this.scroller._execEvent("scrollEnd")}},transitionTime:function(t){t=t||0,this.indicatorStyle[l.style.transitionDuration]=t+"ms",!t&&l.isBadAndroid&&(this.indicatorStyle[l.style.transitionDuration]="0.001s")},transitionTimingFunction:function(t){this.indicatorStyle[l.style.transitionTimingFunction]=t},refresh:function(){this.transitionTime(),this.options.listenX&&!this.options.listenY?this.indicatorStyle.display=this.scroller.hasHorizontalScroll?"block":"none":this.options.listenY&&!this.options.listenX?this.indicatorStyle.display=this.scroller.hasVerticalScroll?"block":"none":this.indicatorStyle.display=this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?"block":"none",this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll?(l.addClass(this.wrapper,"iScrollBothScrollbars"),l.removeClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="8px":this.wrapper.style.bottom="8px")):(l.removeClass(this.wrapper,"iScrollBothScrollbars"),l.addClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="2px":this.wrapper.style.bottom="2px"));this.wrapper.offsetHeight;this.options.listenX&&(this.wrapperWidth=this.wrapper.clientWidth,this.options.resize?(this.indicatorWidth=e.max(e.round(this.wrapperWidth*this.wrapperWidth/(this.scroller.scrollerWidth||this.wrapperWidth||1)),8),this.indicatorStyle.width=this.indicatorWidth+"px"):this.indicatorWidth=this.indicator.clientWidth,this.maxPosX=this.wrapperWidth-this.indicatorWidth,"clip"==this.options.shrink?(this.minBoundaryX=-this.indicatorWidth+8,this.maxBoundaryX=this.wrapperWidth-8):(this.minBoundaryX=0,this.maxBoundaryX=this.maxPosX),this.sizeRatioX=this.options.speedRatioX||this.scroller.maxScrollX&&this.maxPosX/this.scroller.maxScrollX),this.options.listenY&&(this.wrapperHeight=this.wrapper.clientHeight,this.options.resize?(this.indicatorHeight=e.max(e.round(this.wrapperHeight*this.wrapperHeight/(this.scroller.scrollerHeight||this.wrapperHeight||1)),8),this.indicatorStyle.height=this.indicatorHeight+"px"):this.indicatorHeight=this.indicator.clientHeight,this.maxPosY=this.wrapperHeight-this.indicatorHeight,"clip"==this.options.shrink?(this.minBoundaryY=-this.indicatorHeight+8,this.maxBoundaryY=this.wrapperHeight-8):(this.minBoundaryY=0,this.maxBoundaryY=this.maxPosY),this.maxPosY=this.wrapperHeight-this.indicatorHeight,this.sizeRatioY=this.options.speedRatioY||this.scroller.maxScrollY&&this.maxPosY/this.scroller.maxScrollY),this.updatePosition()},updatePosition:function(){var t=this.options.listenX&&e.round(this.sizeRatioX*this.scroller.x)||0,i=this.options.listenY&&e.round(this.sizeRatioY*this.scroller.y)||0;this.options.ignoreBoundaries||(t<this.minBoundaryX?("scale"==this.options.shrink&&(this.width=e.max(this.indicatorWidth+t,8),this.indicatorStyle.width=this.width+"px"),t=this.minBoundaryX):t>this.maxBoundaryX?"scale"==this.options.shrink?(this.width=e.max(this.indicatorWidth-(t-this.maxPosX),8),this.indicatorStyle.width=this.width+"px",t=this.maxPosX+this.indicatorWidth-this.width):t=this.maxBoundaryX:"scale"==this.options.shrink&&this.width!=this.indicatorWidth&&(this.width=this.indicatorWidth,this.indicatorStyle.width=this.width+"px"),i<this.minBoundaryY?("scale"==this.options.shrink&&(this.height=e.max(this.indicatorHeight+3*i,8),this.indicatorStyle.height=this.height+"px"),i=this.minBoundaryY):i>this.maxBoundaryY?"scale"==this.options.shrink?(this.height=e.max(this.indicatorHeight-3*(i-this.maxPosY),8),this.indicatorStyle.height=this.height+"px",i=this.maxPosY+this.indicatorHeight-this.height):i=this.maxBoundaryY:"scale"==this.options.shrink&&this.height!=this.indicatorHeight&&(this.height=this.indicatorHeight,this.indicatorStyle.height=this.height+"px")),this.x=t,this.y=i,this.scroller.options.useTransform?this.indicatorStyle[l.style.transform]="translate("+t+"px,"+i+"px)"+this.scroller.translateZ:(this.indicatorStyle.left=t+"px",this.indicatorStyle.top=i+"px")},_pos:function(t,i){0>t?t=0:t>this.maxPosX&&(t=this.maxPosX),0>i?i=0:i>this.maxPosY&&(i=this.maxPosY),t=this.options.listenX?e.round(t/this.sizeRatioX):this.scroller.x,i=this.options.listenY?e.round(i/this.sizeRatioY):this.scroller.y,this.scroller.scrollTo(t,i)},fade:function(t,i){if(!i||this.visible){clearTimeout(this.fadeTimeout),this.fadeTimeout=null;var e=t?250:500,n=t?0:300;t=t?"1":"0",this.wrapperStyle[l.style.transitionDuration]=e+"ms",this.fadeTimeout=setTimeout(function(t){this.wrapperStyle.opacity=t,this.visible=+t}.bind(this,t),n)}}},n.utils=l,"undefined"!=typeof module&&module.exports?module.exports=n:t.IScroll=n}(window,document,Math),define("iscroll",function(){}),define("text!components/modules/tag_list/tpl.html",[],function(){return'{{var window_width=document.body.clientWidth-114,item_height=\'auto\';}}\n<section>\n	<div class="list-container clearfix">\n		<div id="rootList" class="cate-list" style="height: {{=it.pageHeight}}px; overflow:hidden;">\n			<div style="overflow: hidden;">\n				{{? it }}\n				<ul class="ul-height">\n					{{~it.nav_list:value:index}}\n					<li class="liDefault {{=index}}">\n						<a href="javascript:void(0);" class="js-change-cate currentT{{=index}}" data-index="{{=index}}">{{=value.title}}</a>\n					</li>\n					{{~}}\n				</ul>\n				{{?}}\n			</div>\n		</div>\n		<div class="js-info-container">\n			<div class="wb-category-content">\n				<div id="branchScroll" class="wb-category-content-wrapper" >\n					<div id="branchList">\n						{{?it}}\n						{{~it.nav_list:value:indexs}}\n						<div class="wb-category-div tag-list modules-slide current{{=indexs}}" data-tag-index={{=indexs}}>\n							{{?value.imgstyle<4}}\n							<div class="image-list style{{=value.imgstyle}}">\n								<ul class="clearfix">\n									{{?value.imgstyle > 1}}\n									{{for(var i = 0;i < value.imgstyle;i++){}}\n									<li>\n										{{for(var j = i;j< value.img_list.length;j = j + value.imgstyle){}}\n										{{?value.img_list[j]}}\n										<a {{?(j < value.img_list.length - 2)}}style="padding-bottom: 8px;" {{?}}href="{{=value.img_list[j].link_url||\'javacript:void(0)\'}}"><img class="lazy" data-original="{{=_global.url.ms+value.img_list[j].img}}?imageMogr2/thumbnail/640x"  alt="{{=value.img_list[j].title||\'\'}}">\n											{{?value.img_list[j].title}}<p>{{=value.img_list[j].title}}</p>{{?}}\n										</a>\n										{{?}}\n										{{}}}\n									</li>\n									{{}}}\n									{{??}}\n									{{~value.img_list:valueson:index}}\n									<li>\n										<a href="{{=valueson.link_url||\'javacript:void(0)\'}}"><img class="lazy" data-original="{{=_global.url.ms+valueson.img}}?imageMogr2/thumbnail/640x"  alt="{{=valueson.title||\'\'}}">\n											{{?valueson.title}}<p>{{=valueson.title}}</p>{{?}}\n										</a>\n									</li>\n									{{~}}\n									{{?}}\n								</ul>\n							</div>\n							{{?}}\n\n							{{?value.imgstyle==4}}\n							{{ var ad_w1=(window_width-24)/2;}}\n							<div class="image-ad clearfix images-tpl">\n								<div>\n									{{?value.img_list[0]}}<a href="{{=value.img_list[0].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w1}}px;height:{{=(ad_w1+8)}}px;"><img class="lazy" data-original="{{=_global.url.ms+value.img_list[0].img}}?imageMogr2/thumbnail/640x"  alt="{{=value.img_list[0].title||\'\'}}"></a>{{?}}\n								</div>\n								<div>\n									{{?value.img_list[1]}}<a href="{{=value.img_list[1].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w1}}px;height:{{=(ad_w1/2)}}px;"><img class="lazy" data-original="{{=_global.url.ms+value.img_list[1].img}}?imageMogr2/thumbnail/640x"  alt="{{=value.img_list[1].title||\'\'}}"></a>{{?}}\n									{{?value.img_list[2]}}<a href="{{=value.img_list[2].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w1}}px;height:{{=(ad_w1/2)}}px;"><img class="lazy" data-original="{{=_global.url.ms+value.img_list[2].img}}?imageMogr2/thumbnail/640x"  alt="{{=value.img_list[2].title||\'\'}}"></a>{{?}}\n								</div>\n							</div>\n							{{?}}\n							{{?value.imgstyle==5}}\n							{{var ad_w2=(window_width-24)/3;}}\n							<div class="image-ad2 clearfix images-tpl">\n								<div class="clearfix">\n									{{?value.img_list[0]}}<a href="{{=value.img_list[0].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w2}}px;height:{{=ad_w2}}px;"><img class="lazy" data-original="{{=_global.url.ms+value.img_list[0].img}}?imageMogr2/thumbnail/640x"  alt="{{=value.img_list[0].title||\'\'}}"></a>{{?}}\n									{{?value.img_list[1]}}<a href="{{=value.img_list[1].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w2*2}}px;height:{{=ad_w2}}px"><img class="lazy" data-original="{{=_global.url.ms+value.img_list[1].img}}?imageMogr2/thumbnail/640x"  alt="{{=value.img_list[1].title||\'\'}}"></a>{{?}}\n								</div>\n								<div class="clearfix">\n									{{?value.img_list[2]}}<a href="{{=value.img_list[2].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w2*2}}px;height:{{=ad_w2}}px"><img class="lazy" data-original="{{=_global.url.ms+value.img_list[2].img}}?imageMogr2/thumbnail/640x"  alt="{{=value.img_list[2].title||\'\'}}"></a>{{?}}\n									{{?value.img_list[3]}}<a href="{{=value.img_list[3].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w2}}px;height:{{=ad_w2}}px;"><img class="lazy" data-original="{{=_global.url.ms+value.img_list[3].img}}?imageMogr2/thumbnail/640x"  alt="{{=value.img_list[3].title||\'\'}}"></a>{{?}}\n								</div>\n							</div>\n							{{?}}\n							{{?value.imgstyle==6}}\n							{{var ad_w3=(window_width-24)/2;}}\n							<div class="image-ad3 clearfix images-tpl">\n								<div>\n									{{?value.img_list[0]}}<a href="{{=value.img_list[0].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w3}}px;height:{{=(ad_w3/2)}}px;"><img class="lazy" data-original="{{=_global.url.ms+value.img_list[0].img}}?imageMogr2/thumbnail/640x"  alt="{{=value.img_list[0].title||\'\'}}"></a>{{?}}\n									{{?value.img_list[1]}}<a href="{{=value.img_list[1].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w3}}px;height:{{=ad_w3}}px;"><img class="lazy" data-original="{{=_global.url.ms+value.img_list[1].img}}?imageMogr2/thumbnail/640x"  alt="{{=value.img_list[1].title||\'\'}}"></a>{{?}}\n								</div>\n								<div>\n									{{?value.img_list[2]}}<a href="{{=value.img_list[2].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w3}}px;height:{{=ad_w3}}px;"><img class="lazy" data-original="{{=_global.url.ms+value.img_list[2].img}}?imageMogr2/thumbnail/640x"  alt="{{=value.img_list[2].title}}"></a>{{?}}\n									{{?value.img_list[3]}}<a href="{{=value.img_list[3].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w3}}px;height:{{=(ad_w3/2)}}px;"><img class="lazy" data-original="{{=_global.url.ms+value.img_list[3].img}}?imageMogr2/thumbnail/640x"  alt="{{=value.img_list[3].title}}"></a>{{?}}\n								</div>\n							</div>\n							{{?}}\n							{{?value.imgstyle==7}}\n							{{ var ad_w4=(window_width-32)/3;}}\n							<div listorder="5" class="image-ad4 clearfix images-tpl">\n								<div>\n									{{?value.img_list[0]}}<a href="{{=value.img_list[0].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w4}}px;height:{{=ad_w4}}px;"><img class="lazy" data-original="{{=_global.url.ms+value.img_list[0].img}}?imageMogr2/thumbnail/640x"  alt="{{=value.img_list[0].title||\'\'}}"></a>{{?}}\n									{{?value.img_list[1]}}<a href="{{=value.img_list[1].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w4}}px;height:{{=ad_w4}}px;"><img class="lazy" data-original="{{=_global.url.ms+value.img_list[1].img}}?imageMogr2/thumbnail/640x"  alt="{{=value.img_list[1].title||\'\'}}"></a>{{?}}\n								</div>\n								<div>\n									{{?value.img_list[2]}}<a href="{{=value.img_list[2].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w4}}px;height:{{=ad_w4}}px;"><img class="lazy" data-original="{{=_global.url.ms+value.img_list[2].img}}?imageMogr2/thumbnail/640x"  alt="{{=value.img_list[2].title||\'\'}}"></a>{{?}}\n									{{?value.img_list[3]}}<a href="{{=value.img_list[3].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w4}}px;height:{{=ad_w4}}px;"><img class="lazy" data-original="{{=_global.url.ms+value.img_list[3].img}}?imageMogr2/thumbnail/640x"  alt="{{=value.img_list[3].title}}"></a>{{?}}\n								</div>\n								<div>\n									{{?value.img_list[4]}}<a href="{{=value.img_list[4].link_url||\'javacript:void(0)\'}}" style="width:{{=ad_w4}}px;height:{{=ad_w4*2+8}}px;"><img class="lazy" data-original="{{=_global.url.ms+value.img_list[4].img}}?imageMogr2/thumbnail/640x"  alt="{{=value.img_list[4].title||\'\'}}"></a>{{?}}\n								</div>\n							</div>\n							{{?}}\n\n							{{?value.imgstyle==8}}\n							<div class="swiper-container swiper-img">\n								<div class="swiper-wrapper">\n									{{~value.img_list:valueimg:index}}\n									<div class="swiper-slide">\n										<a href="{{=valueimg.link_url||\'javacript:void(0)\'}}">\n											<img class="swiper-lazy" data-src="{{=_global.url.ms+valueimg.img}}?imageMogr2/thumbnail/640x" >\n										</a>\n										{{?valueimg.title}}<div class="title">{{=valueimg.title}}</div>{{?}}\n									</div>\n									{{~}}\n								</div>\n								<div class="swiper-pagination"></div>\n							</div>\n							{{?}}\n\n							<ul class="wb-category-style-1">\n								{{~value.item_list:valueson:index}}\n								<li>\n									<a class="J_ping" href="{{=valueson.link_url||\'javascript:void(0)\'}}" data-id="{{=valueson.id}}">\n										{{?valueson.img}}\n										<img src="{{=_global.url.ms+valueson.img}}" style="width:{{=value.icon_size}}px; height:{{=value.icon_size}}px;" />\n										{{?}}\n										<span>{{=valueson.title}}</span>\n									</a>\n								</li>\n								{{~}}\n							</ul>\n						</div>\n						{{~}}\n						{{?}}\n					</div>\n				</div>\n			</div>\n		</div>\n	</div>\n</section>';
}),define("components/modules/tag_list/view",["backbone","doT","iscroll","text!components/modules/tag_list/tpl.html","Swiper","lazyLoad"],function(t,i,e,n,s,a){return t.View.extend({template:i.template(n),events:{"click .js-change-cate":"changeCate"},initialize:function(){},render:function(){var t=this.model.nav_list.length;return this.model.nev_len=$(window).width()/t,"0"==this.model.pageHeightType&&(this.model.pageHeight=$(window).height()),console.log(this.model.nav_list[2].imgstyle),this.$el.html(this.template(this.model)),8==this.model.nav_list[2].imgstyle&&this.$el.find(".swiper-container").swiper({loop:!0,pagination:$(".swiper-pagination",this.$el)[0],autoplay:3500,autoplayDisableOnInteraction:!1,preloadImages:!0,lazyLoading:!0}),$("img.lazy",this.$el).lazyload(),$(".liDefault:first").addClass("cur"),$(".tag-list:first").addClass("active"),$(".swiper-img:first").addClass("active"),$(".liDefault").on("click",function(){$(".liDefault").removeClass("cur"),$(this).addClass("cur")}),this.getHeight(),this.loaded(),this},changeCate:function(t){this.model.nav_list;this.getHeight();var i=$(t.currentTarget).attr("data-index");$(".current"+i).addClass("active").siblings().removeClass("active"),this.loadRight()},loaded:function(){setTimeout(function(){if(/iPhone|iPad|iPod|Macintosh/i.test(navigator.userAgent)){new IScroll("#rootList"),new IScroll("#branchScroll")}else{new IScroll("#rootList",{click:!0}),new IScroll("#branchScroll",{click:!0})}},300)},loadRight:function(){setTimeout(function(){if(/iPhone|iPad|iPod|Macintosh/i.test(navigator.userAgent)){new IScroll("#branchScroll")}else{new IScroll("#branchScroll",{click:!0})}},300)},getHeight:function(){$("#branchScroll").css({height:this.model.pageHeight}),$("#rootList").css({"max-height":this.model.pageHeight})}})}),define("components/modules/modules",["components/modules/slide/view","components/modules/text/view","components/modules/banner/view","components/modules/goods/view","components/modules/nav/view","components/modules/search/view","components/modules/notice/view","components/modules/goods_tag/view","components/modules/phone/view","components/modules/video/view","components/modules/image/view","components/modules/white/view","components/modules/title/view","components/modules/guider_nav/view","components/modules/guider_banner/view","components/modules/guider_apply/view","components/modules/guider_text/view","components/modules/scene/view","components/modules/voice/view","components/modules/snatch_nav/view","components/modules/snatch_goods/view","components/modules/partner_banner/view","components/modules/partner_apply/view","components/modules/partner_intro/view","components/modules/partner_head/view","components/modules/partner_account/view","components/modules/partner_navs/view","components/modules/collect_list/view","components/modules/credit_head/view","components/modules/credit_goods/view","components/modules/team_head/view","components/modules/team_navs/view","components/modules/tag_list/view"],function(){}),define("apps/goods/views/main",["backbone","doT","Swiper","lazyLoad","components/top_bar/view","components/aside/view","apps/goods/models/goods","apps/goods/views/prop","apps/goods/views/comments","apps/goods/views/records","apps/goods/views/bargain/bargain_share","apps/goods/views/bargain/bargain_list","apps/goods/views/bargain/bargain_main","apps/goods/views/bargain/bargain_footer_view","apps/goods/views/seckill/seckill_main","apps/goods/views/seckill/seckill_footer_view","apps/goods/views/bangmian/bangmian_main","apps/goods/views/bangmian/bangmian_footer_view","components/cart/views/main","components/cart/views/pintuan_main","text!apps/goods/templates/main.html","apps/goods/views/auction/auction","text!apps/goods/templates/auction/auctionTpl.html","apps/goods/views/auction/auction_footer_view","text!apps/goods/templates/act_bar.html","text!apps/goods/templates/goods_info.html","text!apps/goods/templates/pintuan/pintuanTpl.html","components/footer/view","components/modules/modules"],function(t,i,e,n,a,o,l,r,c,p,u,g,v,f,b,_,y,w,x,k,j,S,T,z,M,C,P,I){var D=$("#views");return t.View.extend({id:"view-goods",className:"page-view view-goods",template:i.template(j),goodsInfoTemplate:i.template(C),events:{"click .js-tab":"tab","click .js-open-cart":"openSku","click .js-kt":"rxgSku","click .swiper-goods-list-img":"showGoodsImg","click .shop-server":"showShopServer","click .goods-component-imgs":"showGoodsComponentImgs"},initialize:function(){this.model=new l,$(".page-view",D).removeClass("active"),$("#view-goods")[0]&&$("#view-goods").remove(),D.append(this.$el)},render:function(t){var e=this;return t.bargain_initiate_id?this.model.set({id:t.id,bargain_initiate_id:t.bargain_initiate_id}):t.bangmian_initiate_id?this.model.set({id:t.id,bangmian_initiate_id:t.bangmian_initiate_id}):this.model.set({id:t.id}),this.model.fetch({success:function(n,s,l){if($.loading("hide"),$.setTitle(e.model.get("title")),$.setForward({title:e.model.get("title"),desc:e.model.get("intro")||"商品详情",link:window.location.href,imgUrl:_global.url.ms+e.model.get("img")+"?imageMogr2/thumbnail/640x/interlace/1"}),e.$el.html(e.template(e.model.toJSON())).addClass("active"),$.localStorage()&&e.setHistory(e.model.toJSON()),$(".top-bar",this.$el).html((new a).render().$el),e.model.get("imgs").length>1)$(".swiper-container",e.$el).swiper({loop:!0,pagination:$(".swiper-pagination",this.$el),autoplay:3500,preloadImages:!0,lazyLoading:!0});else{var r=$(".swiper-container .swiper-lazy",e.$el).attr("data-src");$(".swiper-container .swiper-lazy",e.$el).attr("src",r),$(".swiper-lazy-preloader",e.$el).remove()}e.renderComponent();var c=i.template(M);switch($(".bottom-bar",e.$el).html(c({id:t.id,onsale:s.onsale,is_virtual:s.is_virtual})),e.model.get("ump").alone.type){case"bargain":e.renderBargain(s);break;case"pintuan":0==e.model.get("ump").alone.data.is_pintuan&&0==e.model.get("ump").alone.data.is_presale||e.renderPintuan(s);break;case"seckill":if(e.model.get("ump").alone.data.status&&0!=e.model.get("ump").alone.data.status){e.renderSeckill(s);break}case"bangmian":e.renderBangmian(s);break;case"auction":e.renderauction(s);break;default:e.$el.append((new I).render().$el)}e.$el.append(new o(t.id).render({type:"goods"}).$el)},error:function(){$.loading("hide"),$.setTitle("没有找到该商品"),e.$el.html("没有找到该商品").addClass("active")}}),this},renderBargain:function(t){var i=this;i.bargainMainView=new v({data:t.ump.alone.data}),i.bargainFooterView=new f({data:t.ump.alone.data}),$(".js-ump",i.$el).html(i.bargainMainView.render().$el),$(".bottom-bar",i.$el).remove(),i.$el.append(i.bargainFooterView.render().$el),i.bargainFooterView.on("footer",function(){i.model.fetch({success:function(t,e,n){i.renderBargain(e),i.bargainFooterView.off("footer")}})})},renderauction:function(t){var i=this,e="",n=t.ump.alone.data;$(".main-adds").addClass("hide"),e+='<div class="header-top"></div>',$(".swiper-container").append(e),i.auctionView=new S({data:n}),i.auctionFooterView=new z({data:t.ump.alone.data}),$(".js-ump",i.$el).html(i.auctionView.render().$el),$(".bottom-bar",i.$el).remove(),i.$el.append(i.auctionFooterView.render().$el),i.auctionFooterView.on("footer",function(){i.model.fetch({success:function(t,e,n){i.renderauction(e),i.auctionFooterView.off("footer")}})})},timePintuan:function(t){var i=this;i.model.fetch({success:function(t,e,n){i.renderPintuan(e)}})},renderPintuan:function(t){var e=this;$(".main-price").addClass("hide"),$(".main-vip").addClass("hide"),$(".main-adds").addClass("hide");var n=i.template(P);0==t.is_sku?max_price=t.price:max_price=t.max_price,$(".js-spellgroup",e.$el).html(n({data:t.ump.alone.data,max_price:max_price}));var a=function(){function t(){for(var t=0;t<a.length;t++)a[t].ele.innerHTML=i(a[t].time?a[t].time-=1:0),a[t].time||a.splice(t--,1)}function i(t){return d=Math.floor(t/86400),h=Math.floor(t%86400/3600),m=Math.floor(t%86400%3600/60),s=Math.floor(t%86400%3600%60),t>0?"<font>"+d+"</font>天<font>"+h+"</font>时<font>"+m+"</font>分<font>"+s+"</font>秒":(e.timePintuan({id:e.model.get("id")}),"")}var n,a=[];return function(i,e){n||(n=setInterval(t,1e3)),a.push({ele:document.getElementById(i),time:e})}}();member_is_pintuan=t.ump.alone.data.member_is_pintuan;for(var o=0;o<member_is_pintuan.length;o++)1==member_is_pintuan[o].initiate_status&&member_is_pintuan[o].endtime>0&&a("time"+member_is_pintuan[o].id,member_is_pintuan[o].endtime);$(".bottom-bar",e.$el).html("");var l=t.ump.alone.data.count_at;Number(l)>0?(clearInterval(_global.FnCount),_global.FnCount=setInterval(function(){l-=1,0>l?(e.render({id:e.model.get("id")}),clearInterval(_global.FnCount)):$(".spellgroup-time").html(e.timer(l))},1e3),0==l&&($(".spellgroup-time").addClass("hide"),e.render({id:e.model.get("id")}),clearInterval(_global.FnCount))):$(".spellgroup-time").addClass("hide")},renderSeckill:function(t){var i=this,e=new b({data:t}),n=new _({data:t.ump.alone.data});$(".seckill",i.$el).html(e.render().$el),t&&t.ump&&t.ump.alone&&t.ump.alone.data?i.$el.append(n.render().$el):($(".seckill-actions").remove(),i.$el.append((new I).render().$el)),e.on("main",function(){i.model.fetch({success:function(t,n,s){n.ump&&n.ump.alone&&n.ump.alone.data&&3!=n.ump.alone.data.status?(i.renderSeckill(n),e.off("main")):(i.renderSeckill(n),e.off("main"))}})}),n.on("footer",function(){i.model.fetch({success:function(t,e,s){i.renderSeckill(e),n.off("footer")}})})},renderBangmian:function(t){var i=this,e=new y({data:t}),n=new w({data:t}),s=t.ump.alone.data.bangmian_id,a=t.ump.alone.data.bangmian_initiate_id;bangmianIcon='<div class="bangmian-icon"><a href="/bangmian/rule/'+s+"/"+a+'"><img src="/image/bangmian.png"></a></div>',i.$el.append(bangmianIcon);var o='<div class="price-scope"><i class="price-currency"> '+_global.setting.currency_unit+' </i><span class="price-integer">'+parseInt(t.ump.alone.data.price)+'</span><span class="price-decimal"> '+t.ump.alone.data.price.substring(t.ump.alone.data.price.indexOf("."),t.ump.alone.data.price.indexOf(".")+3)+" </span></div>";$(".main-price",i.$el).html(o),$(".bangmian",i.$el).html(e.render().$el),t&&t.ump&&t.ump.alone&&t.ump.alone.data?i.$el.append(n.render().$el):($(".bangmian-actions").remove(),i.$el.append((new I).render().$el)),e.on("main",function(){i.model.fetch({success:function(t,n,s){i.renderBangmian(n),e.off("main")}})}),n.on("footer",function(){i.model.fetch({success:function(t,e,s){i.renderBangmian(e),n.off("footer")}})})},timer:function(t){var i=parseInt(t),e=0,n=0,s=0;i>60&&(e=parseInt(i/60),i=parseInt(i%60),e>60&&(n=parseInt(e/60),e=parseInt(e%60),n>24&&(s=parseInt(n/24),n=parseInt(n%24))));var a="<font>"+parseInt(i)+"</font>秒";return a="<font>"+parseInt(e)+"</font>分"+a,a="<font>"+parseInt(n)+"</font>时"+a,a="距离开始：<font>"+parseInt(s)+"</font>天"+a},renderComponent:function(){var t=this,i=this.model.get("design_goods");"undefined"!=typeof i&&null!=i&&i.length>0?$.each(i,function(i,e){switch(e.type){case"goods_head":"1"==e.content.is_csale&&$(".js-is-csale",t.$el).hide();break;case"goods_info":t.goodsInfo();break;default:t.renderModule(e.type,e.content)}}):t.goodsInfo()},goodsInfo:function(){var t=this,i=t.model.get("component_data");$.each(i,function(i,e){if("goods_info"==e.type){var n=$('<div class="modules-goods-info"></div>');$(".goods-component",this.$el).append(n);var s=e.content.text,a=new RegExp("src","g"),o="";s&&(o=s.replace(a,'class="lazy goods-component-imgs" data-original'));try{n.html(t.goodsInfoTemplate(o))}catch(l){console.log(l)}$("img.lazy").lazyload({effect:"fadeIn"})}else t.renderModule(e.type,e.content)})},renderModule:function(t,i){var e=require("components/modules/"+t+"/view"),n=$('<div class="modules-'+t+'"></div>');$(".goods-component",this.$el).append(n);var s=new e({model:i});n.html(s.$el),s.render()},tab:function(t){var i=this;if(!$(t.currentTarget).hasClass("active")){$(t.currentTarget).addClass("active").siblings().removeClass("active");var e="#"+$(t.currentTarget).data("type");$(e)[0]?$(e).addClass("active"):("#cmt-list"==e&&$(".js-goods-tab-content",this.$el).append(new c(i.model.id).render().$el),"#goods-prop"==e&&$(".js-goods-tab-content",this.$el).append(new r(i.model.id).$el),"#record-list"==e&&$(".js-goods-tab-content",this.$el).append(new p(i.model.id).render().$el)),$(e).siblings().removeClass("active")}},search:function(){var t=require("components/search/view");$("body").append((new t).render().$el)},setHistory:function(t){var i={id:t.id,img:t.img,title:t.title,price:t.price,timestamp:(new Date).valueOf()},e=window.localStorage,n=localStorage.getItem("hisData"),s=[];if(null!=n&&n!=[]){var a=JSON.parse(n);$.each(a,function(t,e){e.id!=i.id&&s.push(e)})}else s=[];s.unshift(i),s.length>20&&s.shift(),e.setItem("hisData",JSON.stringify(s))},openSku:function(t){var i=new x;i.open(t)},rxgSku:function(i){if(!_global.user){if($.device.weixin)return $.authRedirect(),!1;var e=decodeURIComponent(t.history.location.pathname.substring(1)+t.history.location.search);return t.history.navigate("login?"+e,{trigger:!0,replace:!0}),!1}if($.device.weixin&&void 0!=_global.user.weixin_info)return $.authRedirect(),!1;var n=new k;n.open(i)},showGoodsImg:function(t){var i=$(t.currentTarget).data("index"),e=this.model.get("imgs"),n="?imageMogr2/thumbnail/640x/interlace/1",s={current:_global.url.ms+e[i].img+n,urls:[]};e.map(function(t,i){s.urls.push(_global.url.ms+t.img+n)}),$.wechatPreviewImage(s)},showGoodsComponentImgs:function(t){var i=$(t.currentTarget).data("original"),e="?imageMogr2/thumbnail/640x/interlace/1",n={current:i+e,urls:[i+e]};$.wechatPreviewImage(n)},showShopServer:function(){$.popup(".popup-shopServer")}})}),define("apps/goods/models/combo_info",["backbone"],function(t){return t.Model.extend({url:function(){return this.id?"/combo/combo_info/"+this.id+".json":"/combo/combo_info"}})}),define("apps/goods/models/buy_combo",["backbone"],function(t){return t.Model.extend({url:function(){return"/combo/buy_combo.json"}})}),define("components/cart/models/combo_skudata",["backbone"],function(t){return t.Model.extend({url:function(){return this.id?"/combo/combo_sku_one/"+this.get("cid")+"/goods_id/"+this.id+".json":"/combo/combo_sku_one.json"}})}),define("text!components/cart/templates/combo_main.html",[],function(){return'<div class="popup popup-sku remove-on-close">\n    <div class="goods-summary">\n        {{?it.is_hide!=1}}\n        <div class="thumb"><img src="{{=_global.url.ms}}{{=it.img}}?imageMogr2/thumbnail/280x280"></div>\n        {{??}}\n        <div class="thumb"><img src="{{=_global.url.ms}}{{=it.surprise_img}}?imageMogr2/thumbnail/280x280"></div>\n        {{?}}\n        \n        <div class="detail">\n            {{?it.is_hide!=1}}\n            <p class="title">{{=it.title}}</p>\n            {{??}}\n            <p class="title">{{=it.alias}}</p>\n            {{?}}\n            \n            <div class="price-scope cart-price-num">\n                <i class="price-currency">{{=_global.setting.currency_unit}}</i>\n                <span class="price-integer">{{=parseInt(it.pay_price)}}</span>\n                <span class="price-decimal">{{=it.pay_price.substring(it.pay_price.indexOf("."), it.pay_price.indexOf(".") + 3)}}</span>\n                <span class="price-integer"></span>\n\n                \n            </div>\n        </div>\n        <div class="close-popup if if-close" data-popup=".popup-sku"></div>\n    </div>\n    <div class="popup-sku-content">\n    <ul class="sku-control cart-sku-control">\n        {{for(var i in it.goods_props){}}\n        <li>\n            <h2>{{=it.goods_props[i].name}}</h2>\n            <div class="items cart-sku-items">\n                {{~it.goods_props[i].gps:v:index}}\n                <label class="cart-sku-click {{?(v.stock <= 0)}}disabled{{?}} sku-click-{{=it.goods_props[i].id}}{{=v.prop_vid}}" data-str="{{=it.goods_props[i].id}}:{{=v.prop_vid}}">{{=v.prop_value}}</label>\n                {{~}}\n            </div>\n        </li>\n        {{}}}\n    </ul>\n    {{?(it.btnType != 3)}}\n    <div class="quantity-control clearfix">\n        <label>数量</label>\n        <div class="quantity">\n            <button class="minus cart-num-minus disabled"><i class="if if-minis"></i></button>\n            <input type="tel" name="cart-num" value="1">\n            <button class="plus cart-num-plus"><i class="if if-plus"></i></button>\n        </div>\n        <div class="stock">库存：<span class="cart-stock-num">{{=it.stock}}</span></div>\n    </div>\n    <div class="message-control">\n        <form class="form-horizontal" role="form">\n            {{~it.collect_fields:v:index}}\n            <div class="form-group">\n                <label>{{=v.name}}</label>\n{{switch(v.type){}}\n{{case \'date\':}}\n<input type="text" name="{{=v.type+index}}" {{?(v.required)}}required{{?}} class="form-item date-input" placeholder="请选择{{=v.name}}" />\n{{break;}}\n{{case \'time\':}}\n<input type="text" name="{{=v.type+index}}" {{?(v.required)}}required{{?}} class="form-item time-input" placeholder="请选择{{=v.name}}" />\n{{break;}}\n{{case \'multipleText\':}}\n<textarea name="{{=v.type+index}}" {{?(v.required)}}required{{?}} class="form-item">{{?v.value}}{{=v.value}}{{?}}</textarea>\n{{break;}}\n{{default:}}\n<input type="text" name="{{=v.type+index}}" {{?(v.required)}}required{{?}} {{?v.value}}value="{{=v.value}}"{{?}} class="form-item" placeholder="请填写{{=v.name}}">\n{{}}}\n            </div>\n            {{~}}\n        </form>\n    </div>\n    {{?}}\n<div class="popup-options">\n    <button type="button" class="btn btn-block btn-buy cart-buy-btn">加入</button>\n</div>\n</div></div>'}),define("components/cart/views/combo_main",["backbone","jquery","doT","components/cart/models/combo_skudata","components/cart/models/skuBargainData","apps/trade/models/cart","apps/trade/models/bargainCart","text!components/cart/templates/combo_main.html"],function(Backbone,$,doT,Model,BargainModel,CartModel,BargainCartModel,Tpl){return Backbone.View.extend({el:"body",events:{"click .cart-num-plus":"numPlus","click .cart-num-minus":"numMinus",'change input[name="cart-num"]':"numChange","click .cart-submit-btn":"addCart","click .ump-buy-btn":"umpSubmit","click .cart-sku-submit-btn":"updateSku","click .cart-buy-btn":"buy","click .close-popup":"closeModal","click .popup-overlay.visible":"closeModal"},template:doT.template(Tpl),initialize:function(){this.model=new Model,this.bargainModel=new BargainModel,this.bargainModel.on("sync",this.loadDom,this),this.bargainCartModel=new BargainCartModel,this.cartModel=new CartModel,this.selected={},this.pid=0,$.indicator(),this.undelegateEvents()},open:function(t,i){if(i)this.gid=i,this.type=0;else{var e=$(t.currentTarget);this.gid=e.attr("data-goods"),this.cid=e.attr("data-cid"),this.pid=e.attr("cart-pid")||0,this.type=parseInt(e.attr("cart-type"))||0,t.stopPropagation(),t.preventDefault()}var n=this;this.model.set({id:this.gid,btnType:this.type,cid:this.cid}),this.model.fetch({success:function(t,i,e){n.data=n.model.toJSON()[0],n.model.on("sync",n.loadDom,n)}})},umpOpen:function(t){var i=this;switch(t.umpType){case"bargain":i.bargainModel.set({bargain_id:t.bargain_id,bargain_initiate_id:t.bargain_initiate_id}),i.bargainModel.fetch({success:function(e,n,s){i.data=n,i.data=$.extend(!0,i.data,{gid:t.gid,btnType:t.btnType}),i.submitUmpType="bargain"}})}},umpSubmit:function(){var t=this;switch(t.submitUmpType){case"bargain":t.bargain()}},bargain:function(){var t=this,i=[],e={bargain_id:t.bargainModel.get("bargain_id"),bargain_initiate_id:t.bargainModel.get("bargain_initiate_id"),goods_id:t.data.gid,quantity:parseInt(t.inputDom.val())};if(1!=parseInt(t.inputDom.val()))return $.toast("优惠商品只能购买一件哦~"),!1;if(t.data.is_sku){if(!t.selectInfo)return $.toast("请先选择规格尺寸"),!1;e.product_id=t.selectInfo.id}var n=t.data.collect_fields;if(n){var s=t.validityCollectFields();if(!s)return!1;e.fields=s,$.localStorage&&t.setCollectFieldHistory(s)}i.push(e),t.bargainCartModel.set({goods:i,bargain_id:t.bargainModel.get("bargain_id"),bargain_initiate_id:t.bargainModel.get("bargain_initiate_id")}),$.indicator(),t.undelegateEvents(),t.bargainCartModel.save("","",{success:function(i,e,n){e.status?(t.closeModal(),window.location.href=_global.url.trade_url+"order/confirm?_="+_global.shop.id+"&order_id="+e.order_id):($.toast(e.msg),t.delegateEvents()),$.indicator("hide")}})},loadDom:function(){var t=this;if(this.skuStock(),this.data.collect_fields&&(this.data.collect_fields=t.getDefaultCollectFields(this.data.collect_fields)),this.$el.append(this.template(t.data)),$(".cart-sku-click").bind("click",function(i){t.skuSelect(i)}),this.inputDom=$("input[name='cart-num']"),this.minusDom=$(".cart-num-minus"),this.plusDom=$(".cart-num-plus"),this.stockDom=$(".cart-stock-num"),this.priceDom=$(".cart-price-num"),this.stock=this.data.stock,this.submitUmpType&&(this.minusDom.addClass("disabled"),this.plusDom.addClass("disabled")),0!=this.pid){var i=t.getPropStr(this.pid),e=i.split(";");for(var n in e){var s=e[n].split(":").join(""),a=$(".sku-click-"+s);a.trigger("click")}}$(".popup-sku-content",this.$el).css({"max-height":$(window).height()-100}),$.popup(".popup-sku"),$(".date-input").calendar({dateFormat:"yyyy-mm-dd"}),$(".time-input").datetimePicker({toolbarTemplate:'<header class="bar bar-nav">                        <button class="button button-link pull-right close-picker">确定</button>                        <h1 class="title">选择日期和时间</h1>                        </header>'}),this.delegateEvents(),$.indicator("hide")},getDefaultCollectFields:function(data){var collectFieldHistory=localStorage.getItem("collectFieldHistory");if(collectFieldHistory){collectFieldHistory=eval("("+collectFieldHistory+")");for(var i in data)data[i].value="",collectFieldHistory[data[i].type]&&(data[i].value=collectFieldHistory[data[i].type])}return data},numPlus:function(t){if(!$(t.currentTarget).hasClass("disabled")){var i=parseInt(this.inputDom.val())+1;this.inputDom.val(i).trigger("change")}},numMinus:function(t){if(!$(t.currentTarget).hasClass("disabled")){var i=parseInt(this.inputDom.val())-1;this.inputDom.val(i).trigger("change")}},numChange:function(){var t=this.inputDom.val();if(!/^[1-9]\d*$/.test(t)){if($.toast("请填写正整数"),!(parseInt(t)>0))return this.inputDom.val(1),!1;this.inputDom.val(parseInt(t))}t=parseInt(t),this.submitUmpType||(t>1?this.minusDom.removeClass("disabled"):1>=t&&(this.minusDom.addClass("disabled"),1>t&&($.toast("至少购买1件噢"),this.inputDom.val(1))),t>=this.stock?(this.plusDom.addClass("disabled"),t>this.stock&&($.toast("只有"+this.stock+"件啦"),this.inputDom.val(this.stock))):this.plusDom.removeClass("disabled"))},getPropStr:function(t){var i=this.data.products;for(var e in i)if(i[e].id==t)return i[e].props;return!1},skuStock:function(t){this.props=this.data.goods_props;for(var i in this.props){var e=this.props[i];for(var n in e.gps){var s=e.gps[n],a=[e.id+":"+s.prop_vid];e.gps[n].stock=this.getStock(a)}}},getStock:function(t){var i=this.data.products,e=0;for(var n in i)this.checkStock(t,i[n].props)&&(e+=i[n].stock);return e},checkStock:function(t,i){var e=!0;for(var n in t)if(-1==i.indexOf(t[n])){e=!1;break}return e},skuSelect:function(t){var i=$(t.currentTarget);if(this.selectInfo=null,!i.hasClass("disabled")){i.toggleClass("checked").siblings().removeClass("checked");var e=i.parent(".cart-sku-items").parent("li").index();if(i.hasClass("checked")?this.selected[e]=i.attr("data-str"):delete this.selected[e],this.skuEach(),Object.keys(this.props).length==Object.keys(this.selected).length){this.stock=this.getStock(this.selected),this.stockDom.text(this.stock),this.inputDom.trigger("change"),this.selectInfo=this.getSkuInfo();var n=this.selectInfo.price;this.selectInfo.vip_price&&(n=this.selectInfo.vip_price)}else this.stock=this.data.stock,this.stockDom.text(this.stock),this.inputDom.trigger("change")}},skuEach:function(){var t=this;$(".cart-sku-control").children("li").each(function(){var i=$(this).index(),e=[],n=0;for(var s in t.selected)i!=s&&e.push(t.selected[s]);$(this).children(".cart-sku-items").children("label").each(function(){var i=[];i=$.copyObj(e),i.push($(this).attr("data-str")),n=t.getStock(i),0>=n?$(this).addClass("disabled"):$(this).removeClass("disabled")})})},getSkuInfo:function(){var t=this.data.products,i={};for(var e in t){var n=t[e];if(this.checkStock(this.selected,n.props)){i={id:n.id,price:n.price,props_str:n.props_str,vip_price:n.vip_price};break}}return i},validityCollectFields:function(){var t=$.copyObj(this.data.collect_fields);for(var i in t)"multipleText"!=t[i].type?t[i].value=$.trim($("input[name='"+t[i].type+i+"']").val()):t[i].value=$.trim($("textarea[name='"+t[i].type+i+"']").val());var e=$.validity(t);return e.status?t:($.toast(e.error),!1)},addCart:function(){this.cartSubmit(0)},updateSku:function(){this.trigger("updateSku",this.selectInfo)},buy:function(){this.cartSubmit(1)},cartSubmit:function(t){var i={type:t,goods_id:this.gid,quantity:parseInt(this.inputDom.val())},e=this.data.collect_fields;if(e){var n=this.validityCollectFields();if(!n)return!1;i.fields=JSON.stringify(n),$(".sku-list.dq").prev(".goods").attr("data-fields",i.fields),localStorage.setItem("combogoods_fields"+this.gid,i.fields),$.localStorage&&this.setCollectFieldHistory(n)}if(this.data.is_sku){if(!this.selectInfo)return $.toast("请先选择规格尺寸"),!1;if(z_stock=parseInt($(".sku-list.dq").prev(".goods").attr("data-stock")),num=parseInt($(".sku-list.dq").prev(".goods").find("span").find("font").html()),i.quantity+num>z_stock)return $.toast("已超过可添加商品数量"),!1;if($(".sku-list.dq").prev(".goods").find("span").find("font").html(num+i.quantity),i.product_id=this.selectInfo.id,skms="",$(".cart-sku-click.checked").each(function(){skms+=$(this).html()+","}),skms=skms.substring(0,skms.length-1),""==$(".sku-list.dq").html()){var s='<div data-id="'+i.product_id+'" class="sk"><font>已选</font><div class="skms">'+skms+'</div><div class="num">'+i.quantity+'</div><div class="close-sk if if-close"></div></div>';$(".sku-list.dq").append(s)}else{var a=0;if($(".sku-list.dq .sk").each(function(t){$(this).attr("data-id")==i.product_id?$(this).find(".num").html(parseInt($(this).find(".num").html())+i.quantity):a++}),$(".sku-list.dq .sk").length==a){var s='<div data-id="'+i.product_id+'" class="sk"><font>已选</font><div class="skms">'+skms+'</div><div class="num">'+i.quantity+'</div><div class="close-sk if if-close"></div></div>';$(".sku-list.dq").append(s)}}}else{if(z_stock=parseInt($(".sku-list.dq").prev(".goods").attr("data-stock")),num=parseInt($(".sku-list.dq").prev(".goods").find("span").find("font").html()),i.quantity+num>z_stock)return $.toast("已超过可添加商品数量"),!1;$(".sku-list.dq").prev(".goods").find("span").find("font").html(num+i.quantity)}$(".sku-list.dq").prev(".goods").attr("data-price",this.data.price),$(".sku-list.dq").prev(".goods").attr("data-payprice",this.data.pay_price);var o=0,l=0;$(".combogoods").each(function(t){o+=parseInt($(this).find(".goods").find("span").find("font").html()),l+=parseInt($(this).find(".goods").attr("data-stock"))}),o==l?($(".js-open-in").addClass("hide"),$(".js-open-buy").removeClass("hide")):($(".js-open-buy").addClass("hide"),$(".js-open-in").removeClass("hide"));var r=this;this.undelegateEvents(),r.closeModal()},setCollectFieldHistory:function(data){var collectFieldHistory=localStorage.getItem("collectFieldHistory");collectFieldHistory=collectFieldHistory?eval("("+collectFieldHistory+")"):{};for(var i in data){var res=data[i];"date"!=res.type&&"time"!=res.type&&(collectFieldHistory[res.type]=res.value)}localStorage.setItem("collectFieldHistory",JSON.stringify(collectFieldHistory))},closeModal:function(){$.closeModal(".popup-sku"),this.undelegateEvents()}})}),define("text!apps/goods/templates/combo_main.html",[],function(){return'<header class="bar top-bar">\n</header>\n<div style="width:100%;height:3rem;"></div>\n<div class="combogoods-main">\n    <div class="combogoods-list">\n        {{~it.goods_list:v:index}}\n        <div class="combogoods {{?index>=0}}hide{{?}}">\n            <div class="goods" data-goods="{{=v.goods_id}}" data-cid="{{=it.id}}" data-stock="{{=v.stock}}" data-fields="" data-originalprice="{{=v.price}}" data-price="" data-payprice="">\n                {{?v.is_hide!=1}}\n                <img src="{{=_global.url.ms}}{{=v.img}}">\n                <div class="title">{{=v.title}}</div>\n                {{??}}\n                <img src="{{=_global.url.ms}}{{=it.surprise_img}}">\n                <div class="title">{{=v.alias}}</div>\n                {{?}}\n                \n                <span>已选：<font class="">0</font>/{{=v.stock}}</span>\n            </div>\n            <div class="sku-list"></div>\n        </div>\n        {{~}}\n    </div>\n    <div class="gengduo js-down"><div class="on-down if if-chevron-down"></div></div>\n    <div class="gengduo js-up hide"><div class="on-up if if-chevron-down"></div></div>\n</div>\n\n<div class="view-container">\n    <div class="view-inner">\n        <section class="goods-main">\n            <div class="swiper-container goods-swiper">\n                <div class="swiper-wrapper">\n                    <div class="swiper-slide">\n                        <img class="swiper-lazy" src="{{=_global.url.ms}}{{=it.img}}?imageMogr2/thumbnail/640x/interlace/1">\n                    </div>\n                </div>\n            </div>\n\n            <div class="main-title">\n                <h1>{{=it.title}}</h1>\n                <img src="{{=_global.url.ms}}{{=it.label_img}}?imageMogr2/thumbnail/300x300!">\n            </div>\n            <div class="main-price clearfix">\n                {{?it.status==0||it.status==1}}\n                    <div class="price-scope">\n                        <i class="price-currency">{{=_global.setting.currency_unit}}</i>\n                        <span class="price-integer">{{=parseInt(it.price)}}</span>\n                        <span class="price-decimal">{{=it.price.substring(it.price.indexOf("."), it.price.indexOf(".") + 3)}}</span>\n                    </div>\n                    <div class="max_price">原价:<font>￥{{=it.original_price}}</font></div>\n                {{??}}\n                <div class="cl-gray" style="margin-bottom: 1rem;">\n                    套餐已結束\n                </div>\n                {{?}}\n                \n            </div>\n\n            \n\n            <div class="main-adds">\n                <span>运费：{{=it.shipment_fee}}</span>\n                <span>销量：{{=it.cactor}}件</span>\n            </div>\n            \n        </section>\n        <div class="main-cgoods">\n                <div class="swiper-container swiper-parent">\n                    <div class="swiper-wrapper">\n                    {{~it.goods_list:v:index}}\n                      <div class="swiper-slide {{?it.goods_list.length<=3}}xiaoyu{{?}} ">\n                        <div class="combo-goods">\n                            {{?v.is_hide!=1}}\n                            <a href="{{=_global.url.shop_url}}goods/{{=v.goods_id}}"><img src="{{=_global.url.ms}}{{=v.img}}?imageMogr2/thumbnail/300x300!"></a>\n                            {{??}}\n                            <a><img src="{{=_global.url.ms}}{{=it.surprise_img}}?imageMogr2/thumbnail/300x300!"></a>\n                            {{?}}\n                            <div class="price">{{=_global.setting.currency_unit}}{{=v.price}}</div>\n                        </div>\n                        {{?it.goods_list.length-1!=index}}<i class="if if-plus"></i>{{?}}\n                      </div>\n                    {{~}}\n                    </div>\n                </div>\n            </div>\n        <div class="goods-component"></div>\n\n    </div>\n</div>\n\n<div class="bar bottom-bar"></div>\n'}),define("text!apps/goods/templates/combo_bar.html",[],function(){return'<div class="goods-actions">\n    <a href="/" class="cell"><i class="if if-store"></i><div>进店</div></a>\n    <div class="cell btns-cell">\n        <button class="btn-sm btn-buy btn-combot js-open-in">选择商品</button>\n        <button class="btn-sm btn-buy btn-combot js-open-buy hide">立即购买</button>\n    </div>\n</div>  \n\n';
}),define("text!apps/goods/templates/combo_goods_info.html",[],function(){return'<section class="goods-taber">\n    <div class="tab-nav">\n        <a class="active js-tab" data-type="goods-info" href="javascript:;">图文详情</a>\n        <a class="js-tab" href="javascript:;"></a>\n        <a class="js-tab" href="javascript:;"></a>\n    </div>\n    <div class="tab-content js-goods-tab-content">\n        <div class="tab active" id="goods-info">\n            <div class="goods-desc">\n                {{=it}}\n            </div>\n        </div>\n    </div>\n</section>'}),define("text!apps/goods/templates/empty.html",[],function(){return'<li class="list-empty"{{?it.is_background}} style="background-image: none;background-color: transparent;"{{?}}>\n    <i class="if if-info"></i>\n    <p>{{=it.info}}</p>\n    {{?it.show}}\n    <div class="t_center">\n        <a href="/" class="btn btn-danger-o btn-sm">去逛逛</a>\n    </div>\n    {{?}}\n</li>'}),define("apps/goods/views/combo_main",["backbone","doT","Swiper","lazyLoad","components/top_bar/view","apps/goods/models/combo_info","apps/goods/models/buy_combo","components/cart/views/combo_main","text!apps/goods/templates/combo_main.html","text!apps/goods/templates/combo_bar.html","text!apps/goods/templates/combo_goods_info.html","text!apps/goods/templates/empty.html","components/footer/view","components/modules/modules"],function(Backbone,doT,Swiper,lazyLoad,TopBarView,Model,CartModel,CartView,MainTpl,ComboBarTpl,goodsInfoTpl,EmptyTpl,footerView){var $container=$("#views");return Backbone.View.extend({id:"view-goods",className:"page-view view-goods",template:doT.template(MainTpl),goodsInfoTemplate:doT.template(goodsInfoTpl),events:{"click .goods":"openSku","click .js-open-buy":"openBuy","click .js-open-in":"openIn","click .js-down":"opendown","click .js-up":"openup","click .close-sk":"closesk"},initialize:function(){this.model=new Model,this.cartModel=new CartModel,$(".page-view",$container).removeClass("active"),$("#view-goods")[0]&&$("#view-goods").remove(),$container.append(this.$el)},render:function(t){var i=this;return this.model.set({id:t}),this.model.fetch({success:function(t,e,n){if($.loading("hide"),!e.status){if("套餐活动不存在"==e.msg){$.setTitle(e.msg);var s=doT.template(EmptyTpl),a="";a=e.msg,i.$el.html(s({info:a,is_background:1})).addClass("active")}return!1}$.setTitle(i.model.get("title")),$.setForward({title:i.model.get("title"),desc:"套餐详情",link:window.location.href,imgUrl:_global.url.ms+i.model.get("img")+"?imageMogr2/thumbnail/640x/interlace/1"}),i.$el.html(i.template(i.model.toJSON())).addClass("active"),$.localStorage()&&i.setHistory(i.model.toJSON()),i.model.get("goods_list").length>3&&$(".swiper-parent",i.$el).swiper({slidesPerView:3}),i.goodsInfo();var o=doT.template(ComboBarTpl);$(".bottom-bar",i.$el).html(o),i.$el.append((new footerView).render().$el)},error:function(){$.loading("hide"),$.setTitle("没有找到该套餐"),text="没有找到该套餐",i.$el.html(emptyTpl({info:text,is_background:1})).addClass("active")}}),this},goodsInfo:function(){var t=this,i=t.model.get("intro"),e=$('<div class="modules-goods-info"></div>');$(".goods-component",this.$el).append(e);var n=new RegExp("src","g"),s="";i&&(s=i.replace(n,'class="lazy" data-original')),e.html(t.goodsInfoTemplate(s)),$("img.lazy").lazyload({effect:"fadeIn"})},search:function(){var t=require("components/search/view");$("body").append((new t).render().$el)},setHistory:function(t){var i={id:t.id,img:t.img,title:t.title,price:t.price,timestamp:(new Date).valueOf()},e=window.localStorage,n=localStorage.getItem("hisData"),s=[];if(null!=n&&n!=[]){var a=JSON.parse(n);$.each(a,function(t,e){e.id!=i.id&&s.push(e)})}else s=[];s.unshift(i),s.length>20&&s.shift(),e.setItem("hisData",JSON.stringify(s))},openBuy:function(e){$(".js-open-buy").attr({disabled:"disabled"});var _this=this,data={combo_id:_this.model.get("id"),goods_list:[]};$(".combogoods").each(function(i){goods_id=$(this).find(".goods").attr("data-goods"),price=$(this).find(".goods").attr("data-price"),original_price=$(this).find(".goods").attr("data-originalprice"),pay_price=$(this).find(".goods").attr("data-payprice"),localStorage.getItem("combogoods_fields"+goods_id)?collect_fields=eval("("+localStorage.getItem("combogoods_fields"+goods_id)+")"):collect_fields=[],""==$(this).find(".sku-list").html()?(quantity=$(this).find(".goods").find("span").find("font").html(),goods_list=[],goods_list={goods_id:goods_id,product_id:0,price:price,pay_price:pay_price,original_price:original_price,quantity:quantity,collect_fields:collect_fields},data.goods_list.push(goods_list)):$(this).find(".sku-list").find(".sk").each(function(t){product_id=$(this).attr("data-id"),quantity=$(this).find(".num").html(),goods_list=[],goods_list={goods_id:goods_id,product_id:product_id,price:price,pay_price:pay_price,original_price:original_price,quantity:quantity,collect_fields:collect_fields},data.goods_list.push(goods_list)})}),this.cartModel.set(data),this.cartModel.save("","",{success:function(t,i,e){i.status?window.location.href=_global.url.trade_url+"order/confirm?_="+_global.shop.id+"&order_id="+i.order_id:(i.msg?$.toast(i.msg):$.toast(i.error),$(".js-open-buy").removeAttr("disabled"),_this.delegateEvents()),$.indicator("hide")}})},openIn:function(t){var i=this;if(!_global.user){if($.device.weixin)return $.authRedirect(),!1;var e=decodeURIComponent(Backbone.history.location.pathname.substring(1)+Backbone.history.location.search);return Backbone.history.navigate("login?"+e,{trigger:!0,replace:!0}),!1}return $.device.weixin&&void 0!=_global.user.weixin_info?($.authRedirect(),!1):void i.opendown()},openSku:function(t){var i=new CartView;i.open(t),$(".sku-list").addClass("hide").removeClass("dq"),$(t.currentTarget).next(".sku-list").addClass("dq").removeClass("hide")},opendown:function(t){$(".js-down").addClass("hide"),$(".js-up").removeClass("hide"),$(".combogoods").removeClass("hide")},openup:function(t){$(".js-down").removeClass("hide"),$(".js-up").addClass("hide"),$(".combogoods").addClass("hide")},closesk:function(t){num=parseInt($(t.currentTarget).prev(".num").html()),y_num=$(t.currentTarget).parent(".sk").parent(".sku-list").prev(".goods").find("font"),y_num.html(parseInt(y_num.html())-num),$(t.currentTarget).parent(".sk").remove();var i=0,e=0;$(".combogoods").each(function(t){i+=parseInt($(this).find(".goods").find("span").find("font").html()),e+=parseInt($(this).find(".goods").attr("data-stock"))}),i==e?($(".js-open-in").addClass("hide"),$(".js-open-buy").removeClass("hide")):($(".js-open-buy").addClass("hide"),$(".js-open-in").removeClass("hide"))}})}),define("apps/goods/app",["backbone","apps/goods/views/main","apps/goods/views/combo_main"],function(t,i,e){return{main:function(t){this.mainView=new i,this.mainView.render({id:t})},mainBargain:function(t,e){this.mainView=new i,this.mainView.render({id:t,bargain_initiate_id:e})},combomain:function(t){this.combomainView=new e,this.combomainView.render(t)},mainBangmian:function(t,e){this.mainView=new i,this.mainView.render({id:t,bangmian_initiate_id:e})}}});